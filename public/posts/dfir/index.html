<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/journal/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=journal/livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Digital Forensics and Incidence Response &middot; Board and Secretarial</title>
  <meta name="title" content="Digital Forensics and Incidence Response &middot; Board and Secretarial" />
  
  <meta name="description" content="Credit to TryHackMe" />
  <meta name="keywords" content="DFIR, " />
  
  
  <link rel="canonical" href="http://localhost:1313/journal/posts/dfir/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/journal/css/main.bundle.min.e96772c5cdc14f53dc8f2d49a7f91bd1dc21484251faa988567a4cb5313e24ea6befb15bbad2f816721b267c196c83c5c688647f3f59faf0e25b638d0e602880.css"
    integrity="sha512-6Wdyxc3BT1Pcjy1Jp/kb0dwhSEJR&#43;qmIVnpMtTE&#43;JOpr77FbutL4FnIbJnwZbIPFxohkfz9Z&#43;vDiW2ONDmAogA==" />
  
  
  <script type="text/javascript" src="/journal/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/journal/js/main.bundle.min.7577f5e7ec0b1de90dda8695656cc4a5d0b8572bf4f231fe41da838734363b6821779a2d4141ba0b53cfc2a543b76cdf375d53c8eb2b1d723b3ddaecff69d640.js"
    integrity="sha512-dXf15&#43;wLHekN2oaVZWzEpdC4Vyv08jH&#43;QdqDhzQ2O2ghd5otQUG6C1PPwqVDt2zfN11TyOsrHXI7Pdrs/2nWQA==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/journal/lib/zoom/zoom.min.fcbc7f7b3dcea96e3b5570cd322c5d7a12d5351c87f9889b1c31745a2cc711df58f6b70795a86d50e63813b236ade916668332c10a70a4ce26f7c0878f525fce.js" integrity="sha512-/Lx/ez3OqW47VXDNMixdehLVNRyH&#43;YibHDF0WizHEd9Y9rcHlahtUOY4E7I2rekWZoMywQpwpM4m98CHj1Jfzg=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/journal/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/journal/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/journal/favicon-16x16.png" />
  <link rel="manifest" href="/journal/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/journal/posts/dfir/">
  <meta property="og:site_name" content="Board and Secretarial">
  <meta property="og:title" content="Digital Forensics and Incidence Response">
  <meta property="og:description" content="This is a blog on digital forensics from tryhackme, a platform that makes it easier for one to dive into cybersecurity.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:tag" content="DFIR">
    <meta property="og:image" content="http://localhost:1313/journal/posts/dfir/featured.jpg">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/journal/posts/dfir/featured.jpg">
  <meta name="twitter:title" content="Digital Forensics and Incidence Response">
  <meta name="twitter:description" content="This is a blog on digital forensics from tryhackme, a platform that makes it easier for one to dive into cybersecurity.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Digital Forensics and Incidence Response",
    "headline": "Digital Forensics and Incidence Response",
    "description": "This is a blog on digital forensics from tryhackme, a platform that makes it easier for one to dive into cybersecurity.",
    "abstract": "Credit to TryHackMe",
    "inLanguage": "en",
    "url" : "http:\/\/localhost:1313\/journal\/posts\/dfir\/",
    "author" : {
      "@type": "Person",
      "name": "Board and Secretarial"
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-01-10T00:00:00\u002b00:00",
    "datePublished": "2024-01-10T00:00:00\u002b00:00",
    
    "dateModified": "2024-01-10T00:00:00\u002b00:00",
    
    "keywords": ["DFIR"],
    
    "mainEntityOfPage": "true",
    "wordCount": "33570"
  }]
  </script>


  
  
  <meta name="author" content="Board and Secretarial" />
  
  
  

<script src="/journal/lib/jquery/jquery.slim.min.03cb160e3cfdb2667a2e2c80d283bebcf63ff8bbc4b629c9ab2babf6fae1d0c07ad470edae783efa4fabda2ac01c58d60e63b98b3c336be8208460f08f4354f5.js" integrity="sha512-A8sWDjz9smZ6LiyA0oO&#43;vPY/&#43;LvEtinJqyur9vrh0MB61HDtrng&#43;&#43;k&#43;r2irAHFjWDmO5izwza&#43;gghGDwj0NU9Q=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3">
    
    
    
    <div>
        <a href="/journal/" class="flex">
            <span class="sr-only">Board and Secretarial</span>

            
            <img src="/journal/img/bnslogo.png" width="41" height="40"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="Board and Secretarial" />
            

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/journal/" class="text-base font-medium text-gray-500 hover:text-gray-900">Board and Secretarial</a>
            

        </nav>
        <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">

            
            
            
  <a href="/journal/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Posts">
        Articles
    </p>
</a>



            
            
  <a href="/journal/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Categories">
        Categories
    </p>
</a>



            
            
  <a href="https://boardandsecretarial.co.ke/about-us/"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Our Website
    </p>
</a>



            
            
  <a href="/journal/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Tags">
        Tags
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class=" flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/journal/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Posts">
            Articles
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/journal/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Categories">
            Categories
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="https://boardandsecretarial.co.ke/about-us/"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Our Website
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/journal/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Tags">
            Tags
        </p>
    </a>
</li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>




<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>


  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  


<div id="hero" class="h-[150px] md:h-[200px]"></div>



    
    <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(/journal/posts/dfir/featured_hu2347272414260541506.jpg);">
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Digital Forensics and Incidence Response
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  



  



  



  





  



<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-01-10T00:00:00&#43;00:00">10 January 2024</time><span class="px-2 text-primary-500">&middot;</span><span>33570 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">158 mins</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts\DFIR\index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="likes_posts\DFIR\index.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="likes">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
    <button id="button_likes"
        class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
        onclick="process_article()">
        <span id="button_likes_heart" style="display:none" class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

 </span>
        <span id="button_likes_emtpty_heart" class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"/></svg>
  </span>

</span>
        <span id="button_likes_text">&nbsp;Like</span>
    </button>
</span><span class="px-2 text-primary-500">&middot;</span>


<script type="text/javascript" src="/journal/js/zen-mode.min.eea5245cf9244ecbdf2c150d1c8833226c1541cadf6e98f63a7c9192b1a3676df2c3ec603b14f4cfaaa53971fd9d8955640c0f405bf3de2b43ee7a5fb29ae721.js" integrity="sha512-7qUkXPkkTsvfLBUNHIgzImwVQcrfbpj2OnyRkrGjZ23yw&#43;xgOxT0z6qlOXH9nYlVZAwPQFvz3itD7npfsprnIQ=="></script>

<span class="mb-[2px]">
    <span id="zen-mode-button"
          class="text-lg hover:text-primary-500"
          title="Enable zen mode"
          data-title-i18n-disable="Enable zen mode"
          data-title-i18n-enable="Disable zen mode">
        <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50px" height="50px">
    <path fill="currentColor" d="M 12.980469 4 C 9.1204688 4 5.9804688 7.14 5.9804688 11 L 6 26 L 9.9804688 26 L 9.9804688 11 C 9.9804688 9.35 11.320469 8 12.980469 8 L 40.019531 8 C 41.679531 8 43.019531 9.35 43.019531 11 L 43.019531 39 C 43.019531 40.65 41.679531 42 40.019531 42 L 29 42 C 29 43.54 28.420938 44.94 27.460938 46 L 40.019531 46 C 43.879531 46 47.019531 42.86 47.019531 39 L 47.019531 11 C 47.019531 7.14 43.879531 4 40.019531 4 L 12.980469 4 z M 7 28 C 4.794 28 3 29.794 3 32 L 3 42 C 3 44.206 4.794 46 7 46 L 23 46 C 25.206 46 27 44.206 27 42 L 27 32 C 27 29.794 25.206 28 23 28 L 7 28 z M 7 32 L 23 32 L 23.001953 42 L 7 42 L 7 32 z"/>
</svg>
  </span>

</span>
    </span>
</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/categories/blue-team/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Blue Team
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/categories/tryhackme/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    TryHackMe
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/tags/dfir/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    DFIR
  </span>
</span>
  </span>
  
  
  
  
</div>




    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
    
    
      
    
    
      
        
      
      <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
      alt="Board and Secretarial" src="/journal/img/bnslogo_hu17121383633210364831.png" />
    
  
  <div class="place-self-center">
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      Board and Secretarial
    </div>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">Board and Secretarial Comprises of seasoned lawyers and corporate governance experts. The team boasts extensive expertise across legal, regulatory, ethical, and corporate governance domains.</div>
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
    

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          

<h1 class="relative group">Introduction 
    <div id="introduction" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#introduction" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p><a href="https://tryhackme.com/signup?referrer=6325877cfcc474005111479e" target="_blank">TryHackMe</a> has provide a well summarised and understood content that can be applied into real world scenarios. Furthermore, to acquire the practical skills, one can try the hands on labs in the platform.</p>


<h1 class="relative group">Digital Forensics and Incident Response 
    <div id="digital-forensics-and-incident-response" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#digital-forensics-and-incident-response" aria-label="Anchor">#</a>
    </span>        
    
</h1>


<h2 class="relative group">What is DFIR? 
    <div id="what-is-dfir" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#what-is-dfir" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>As already mentioned, DFIR stands for Digital Forensics and Incident
Response. This field covers the collection of forensic artifacts from
digital devices such as computers, media devices, and smartphones to
investigate an incident. This field helps Security Professionals
identify footprints left by an attacker when a security incident occurs,
use them to determine the extent of compromise in an environment, and
restore the environment to the state it was before the incident
occurred.</p>


<h2 class="relative group">The need for DFIR 
    <div id="the-need-for-dfir" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-need-for-dfir" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>DFIR helps security professionals in various ways, some of which are summarized below:</p>
<ul>
<li>Finding evidence of attacker activity in the network and sifting false alarms from actual incidents.</li>
<li>Robustly removing the attacker, so their foothold from the network no longer remains.</li>
<li>Identifying the extent and timeframe of a breach. This helps in communicating with relevant stakeholders.</li>
<li>Finding the loopholes that led to the breach. What needs to be changed to avoid the breach in the future?</li>
<li>Understanding attacker behavior to pre-emptively block further intrusion attempts by the attacker.</li>
<li>Sharing information about the attacker with the community.</li>
</ul>


<h2 class="relative group">Who performs DFIR? 
    <div id="who-performs-dfir" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#who-performs-dfir" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>As the name suggests, DFIR requires expertise in both Digital
Forensics and Incident Response. Dividing these two fields this way, the
following skillset is needed to become a DFIR professional:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6e2d93818b9a293a246d9db91fad6aea.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6e2d93818b9a293a246d9db91fad6aea.png" />
    
  </figure>
</p>
<ul>
<li><strong>Digital Forensics:</strong> These professionals are experts in identifying forensic artifacts or evidence of human activity in digital devices.</li>
<li><strong>Incident Response:</strong> Incident responders are experts in cybersecurity and leverage forensic
information to identify the activity of interest from a security
perspective.****</li>
</ul>
<p>DFIR professionals know about Digital
Forensics and cybersecurity and combine these domains to achieve their
goals. Digital Forensics and Incident Response domains are often
combined because they are highly interdependent. Incident Response
leverages knowledge gained from Digital Forensics. Similarly, Digital
Forensics takes its goals and scop</p>


<h2 class="relative group">Artifacts: 
    <div id="artifacts" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#artifacts" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Artifacts are pieces of evidence that point to an activity performed
on a system. When performing DFIR, artifacts are collected to support a
hypothesis or claim about attacker activity. For example, if we are to
claim that the attacker used Windows registry keys to maintain
persistence on a system, we can use the said registry key to support our
claim. In this case, the mentioned registry key will be considered an
artifact. Artifact collection is, therefore, an essential part of the
DFIR process. Artifacts can be collected from the Endpoint or Server&rsquo;s file system, memory, or network activity.</p>
<p>Most
of the time, enterprise environments mainly consist of Windows and
Linux Operating Systems. To learn more about the forensic artifacts in
these Operating Systems, you can head to the <a href="https://tryhackme.com/room/windowsforensics1" target="_blank">Windows Forensics 1</a>, <a href="https://tryhackme.com/room/windowsforensics2" target="_blank">Windows Forensics 2</a>, or the <a href="https://tryhackme.com/room/linuxforensics" target="_blank">Linux Forensics</a>
room. Windows systems are primarily used for endpoints and server
use-cases, like Active Directory Domain Controllers or MS Exchange email
servers. Enterprises primarily use Linux systems in the capacity of
servers hosting some service, for example, web servers or database
servers.</p>


<h2 class="relative group">Evidence Preservation: 
    <div id="evidence-preservation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#evidence-preservation" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/3b232e0148db97109a77afc200c5d177.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/3b232e0148db97109a77afc200c5d177.png" />
    
  </figure>
</p>
<p>When performing DFIR, we must maintain the integrity of the evidence
we are collecting. For this reason, certain best practices are
established in the industry. We must note that any forensic analysis
contaminates the evidence. Therefore, the evidence is first collected
and write-protected. Then, a copy of the write-protected evidence is
used for analysis. This process ensures that our original evidence is
not contaminated and remains safe while analyzing. If our copy under
investigation gets corrupted, we can always return and make a new copy
from the evidence we had preserved.</p>


<h2 class="relative group">Chain of custody: 
    <div id="chain-of-custody" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#chain-of-custody" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Another critical aspect of maintaining the integrity of evidence is
the chain of custody. When the evidence is collected, it must be made
sure that it is kept in secure custody. Any person not related to the
investigation must not possess the evidence, or it will contaminate the
chain of custody of the evidence. A contaminated chain of custody raises
questions about the integrity of the data and weakens the case being
built by adding unknown variables that can&rsquo;t be solved. For example,
suppose a hard drive image, while being transferred from the person who
took the image to the person who will perform the analysis, gets into
the hands of a person who is not qualified to handle such evidence. In
that case, we can&rsquo;t be sure if he dealt with the evidence correctly and
hence didn&rsquo;t contaminate the evidence with his activity.</p>


<h2 class="relative group">Order of volatility: 
    <div id="order-of-volatility" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#order-of-volatility" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Digital evidence is often volatile, i.e., it can be lost forever if
not captured in time. For example, data in a computer system&rsquo;s memory
(RAM) will be lost when the computer is shut down since the RAM keeps
data only as long as it remains powered on. Some sources are more
volatile as compared to others. For example, a hard drive is persistent
storage and maintains the data even if power is lost. Therefore, a hard
drive is less volatile than RAM. While performing DFIR, it is vital to
understand the order of volatility of the different evidence sources to
capture and preserve accordingly. In the example above, we will need to
preserve the RAM before preserving the hard drive since we might lose
data in the RAM if we don&rsquo;t prioritize it.</p>


<h2 class="relative group">Timeline creation: 
    <div id="timeline-creation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#timeline-creation" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Once we have collected the artifacts and maintained their integrity,
we need to present them understandably to fully use the information
contained in them. A timeline of events needs to be created for
efficient and accurate analysis. This timeline of events puts all the
activities in chronological order. This activity is called timeline
creation. Timeline creation provides perspective to the investigation
and helps collate information from various sources to create a story of
how things happened.</p>
<p><strong>DFIR TOOLS</strong></p>


<h2 class="relative group">Eric Zimmerman&rsquo;s tools: 
    <div id="eric-zimmermans-tools" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#eric-zimmermans-tools" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/1a89eb9ecd42f493fcdf7d105b41dba7.jpg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/1a89eb9ecd42f493fcdf7d105b41dba7.jpg" />
    
  </figure>
</p>
<p>Eric
Zimmerman is a security researcher who has written a few tools to help
perform forensic analysis on the Windows platform. These tools help the
registry, file system, timeline, and many other analyses. To learn more
about these tools, you can check out the <a href="https://tryhackme.com/room/windowsforensics1" target="_blank">Windows Forensics 1</a> and <a href="https://tryhackme.com/room/windowsforensics2" target="_blank">Windows Forensics 2</a> rooms, where these tools are discussed concerning the different artifacts found in the Windows Operating System.</p>


<h2 class="relative group">KAPE: 
    <div id="kape" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#kape" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/0c82470617c7ebdbfcf956ee9d9547cf.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/0c82470617c7ebdbfcf956ee9d9547cf.png" />
    
  </figure>
</p>
<p>Kroll
Artifact Parser and Extractor (KAPE) is another beneficial tool by Eric
Zimmerman. This tool automates the collection and parsing of forensic
artifacts and can help create a timeline of events. You can check out
the <a href="https://tryhackme.com/room/kape" target="_blank">KAPE room</a> to learn more about KAPE.</p>


<h2 class="relative group">Autopsy: 
    <div id="autopsy" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#autopsy" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/ea383ef541cfaf0cbbc40a64af0f47ba.jpg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/ea383ef541cfaf0cbbc40a64af0f47ba.jpg" />
    
  </figure>
</p>
<p>Autopsy is an open-source forensics platform that helps analyze data
from digital media like mobile devices, hard drives, and removable
drives. Various plugins for autopsy speed up the forensic process and
extract and present valuable information from the raw data sources.
TryHackMe&rsquo;s <a href="https://tryhackme.com/room/btautopsye0" target="_blank">Autopsy room</a> can help if you want to learn more about it.</p>


<h2 class="relative group">Volatility: 
    <div id="volatility" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#volatility" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/c25405634d4fda8271d8df63a252d16a.jpg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/c25405634d4fda8271d8df63a252d16a.jpg" />
    
  </figure>
</p>
<p>Volatility is a tool that helps perform memory analysis for memory
captures from both Windows and Linux Operating Systems. It is a powerful
tool that can help extract valuable information from the memory of a
machine under investigation. You can learn more about Volatility in the <a href="https://tryhackme.com/room/volatility" target="_blank">Volatility room</a>.</p>


<h2 class="relative group">Redline: 
    <div id="redline" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#redline" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/622d38cddd96ddcc98b8002da9920eec.jpg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/622d38cddd96ddcc98b8002da9920eec.jpg" />
    
  </figure>
</p>
<p>Redline is an incident response tool developed and freely distributed
by FireEye. This tool can gather forensic data from a system and help
with collected forensic information. You can learn more about Redline in
the <a href="https://tryhackme.com/room/btredlinejoxr3d" target="_blank">Redline room</a>.</p>


<h2 class="relative group">Velociraptor: 
    <div id="velociraptor" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#velociraptor" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/fca62b1d63bfcd0e11557606e451c412.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/fca62b1d63bfcd0e11557606e451c412.png" />
    
  </figure>
</p>
<p>Velociraptor is an advanced endpoint-monitoring, forensics, and
response platform. It is open-source but very powerful. TryHackMe has
created a <a href="https://tryhackme.com/room/velociraptorhp" target="_blank">Velociraptor room</a> for you to learn more about it.</p>
<p><strong>The Incident Response process</strong></p>
<p>In Security Operations,
the prominent use of Digital Forensics is to perform Incident Response.
We will learn the Incident Response process and observe how Digital
Forensics helps in the IR process in this task.</p>
<p>Different organizations have published standardized methods to perform Incident Response. NIST has defined a process in their <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf" target="_blank">SP-800-61 Incident Handling guide</a>, which has the following steps:</p>
<ol>
<li>Preparation</li>
<li>Detection and Analysis</li>
<li>Containment, Eradication, and Recovery</li>
<li>Post-incident Activity</li>
</ol>
<p>Similarly, SANS has published an <a href="https://www.sans.org/white-papers/33901/" target="_blank">Incident Handler&rsquo;s handbook</a>. The handbook defines the steps as follows:</p>
<ol>
<li>Preparation</li>
<li>Identification</li>
<li>Containment</li>
<li>Eradication</li>
<li>Recovery</li>
<li>Lessons Learned</li>
</ol>
<p>The
steps defined by SANS are often summarized as the acronym PICERL,
making them easy to remember. We can see that the steps specified by
SANS and NIST are identical. While NIST combines Containment,
Eradication, and Recovery, SANS separates them into different steps. <strong>Post-incident activity</strong> and <strong>Lessons learned</strong> can be comparable, while <strong>Identification</strong> and <strong>Detection and Analysis</strong> have the same implications.</p>
<p>Now
that we understand that the two processes are similar let&rsquo;s learn
briefly what the different steps mean. We explain the PICERL steps as
they are easier to remember by the acronym, but as described above, they
are identical to the steps defined by NIST.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f714eea27bb41e82ce3d3e56ea41a9ab.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f714eea27bb41e82ce3d3e56ea41a9ab.png" />
    
  </figure>
</p>
<ol>
<li><strong>Preparation</strong>: Before an incident happens, preparation needs to be done so that everyone is
ready in case of an incident. Preparation includes having the required
people, processes, and technology to prevent and respond to incidents.</li>
<li><strong>Identification</strong>: An incident is identified through some indicators in the identification
phase. These indicators are then analyzed for False Positives,
documented, and communicated to the relevant stakeholders.</li>
<li><strong>Containment</strong>: In this phase, the incident is contained, and efforts are made to limit
its effects. There can be short-term and long-term fixes for containing
the threat based on forensic analysis of the incident that will be a
part of this phase.</li>
<li><strong>Eradication</strong>: Next, the threat
is eradicated from the network. It has to be ensured that a proper
forensic analysis is performed and the threat is effectively contained
before eradication. For example, if the entry point of the threat actor
into the network is not plugged, the threat will not be effectively
eradicated, and the actor can gain a foothold again.</li>
<li><strong>Recovery</strong>: Once the threat is removed from the network, the services that had been
disrupted are brought back as they were before the incident happened.</li>
<li><strong>Lessons Learned</strong>: Finally, a review of the incident is performed, the incident is documented, and
steps are taken based on the findings from the incident to make sure
that the team is better prepared for the next time an incident occurs.</li>
</ol>


<h2 class="relative group"><strong>WINDOWS FORENSICS</strong> 
    <div id="windows-forensics" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#windows-forensics" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p><strong>Introduction to Computer Forensics for Windows:</strong></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/35c1c080687b084a9ebbaca0a4e9cfc9.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/35c1c080687b084a9ebbaca0a4e9cfc9.png" />
    
  </figure>
</p>
<p>Computer forensics is an essential field of cyber security that involves gathering evidence of activities performed on computers.
It is a part of the wider Digital Forensics field, which deals with
forensic analysis of all types of digital devices, including recovering,
examining, and analyzing data found in digital devices. The
applications of digital and computer forensics are wide-ranging, from
the legal sphere, where it is used to support or refute a hypothesis in a
civil or criminal case, to the private sphere, where it helps in
internal corporate investigations and incident and intrusion analysis.</p>
<p>A perfect example of Digital Forensics solving a criminal case is the <a href="https://en.wikipedia.org/wiki/Dennis_Rader" target="_blank">BTK serial killer</a>
case. This case had gone cold for more than a decade when the killer
started taunting the police by sending letters. The case took a major
turn when he sent a floppy disk to a local news station that was later
taken to into evidence by the police. The police were able to recover a
deleted word document on the drive, and using the metadata and some
other evidence, they pinpointed and arrested him.</p>
<p>Microsoft Windows is by large the most used Desktop Operating System right now. Private users and Enterprises prefer it,
and it currently holds roughly 80% of the Desktop market share. This
means that it is important to know how to perform forensic analysis on
Microsoft Windows for someone interested in Digital Forensics. In this
module, we will learn about the different ways we can gather forensic
data from the Windows Registry and make conclusions about the activity
performed on a Windows system based on this data.</p>


<h1 class="relative group"><strong>Forensic Artifacts:</strong> 
    <div id="forensic-artifacts" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#forensic-artifacts" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>When
performing forensic analysis, you will often hear the word &lsquo;artifact&rsquo;.
Forensic artifacts are essential pieces of information that provide
evidence of human activity. For example, during the investigation of a
crime scene, fingerprints, a broken button of a shirt or coat, the tools
used to perform the crime are all considered forensic artifacts. All of
these artifacts are combined to recreate the story of how the crime was
committed.</p>
<p>In computer forensics, forensic artifacts can be
small footprints of activity left on the computer system. On a Windows
system, a person&rsquo;s actions can be traced back quite accurately using
computer forensics because of the various artifacts a Windows system
creates for a given activity. These artifacts often reside in locations
&rsquo;normal&rsquo; users won&rsquo;t typically venture to. For our purposes, these
artifacts can be analyzed to provide the trial of activity for an
investigation.</p>
<p><strong>So is my computer spying on me?</strong></p>
<p>What do you think?</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/720842074f8b1f89e0eeae132a55424a.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/720842074f8b1f89e0eeae132a55424a.png" />
    
  </figure>
</p>
<p>A
Windows system keeps track of a lot of activity performed by a user.
But is all that tracking for malicious purposes, or is there another
reason for that? As we&rsquo;ll see in this room, the filesystem components
that forensic experts deem artifacts primarily originated from
Microsoft&rsquo;s efforts to improve the user&rsquo;s experience.</p>
<p>Assuming the
same build of Windows is installed on a system, excluding the actions
taken during installation, the out-of-the-box experience is similar for
all users. However, with time, each user personalizes their computer
according to their preferences. These preferences include the Desktop
layout and icons, the bookmarks in the internet browser, the name of the
user, installing of different applications, and logging in to different
accounts for each of these applications and other accounts using the
internet browser.</p>
<p>Windows saves these preferences to make your
computer more personalized. However, forensic investigators use these
preferences as artifacts to identify the activity performed on a system.
So while your computer might be spying on you, it is not for the
explicit reason of spying, instead to make it more pleasant to use the
computer according to your taste. But that same information is used by
forensic investigators to perform forensic analysis. As we move through
this room, we&rsquo;ll see that Windows stores these artifacts in different
locations throughout the file system such as in the registry, a user&rsquo;s
profile directory, in application-specific files, etc.</p>
<p><strong>Windows Registry and Forensics</strong></p>
<p><strong>Windows Registry:</strong></p>
<p>The Windows Registry is a collection of databases that contains the
system&rsquo;s configuration data. This configuration data can be about the
hardware, the software, or the user&rsquo;s information. It also includes data
about the recently used files, programs used, or devices connected to
the system. As you can understand, this data is beneficial from a
forensics standpoint. Throughout this room, we will learn ways to read
this data to identify the required information about the system. You can
view the registry using regedit.exe, a built-in Windows utility to view
and edit the registry. We&rsquo;ll explore other tools to learn about the
registry in the upcoming tasks.</p>
<p>The Windows registry consists of Keys and Values. When you open the
regedit.exe utility to view the registry, the folders you see are
Registry Keys. Registry Values are the data stored in these Registry
Keys. A <a href="https://docs.microsoft.com/en-us/windows/win32/sysinfo/registry-hives#:~:text=Registry%20Hives.%20A%20hive%20is%20a%20logical%20group,with%20a%20separate%20file%20for%20the%20user%20profile." target="_blank">Registry Hive</a> is a group of Keys, subkeys, and values stored in a single file on the disk.</p>
<p><strong>Structure of the Registry:</strong></p>
<p>The registry on any Windows system contains the following five root keys:</p>
<ol>
<li>HKEY_CURRENT_USER</li>
<li>HKEY_USERS</li>
<li>HKEY_LOCAL_MACHINE</li>
<li>HKEY_CLASSES_ROOT</li>
<li>HKEY_CURRENT_CONFIG</li>
</ol>
<p>You can view these keys when you open the <code>regedit.exe</code> utility. To open the registry editor, press the Windows key and the R key simultaneously. It will open a <code>run</code> prompt that looks like this:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9d33389f2fd0445a63e75dce3f6d7a88.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9d33389f2fd0445a63e75dce3f6d7a88.png" />
    
  </figure>
</p>
<p>In this prompt, type <code>regedit.exe</code>, and you will be greeted with the registry editor window. It will look something like this:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/e14ef3193fce1f4b35c37a96862d71da.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/e14ef3193fce1f4b35c37a96862d71da.png" />
    
  </figure>
</p>
<p>Here you can see the root keys in the left pane in a tree view that
shows the included registry keys, and the values in the selected key are
shown in the right pane. You can right-click on the value shown in the
right pane and select properties to view the properties of this value.</p>
<p>Here is how Microsoft defines each of these root keys. For more
detail and information about the following Windows registry keys, please
visit <a href="https://docs.microsoft.com/en-US/troubleshoot/windows-server/performance/windows-registry-advanced-users" target="_blank">Microsoft&rsquo;s documentation</a>.</p>
<table>
  <thead>
      <tr>
          <th>Folder/predefined key</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>HKEY_CURRENT_USER</strong></td>
          <td>Contains the root of the configuration information for the user who is</td>
      </tr>
      <tr>
          <td>currently logged on. The user&rsquo;s folders, screen colors, and Control Panel settings are stored here.</td>
          <td></td>
      </tr>
      <tr>
          <td>This information is associated with the user&rsquo;s profile. This key is sometimes abbreviated as</td>
          <td></td>
      </tr>
      <tr>
          <td>HKCU.</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>HKEY_USERS</strong></td>
          <td>Contains all the actively loaded user profiles on the computer.</td>
      </tr>
      <tr>
          <td>HKEY_CURRENT_USER is a subkey of HKEY_USERS. HKEY_USERS is sometimes abbreviated as HKU.</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>HKEY_LOCAL_MACHINE</strong></td>
          <td>Contains configuration information particular to the computer (for any</td>
      </tr>
      <tr>
          <td>user). This key is sometimes abbreviated as HKLM.</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>HKEY_CLASSES_ROOT</strong></td>
          <td>Is a subkey of <code>HKEY_LOCAL_MACHINE\Software</code>. The information</td>
      </tr>
      <tr>
          <td>that is stored here makes sure that the correct program opens when you open a file by using Windows</td>
          <td></td>
      </tr>
      <tr>
          <td>Explorer. This key is sometimes abbreviated as HKCR.</td>
          <td></td>
      </tr>
      <tr>
          <td>Starting with Windows 2000, this information is</td>
          <td></td>
      </tr>
      <tr>
          <td>stored under both the HKEY_LOCAL_MACHINE and HKEY_CURRENT_USER keys. The</td>
          <td></td>
      </tr>
      <tr>
          <td><code>HKEY_LOCAL_MACHINE\Software\Classes</code> key contains default settings that can apply to all</td>
          <td></td>
      </tr>
      <tr>
          <td>users on the local computer. The <code>HKEY_CURRENT_USER\Software\Classes</code> key has settings</td>
          <td></td>
      </tr>
      <tr>
          <td>that override the default settings and apply only to the interactive user.</td>
          <td></td>
      </tr>
      <tr>
          <td>The HKEY_CLASSES_ROOT key</td>
          <td></td>
      </tr>
      <tr>
          <td>provides a view of the registry that merges the information from these two sources.</td>
          <td></td>
      </tr>
      <tr>
          <td>HKEY_CLASSES_ROOT also provides this merged view for programs that are designed for earlier versions</td>
          <td></td>
      </tr>
      <tr>
          <td>of Windows. To change the settings for the interactive user, changes must be made under</td>
          <td></td>
      </tr>
      <tr>
          <td><code>HKEY_CURRENT_USER\Software\Classes</code> instead of under HKEY_CLASSES_ROOT.</td>
          <td></td>
      </tr>
      <tr>
          <td>To change the</td>
          <td></td>
      </tr>
      <tr>
          <td>default settings, changes must be made under <code>HKEY_LOCAL_MACHINE\Software\Classes</code> .If you</td>
          <td></td>
      </tr>
      <tr>
          <td>write keys to a key under HKEY_CLASSES_ROOT, the system stores the information under</td>
          <td></td>
      </tr>
      <tr>
          <td><code>HKEY_LOCAL_MACHINE\Software\Classes</code>.</td>
          <td></td>
      </tr>
      <tr>
          <td>If you write values to a key under</td>
          <td></td>
      </tr>
      <tr>
          <td>HKEY_CLASSES_ROOT, and the key already exists under <code>HKEY_CURRENT_USER\Software\Classes</code>,</td>
          <td></td>
      </tr>
      <tr>
          <td>the system will store the information there instead of under</td>
          <td></td>
      </tr>
      <tr>
          <td><code>HKEY_LOCAL_MACHINE\Software\Classes</code>.</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>HKEY_CURRENT_CONFIG</strong></td>
          <td>Contains information about the hardware profile that is used by the local</td>
      </tr>
      <tr>
          <td>computer at system startup.</td>
          <td></td>
      </tr>
  </tbody>
</table>
<p><strong>Accessing registry hives offline</strong></p>
<p>If you are accessing a live system, you will be able to access the
registry using regedit.exe, and you will be greeted with all of the
standard root keys we learned about in the previous task. However, if
you only have access to a disk image, you must know where the registry
hives are located on the disk. The majority of these hives are located
in the <code>C:\Windows\System32\Config</code> directory and are:</p>
<ol>
<li><strong>DEFAULT</strong> (mounted on <code>HKEY_USERS\DEFAULT</code>)</li>
<li><strong>SAM</strong> (mounted on <code>HKEY_LOCAL_MACHINE\SAM</code>)</li>
<li><strong>SECURITY</strong> (mounted on <code>HKEY_LOCAL_MACHINE\Security</code>)</li>
<li><strong>SOFTWARE</strong> (mounted on <code>HKEY_LOCAL_MACHINE\Software</code>)</li>
<li><strong>SYSTEM</strong> (mounted on <code>HKEY_LOCAL_MACHINE\System</code>)</li>
</ol>
<p><strong>Hives containing user information:</strong></p>
<p>Apart from these hives, two other hives containing user information
can be found in the User profile directory. For Windows 7 and above, a
user’s profile directory is located in <code>C:\Users\&lt;username&gt;\</code> where the hives are:</p>
<ol>
<li><strong>NTUSER.DAT</strong> (mounted on HKEY_CURRENT_USER when a user logs in)</li>
<li><strong>USRCLASS.DAT</strong> (mounted on HKEY_CURRENT_USER\Software\CLASSES)</li>
</ol>
<p>The USRCLASS.DAT hive is located in the directory <code>C:\Users\&lt;username&gt;\AppData\Local\Microsoft\Windows</code>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/3ffadf20ebe241040d659958db115c2f.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/3ffadf20ebe241040d659958db115c2f.png" />
    
  </figure>
</p>
<p>The NTUSER.DAT hive is located in the directory <code>C:\Users\&lt;username&gt;\</code>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f3091f38f680b418f89cf79128d1933c.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f3091f38f680b418f89cf79128d1933c.png" />
    
  </figure>
</p>
<p>Remember that NTUSER.DAT and USRCLASS.DAT are hidden files.</p>
<p><strong>The Amcache Hive:</strong></p>
<p>Apart from these files, there is another very important hive called the AmCache hive. This hive is located in <code>C:\Windows\AppCompat\Programs\Amcache.hve</code>. Windows creates this hive to save information on programs that were recently run on the system.</p>
<p><strong>Transaction Logs and Backups:</strong></p>
<p>Some other very vital sources of forensic data are the registry
transaction logs and backups. The transaction logs can be considered as
the journal of the changelog of the registry hive. Windows often uses
transaction logs when writing data to registry hives. This means that
the transaction logs can often have the latest changes in the registry
that haven&rsquo;t made their way to the registry hives themselves. The
transaction log for each hive is stored as a .LOG file in the same
directory as the hive itself. It has the same name as the registry hive,
but the extension is .LOG. For example, the transaction log for the SAM
hive will be located in <code>C:\Windows\System32\Config</code> in the
filename SAM.LOG. Sometimes there can be multiple transaction logs as
well. In that case, they will have .LOG1, .LOG2 etc., as their
extension. It is prudent to look at the transaction logs as well when
performing registry forensics.</p>
<p>Registry backups are the opposite of Transaction logs. These are the backups of the registry hives located in the <code>C:\Windows\System32\Config</code> directory. These hives are copied to the <code>C:\Windows\System32\Config\RegBack</code>
directory every ten days. It might be an excellent place to look if you
suspect that some registry keys might have been deleted/modified
recently.</p>
<p><strong>Data Acquisition</strong></p>
<p>When performing
forensics, we will either encounter a live system or an image taken of
the system. For the sake of accuracy, it is recommended practice to
image the system or make a copy of the required data and perform
forensics on it. This process is called data acquisition. Below we
discuss different ways to acquire registry data from a live system or a
disk image:</p>
<p>Though we can view the registry through the
registry editor, the forensically correct method is to acquire a copy of
this data and perform analysis on that. However, when we go to copy the
registry hives from <code>%WINDIR%\System32\Config</code>, we cannot because it is a restricted file. So, what to do now?</p>
<p>For acquiring these files, we can use one of the following tools:</p>
<p><strong>KAPE:</strong></p>
<p><a href="https://www.kroll.com/en/services/cyber-risk/incident-response-litigation-support/kroll-artifact-parser-extractor-kape" target="_blank">KAPE</a>
is a live data acquisition and analysis tool which can be used to
acquire registry data. It is primarily a command-line tool but also
comes with a GUI.
The below screenshot shows what the KAPE GUI looks like. We have
already selected all the settings to extract the registry data using
KAPE in this screenshot. We will learn more about collecting forensic
artifacts using KAPE in a dedicated KAPE room.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9ec88ef00c70bf2c854b4c66afbf5470.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9ec88ef00c70bf2c854b4c66afbf5470.png" />
    
  </figure>
</p>
<p><strong>Autopsy:</strong></p>
<p><a href="https://www.autopsy.com/" target="_blank">Autopsy</a> gives
you the option to acquire data from both live systems or from a disk
image. After adding your data source, navigate to the location of the
files you want to extract, then right-click and select the Extract
File(s) option. It will look similar to what you see in the screenshot
below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/5faf350078f7e7e1d1400f46e11e74a9.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/5faf350078f7e7e1d1400f46e11e74a9.png" />
    
  </figure>
</p>
<p><strong>FTK Imager:</strong></p>
<p><a href="https://www.exterro.com/ftk-imager" target="_blank">FTK Imager</a> is
similar to Autopsy and allows you to extract files from a disk image or
a live system by mounting the said disk image or drive in FTK Imager.
Below you can see the option to Export files as highlighted in the
screenshot.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/bb82d24f00e15c3d16b352cdec57f256.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/bb82d24f00e15c3d16b352cdec57f256.png" />
    
  </figure>
</p>
<p>Another
way you can extract Registry files from FTK Imager is through the
Obtain Protected Files option. This option is only available for live systems and is highlighted
in the screenshot below. This option allows you to extract all the
registry hives to a location of your choosing. However, it will not copy
the <code>Amcache.hve</code> file, which is often necessary to investigate evidence of programs that were last executed.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8292e36577413227ec24446ae1c72a35.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8292e36577413227ec24446ae1c72a35.png" />
    
  </figure>
</p>
<p><strong>Exploring Windows Registry</strong></p>
<p>Once
we have extracted the registry hives, we need a tool to view these
files as we would in the registry editor. Since the registry editor only
works with live systems and can&rsquo;t load exported hives, we can use the
following tools:</p>
<p><strong>Registry Viewer:</strong></p>
<p>As we can see in the screenshot below, <a href="https://accessdata.com/product-download/registry-viewer-2-0-0" target="_blank">AccessData&rsquo;s Registry Viewer</a> has
a similar user interface to the Windows Registry Editor. There are a
couple of limitations, though. It only loads one hive at a time, and it
can&rsquo;t take the transaction logs into account.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/888afb265fa265d771dc02ae8f610dc0.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/888afb265fa265d771dc02ae8f610dc0.png" />
    
  </figure>
</p>
<p><strong>Zimmerman&rsquo;s Registry Explorer:</strong></p>
<p>Eric Zimmerman has developed a handful of <a href="https://ericzimmerman.github.io/#!index.md" target="_blank">tools</a>
that are very useful for performing Digital Forensics and Incident
Response. One of them is the Registry Explorer. It looks like the below
screenshot. It can load multiple hives simultaneously and add data from
transaction logs into the hive to make a more &lsquo;cleaner&rsquo; hive with more
up-to-date data. It also has a handy &lsquo;Bookmarks&rsquo; option containing
forensically important registry keys often sought by forensics
investigators. Investigators can go straight to the interesting registry
keys and values with the bookmarks menu item. We will explore these in
more detail in the upcoming tasks.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/414dee2639b9456334c9580aacdc2be1.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/414dee2639b9456334c9580aacdc2be1.png" />
    
  </figure>
</p>
<p><strong>RegRipper:</strong></p>
<p><a href="https://github.com/keydet89/RegRipper3.0" target="_blank">RegRipper</a>
is a utility that takes a registry hive as input and outputs a report
that extracts data from some of the forensically important keys and
values in that hive. The output report is in a text file and shows all
the results in sequential order.</p>
<p>RegRipper is available in both a CLI and GUI form which is shown in the screenshot below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/70e6fef3920cb9b0443bc1fa9d9fac5d.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/70e6fef3920cb9b0443bc1fa9d9fac5d.png" />
    
  </figure>
</p>
<p>One
shortcoming of RegRipper is that it does not take the transaction logs
into account. We must use Registry Explorer to merge transaction logs
with the respective registry hives before sending the output to
RegRipper for a more accurate result.</p>
<p><strong>System Information and System Accounts</strong></p>
<p>Now that we have learned how to read registry data, let&rsquo;s find out
where to look in the registry to perform our forensic analysis.</p>
<p>When
we start performing forensic analysis, the first step is to find out
about the system information. This task will cover gathering information
related to a machine&rsquo;s System and Account information.</p>
<p><strong>OS</strong></p>
<p>If we only have triage data to perform forensics, we can determine the OS version from which this data was pulled through the registry. To find the OS version, we can use the following registry key:</p>
<p><code>SOFTWARE\Microsoft\Windows NT\CurrentVersion</code></p>
<p>This is how Registry Explorer shows this registry key. Take a look and answer Question # 1.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/1362c5a15d1879a1a5a5a5237a426108.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/1362c5a15d1879a1a5a5a5237a426108.png" />
    
  </figure>
</p>
<p><strong>Current control set:</strong></p>
<p>The
hives containing the machine’s configuration data used for controlling
system startup are called Control Sets. Commonly, we will see two
Control Sets, ControlSet001 and ControlSet002, in the SYSTEM hive on a
machine. In most cases, ControlSet001 will point to the Control Set that
the machine booted with, and ControlSet002 will be the <code>last known good</code> configuration. Their locations will be:</p>
<p><code>SYSTEM\ControlSet001</code></p>
<p><code>SYSTEM\ControlSet002</code></p>
<p>Windows creates a volatile Control Set when the machine is live, called the CurrentControlSet (<code>HKLM\SYSTEM\CurrentControlSet</code>).
For getting the most accurate system information, this is the hive that
we will refer to. We can find out which Control Set is being used as
the CurrentControlSet by looking at the following registry value:</p>
<p><code>SYSTEM\Select\Current</code></p>
<p>Similarly, the <code>last known good</code> configuration can be found using the following registry value:</p>
<p><code>SYSTEM\Select\LastKnownGood</code></p>
<p>This is how it looks like in Registry Explorer. Take a look and answer Question # 2.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f3b34b5e44e98e76034b76fc608a7670.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f3b34b5e44e98e76034b76fc608a7670.png" />
    
  </figure>
</p>
<p>It
is vital to establish this information before moving forward with the
analysis. As we will see, many forensic artifacts we collect will be
collected from the Control Sets.</p>
<p><strong>Computer Name:</strong></p>
<p>It
is crucial to establish the Computer Name while performing forensic
analysis to ensure that we are working on the machine we are supposed to
work on. We can find the Computer Name from the following location:</p>
<p><code>SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName</code></p>
<p>Registry Explorer shows it like this. Take a look and answer Question # 3:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/bb73d7942a6e30cb96e78926ad36fddb.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/bb73d7942a6e30cb96e78926ad36fddb.png" />
    
  </figure>
</p>
<p><strong>Time Zone Information:</strong></p>
<p>For
accuracy, it is important to establish what time zone the computer is
located in. This will help us understand the chronology of the events as
they happened. For finding the Time Zone Information, we can look at
the following location:</p>
<p><code>SYSTEM\CurrentControlSet\Control\TimeZoneInformation</code></p>
<p>Here&rsquo;s how it looks in Registry Explorer. Take a look and answer Question # 4.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/08d5e86bb3a5be6057928a8062cf7de3.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/08d5e86bb3a5be6057928a8062cf7de3.png" />
    
  </figure>
</p>
<p>Time
Zone Information is important because some data in the computer will
have their timestamps in UTC/GMT and others in the local time zone.
Knowledge of the local time zone helps in establishing a timeline when
merging data from all the sources.</p>
<p><strong>Network Interfaces and Past Networks:</strong></p>
<p>The following registry key will give a list of network interfaces on the machine we are investigating:</p>
<p><code>SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</code></p>
<p>Take a look at this registry key as shown in Registry Explorer and answer Question # 5.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/7f0ed33ad442f22ec9475488d6af4421.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/7f0ed33ad442f22ec9475488d6af4421.png" />
    
  </figure>
</p>
<p>Each
Interface is represented with a unique identifier (GUID) subkey, which
contains values relating to the interface’s TCP/IP configuration. This
key will provide us with information like IP addresses, DHCP
IP address and Subnet Mask, DNS Servers, and more. This information is
significant because it helps you make sure that you are performing
forensics on the machine that you are supposed to perform it on.</p>
<p>The past networks a given machine was connected to can be found in the following locations:</p>
<p><code>SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Unmanaged</code></p>
<p><code>SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\Managed</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/fae511770c0ac57458073992ef221251.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/fae511770c0ac57458073992ef221251.png" />
    
  </figure>
</p>
<p>These
registry keys contain past networks as well as the last time they were
connected. The last write time of the registry key points to the last
time these networks were connected.</p>
<p><strong>Autostart Programs (Autoruns):</strong></p>
<p>The following registry keys include information about programs or commands that run when a user logs on.</p>
<p><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Run</code></p>
<p><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\RunOnce</code></p>
<p><code>SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce</code></p>
<p><code>SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer\Run</code></p>
<p><code>SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6745df01d5c2f896795d5d6f481461b7.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6745df01d5c2f896795d5d6f481461b7.png" />
    
  </figure>
</p>
<p>The following registry key contains information about services:</p>
<p><code>SYSTEM\CurrentControlSet\Services</code></p>
<p>Notice the Value of the Start key in the screenshot below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/5605bfda34393bfcb8c4aee6a5ad771f.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/5605bfda34393bfcb8c4aee6a5ad771f.png" />
    
  </figure>
</p>
<p>In this registry key, if the <code>start</code> **key is set to 0x02, this means that this service will start at boot.</p>
<p><strong>SAM hive and user information:</strong></p>
<p>The
SAM hive contains user account information, login information, and
group information. This information is mainly located in the following
location:</p>
<p><code>SAM\Domains\Account\Users</code></p>
<p>Take a look at the below screenshot and answer Question # 6.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/d24056c00af7ef9e77ea25b883cdf06c.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/d24056c00af7ef9e77ea25b883cdf06c.png" />
    
  </figure>
</p>
<p>The
information contained here includes the relative identifier (RID) of
the user, number of times the user logged in, last login time, last
failed login, last password change, password expiry, password policy and
password hint, and any groups that the user is a part of.</p>
<p><strong>Usage or knowledge of files/folders</strong></p>


<h2 class="relative group"><strong>Recent Files:</strong> 
    <div id="recent-files" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#recent-files" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Windows maintains a list of recently
opened files for each user. As we might have seen when using Windows
Explorer, it shows us a list of recently used files. This information is stored in the NTUSER hive and can be found on the following location:</p>
<p><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/aff5ea8e993f2989f5f8caf94798a3c7.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/aff5ea8e993f2989f5f8caf94798a3c7.png" />
    
  </figure>
</p>
<p>Registry Explorer allows us to sort data contained in registry keys
quickly. For example, the Recent documents tab arranges the Most
Recently Used (MRU) file at the top of the list. Registry Explorer also
arranges them so that the Most Recently Used (MRU) file is shown at the
top of the list and the older ones later.</p>
<p>Another interesting piece of information in this registry key is that there are different keys with file extensions, such as <code>.pdf</code>, <code>.jpg</code>, <code>.docx</code> etc.
These keys provide us with information about the last used files of a
specific file extension. So if we are looking specifically for the last
used PDF files, we can look at the following registry key:</p>
<p><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.pdf</code></p>
<p>Registry Explorer also lists the Last Opened time of the files. Answer Question # 1 by looking at the above screenshot.</p>


<h2 class="relative group"><strong>Office Recent Files:</strong> 
    <div id="office-recent-files" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#office-recent-files" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Similar to the Recent Docs maintained by Windows Explorer, Microsoft
Office also maintains a list of recently opened documents. This list is
also located in the NTUSER hive. It can be found in the following
location:</p>
<p><code>NTUSER.DAT\Software\Microsoft\Office\VERSION</code></p>
<p>The version number for each Microsoft Office release is different. An example registry key will look like this:</p>
<p><code>NTUSER.DAT\Software\Microsoft\Office\15.0\Word</code></p>
<p>Here, the 15.0 refers to Office 2013. A list of different Office releases and their version numbers can be found on <a href="https://docs.microsoft.com/en-us/deployoffice/install-different-office-visio-and-project-versions-on-the-same-computer#office-releases-and-their-version-number" target="_blank">this link</a>.</p>
<p>Starting from Office 365, Microsoft now ties the location to the user&rsquo;s <a href="https://www.microsoft.com/security/blog/2008/05/07/what-is-a-windows-live-id/" target="_blank">live ID</a>. In such a scenario, the recent files can be found at the following location.</p>
<p><code>NTUSER.DAT\Software\Microsoft\Office\VERSION\UserMRU\LiveID_####\FileMRU</code></p>
<p>In such a scenario, the recent files can be found at the following
location. This location also saves the complete path of the most
recently used files.</p>


<h2 class="relative group"><strong>ShellBags:</strong> 
    <div id="shellbags" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#shellbags" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>When any user opens a folder, it opens in a specific layout. Users
can change this layout according to their preferences. These layouts can
be different for different folders. This information about the Windows <em>&lsquo;shell&rsquo;</em> is
stored and can identify the Most Recently Used files and folders. Since
this setting is different for each user, it is located in the user
hives. We can find this information on the following locations:</p>
<p><code>USRCLASS.DAT\Local Settings\Software\Microsoft\Windows\Shell\Bags</code></p>
<p><code>USRCLASS.DAT\Local Settings\Software\Microsoft\Windows\Shell\BagMRU</code></p>
<p><code>NTUSER.DAT\Software\Microsoft\Windows\Shell\BagMRU</code></p>
<p><code>NTUSER.DAT\Software\Microsoft\Windows\Shell\Bags</code></p>
<p>Registry Explorer doesn&rsquo;t give us much information about ShellBags.
However, another tool from Eric Zimmerman&rsquo;s tools called the ShellBag
Explorer shows us the information in an easy-to-use format. We just have
to point to the hive file we have extracted, and it parses the data and
shows us the results. An example is shown below. Take a look and answer
Question # 2.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/666bd5bd3db41b4b6e3f09311f25666a.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/666bd5bd3db41b4b6e3f09311f25666a.png" />
    
  </figure>
</p>


<h2 class="relative group"><strong>Open/Save and LastVisited Dialog MRUs:</strong> 
    <div id="opensave-and-lastvisited-dialog-mrus" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#opensave-and-lastvisited-dialog-mrus" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>When we open or save a file, a dialog box appears asking us where to
save or open that file from. It might be noticed that once we open/save a
file at a specific location, Windows remembers that location. This
implies that we can find out recently used files if we get our hands on
this information. We can do so by examining the following registry keys</p>
<pre tabindex="0"><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePIDlMRU
</code></pre><p><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU</code></p>
<p>This is how Registry Explorer shows this registry key. Take a look to answer Question # 3 and 4.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/e996b8939895b4b5e55e780baa4335e9.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/e996b8939895b4b5e55e780baa4335e9.png" />
    
  </figure>
</p>


<h2 class="relative group"><strong>Windows Explorer Address/Search Bars:</strong> 
    <div id="windows-explorer-addresssearch-bars" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#windows-explorer-addresssearch-bars" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Another way to identify a user&rsquo;s recent activity is by looking at the
paths typed in the Windows Explorer address bar or searches performed
using the following registry keys, respectively.</p>
<p><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths</code></p>
<p><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery</code></p>
<p>Here is how the TypedPaths key looks like in Registry Explorer:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/782204163443e8f21ddd14297ba756dd.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/782204163443e8f21ddd14297ba756dd.png" />
    
  </figure>
</p>
<p><strong>Evidence of Execution</strong></p>
<p><strong>UserAssist
:</strong></p>
<p>Windows
keeps track of applications launched by the user using Windows Explorer
for statistical purposes in the User Assist registry keys. These keys
contain information about the programs launched, the time of their
launch, and the number of times they were executed. However, programs
that were run using the command line can&rsquo;t be found in the User Assist
keys. The User Assist key is present in the NTUSER hive, mapped to each
user&rsquo;s GUID. We can find it at the following location:</p>
<p><code>NTUSER.DAT\Software\Microsoft\Windows\Currentversion\Explorer\UserAssist\{GUID}\Count</code></p>
<p>Take a look at the below screenshot from Registry Explorer and answer Question #1.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9bd8461865865ac3ff774c8a88d1afd5.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9bd8461865865ac3ff774c8a88d1afd5.png" />
    
  </figure>
</p>


<h1 class="relative group"><strong>ShimCache:</strong> 
    <div id="shimcache" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#shimcache" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>ShimCache is a mechanism used to keep track of application compatibility with the OS and tracks all applications launched
on the machine. Its main purpose in Windows is to ensure backward
compatibility of applications. It is also called Application
Compatibility Cache (AppCompatCache). It is located in the following
location in the SYSTEM hive:</p>
<p><code>SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache</code></p>
<p>ShimCache stores file name, file size, and last modified time of the executables.</p>
<p>Our
goto tool, the Registry Explorer, doesn&rsquo;t parse ShimCache data in a
human-readable format, so we go to another tool called AppCompatCache
Parser, also a part of Eric Zimmerman&rsquo;s tools. It takes the SYSTEM hive
as input, parses the data, and outputs a CSV file that looks like this:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/aad7dc918dbf3b1ab207dd71d03e8c0c.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/aad7dc918dbf3b1ab207dd71d03e8c0c.png" />
    
  </figure>
</p>
<p>We can use the following command to run the AppCompatCache Parser Utility:</p>
<p><code>AppCompatCacheParser.exe --csv &lt;path to save output&gt; -f &lt;path to SYSTEM hive for data  parsing&gt; -c &lt;control set to parse&gt;</code></p>
<p>The output can be viewed using EZviewer, another one of Eric Zimmerman&rsquo;s tools.</p>
<p><strong>AmCache:</strong></p>
<p>The
AmCache hive is an artifact related to ShimCache. This performs a
similar function to ShimCache, and stores additional data related to
program executions. This data includes execution path, installation,
execution and deletion times, and SHA1 hashes of the executed programs.
This hive is located in the file system at:</p>
<p><code>C:\Windows\appcompat\Programs\Amcache.hve</code></p>
<p>Information about the last executed programs can be found at the following location in the hive:</p>
<p><code>Amcache.hve\Root\File\{Volume GUID}\</code></p>
<p>This is how Registry Explorer parses the AmCache hive:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a569dfdf155c1a26fe3a693c388a44c7.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a569dfdf155c1a26fe3a693c388a44c7.png" />
    
  </figure>
</p>
<p><strong>BAM/DAM:</strong></p>
<p>Background
Activity Monitor or BAM keeps a tab on the activity of background
applications. Similar Desktop Activity Moderator or DAM is a part of
Microsoft Windows that optimizes the power consumption of the device.
Both of these are a part of the Modern Standby system in Microsoft
Windows.</p>
<p>In the Windows registry, the following locations contain
information related to BAM and DAM. This location contains information
about last run programs, their full paths, and last execution time.</p>
<p><code>SYSTEM\CurrentControlSet\Services\bam\UserSettings\{SID}</code></p>
<p><code>SYSTEM\CurrentControlSet\Services\dam\UserSettings\{SID}</code></p>
<p>Below you can see how Registry Explorer parses data from BAM:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8a672c6580ab63d757ee5c08c09c924a.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8a672c6580ab63d757ee5c08c09c924a.png" />
    
  </figure>
</p>
<p><strong>External Devices/USB device forensics</strong></p>
<p>When performing
forensics on a machine, often the need arises to identify if any USB or
removable drives were attached to the machine. If so, any information
related to those devices is important for a forensic investigator. In
this task, we will go through the different ways to find information on
connected devices and the drives on a system using the registry.</p>


<h1 class="relative group">Device identification: 
    <div id="device-identification" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#device-identification" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The
following locations keep track of USB keys plugged into a system. These
locations store the vendor id, product id, and version of the USB
device plugged in and can be used to identify unique devices. These
locations also store the time the devices were plugged into the system.</p>
<p><code>SYSTEM\CurrentControlSet\Enum\USBSTOR</code></p>
<p><code>SYSTEM\CurrentControlSet\Enum\USB</code></p>
<p>Registry
Explorer shows this information in a nice and easy-to-understand way.
Take a look at this and answer Questions # 1 and 2.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/03c87eaaf8458db97ffbddd30a6463e8.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/03c87eaaf8458db97ffbddd30a6463e8.png" />
    
  </figure>
</p>


<h1 class="relative group">First/Last Times: 
    <div id="firstlast-times" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#firstlast-times" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Similarly,
the following registry key tracks the first time the device was
connected, the last time it was connected and the last time the device
was removed from the system.</p>
<p><code>SYSTEM\CurrentControlSet\Enum\USBSTOR\Ven_Prod_Version\USBSerial#\Properties\{83da6326-97a6-4088-9453-a19231573b29}\####</code></p>
<p>In this key, the #### sign can be replaced by the following digits to get the required information:</p>
<table>
  <thead>
      <tr>
          <th><strong>Value</strong></th>
          <th><strong>Information</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0064</td>
          <td>First Connection time</td>
      </tr>
      <tr>
          <td>0066</td>
          <td>Last Connection time</td>
      </tr>
      <tr>
          <td>0067</td>
          <td>Last removal time</td>
      </tr>
  </tbody>
</table>
<p>Although
we can check this value manually, as we have seen above, Registry
Explorer already parses this data and shows us if we select the USBSTOR
key.</p>
<p><strong>USB device Volume Name:</strong></p>
<p>The device name of the connected drive can be found at the following location:</p>
<p><code>SOFTWARE\Microsoft\Windows Portable Devices\Devices</code></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6c9f71cdf4c71afdc19fc8c254a6a3cc.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6c9f71cdf4c71afdc19fc8c254a6a3cc.png" />
    
  </figure>
</p>
<p>We
can compare the GUID we see here in this registry key and compare it
with the Disk ID we see on keys mentioned in device identification to
correlate the names with unique devices. Take a look at these two
screenshots and answer Question # 3.</p>
<p><strong>The FAT file systems</strong></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/776f8e49bad9fe979ef112c2ace58b33.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/776f8e49bad9fe979ef112c2ace58b33.png" />
    
  </figure>
</p>
<p>A
storage device in a computer system, for example, a hard disk drive or a
USB device, is just a collection of bits. To convert these bits into
meaningful information, they need to be organized. For this purpose,
computer scientists and engineers have created different file systems
that organize the bits in a hard drive as per a standard, so that
information stored in these bits can be interpreted easily.</p>


<h2 class="relative group">The File Allocation Table (FAT): 
    <div id="the-file-allocation-table-fat" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-file-allocation-table-fat" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>The
File Allocation Table (FAT) is one of these file systems. It has been
the default file system for Microsoft Operating Systems since at least
the late 1970s and is still in use, though not the default anymore. As
the name suggests, the File Allocation Table creates a table that
indexes the location of bits that are allocated to different files. If
you are interested in the history of the FAT file system, you can head
to the <a href="https://en.wikipedia.org/wiki/File_Allocation_Table" target="_blank">Wikipedia page</a> for it.</p>


<h2 class="relative group"><strong>Data structures of the FAT file system:</strong> 
    <div id="data-structures-of-the-fat-file-system" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#data-structures-of-the-fat-file-system" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>The FAT file system supports the following Data structures:</p>


<h3 class="relative group">Clusters: 
    <div id="clusters" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#clusters" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>A cluster is a basic storage unit of the FAT file system. Each file
stored on a storage device can be considered a group of clusters
containing bits of information.</p>


<h3 class="relative group">Directory: 
    <div id="directory" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#directory" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>A directory contains information about file identification, like file name, starting cluster, and filename length.</p>


<h3 class="relative group">File Allocation Table: 
    <div id="file-allocation-table" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#file-allocation-table" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The File Allocation Table is a linked list of all the clusters. It
contains the status of the cluster and the pointer to the next cluster
in the chain.</p>
<p>In summary, the bits that make up a file are stored in clusters. All
the filenames on a file system, their starting clusters, and their
lengths are stored in directories. And the location of each cluster on
the disk is stored in the File Allocation Table. We can see that we
started with a raw disk composed of bits and organized it to define what
group of bits refers to what file stored on the disk.</p>


<h2 class="relative group"><strong>FAT12, FAT16, and FAT32:</strong> 
    <div id="fat12-fat16-and-fat32" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#fat12-fat16-and-fat32" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/182f455a34bfcbd86d4a5f1ecca0286b.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/182f455a34bfcbd86d4a5f1ecca0286b.png" />
    
  </figure>
</p>
<p>The FAT file format divides the available disk space into clusters
for more straightforward addressing. The number of these clusters
depends on the number of bits used to address the cluster. Hence the
different variations of the FAT file system. FAT was initially developed
with 8-bit cluster addressing, and it was called the FAT Structure.
Later, as the storage needed to be increased, FAT12, FAT16, and FAT32
were introduced. The last one of them was introduced in 1996.</p>
<p>Theoretically, FAT12 used 12-bit cluster addressing for a maximum of
4096 clusters(2^12). FAT16 used 16-bit cluster addressing for a maximum
of 65,536 clusters (2^16). In the case of FAT32, the actual bits used to
address clusters are 28, so the maximum number of clusters is actually
268,435,456 or 2^28. However, not all of these clusters are used for
file storage. Some are used for administrative purposes, e.g., to store
the end of a chain of clusters, the unusable parts of the disk, or other
such purposes.</p>
<p>The following table summarizes the information as mentioned earlier and how it impacts the maximum volume and file sizes:</p>
<table>
  <thead>
      <tr>
          <th><strong>Attribute</strong></th>
          <th><strong>FAT12</strong></th>
          <th><strong>FAT16</strong></th>
          <th><strong>FAT32</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Addressable bits</strong></td>
          <td>12</td>
          <td>16</td>
          <td>28</td>
      </tr>
      <tr>
          <td><strong>Max number of clusters</strong></td>
          <td>4,096</td>
          <td>65,536</td>
          <td>268,435,456</td>
      </tr>
      <tr>
          <td><strong>Supported size of clusters</strong></td>
          <td>512B - 8KB</td>
          <td>2KB - 32KB</td>
          <td>4KB - 32KB</td>
      </tr>
      <tr>
          <td><strong>Maximum Volume size</strong></td>
          <td>32MB</td>
          <td>2GB</td>
          <td>2TB</td>
      </tr>
  </tbody>
</table>
<p>Even though the maximum volume size for FAT32 is 2TB, Windows limits
formatting to only 32GB. However, volume sizes formatted on other OS
with larger volume sizes are supported by Windows.</p>
<p>The chances of
coming across a FAT12 filesystem are very rare nowadays. FAT16 and FAT32
are still used in some places, like USB drives, SD cards, or Digital
cameras. However, the maximum volume size and the maximum file size (4GB</p>
<ul>
<li>1 file size for both FAT16 and FAT32) are limiting factors that have
reduced their usage.</li>
</ul>


<h2 class="relative group"><strong>The exFAT file system:</strong> 
    <div id="the-exfat-file-system" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-exfat-file-system" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>As the file sizes have grown, especially with higher resolution
images and videos being supported by the newer digital cameras, the
maximum file size limit of FAT32 became a substantial limiting factor
for camera manufacturers. Though Microsoft had moved on to the NTFS file
system, it was not suitable for digital media devices as they did not
need the added security features and the overhead that came with it.
Therefore, these manufacturers lobbied Microsoft to create the exFAT
file system.</p>
<p>The exFAT file system is now the default for SD cards
larger than 32GB. It has also been adopted widely by most manufacturers
of digital devices. The exFAT file system supports a cluster size of
4KB to 32MB. It has a maximum file size and a maximum volume size of
128PB (Petabytes). It also reduces some of the overheads of the FAT file
system to make it lighter and more efficient. It can have a maximum of
2,796,202 files per directory.</p>
<p><strong>The NTFS File System</strong></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/bef41dd6a6e84e675c8106a6d5fe4b3b.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/bef41dd6a6e84e675c8106a6d5fe4b3b.png" />
    
  </figure>
</p>


<h2 class="relative group"><strong>The NTFS file system</strong> 
    <div id="the-ntfs-file-system" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-ntfs-file-system" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>As observed in the previous task, the FAT file system is a very basic
file system. It does the job when it comes to organizing our data, but
it offers little more in terms of security, reliability, and recovery
capabilities. It also has certain limitations when it comes to file and
volume sizes. Hence, Microsoft developed a newer file system called the
New Technology File System (NTFS) to add these features. This file
system was introduced in 1993 with the Windows NT 3.1. However, it
became mainstream since Windows XP. The NTFS file system resolves many
issues present in the FAT file system and introduces a lot of new
features. We will discuss some of the features below.</p>


<h3 class="relative group">Journaling 
    <div id="journaling" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#journaling" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The NTFS file system keeps a log of changes to the metadata in the
volume. This feature helps the system recover from a crash or data
movement due to defragmentation. This log is stored in $LOGFILE in the
volume&rsquo;s root directory. Hence the NTFS file system is called a
journaling file system.</p>


<h3 class="relative group">Access Controls 
    <div id="access-controls" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#access-controls" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The FAT file system did not have access controls based on the user.
The NTFS file system has access controls that define the owner of a
file/directory and permissions for each user.</p>


<h3 class="relative group">Volume Shadow Copy 
    <div id="volume-shadow-copy" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#volume-shadow-copy" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The NTFS file system keeps track of changes made to a file using a
feature called Volume Shadow Copies. Using this feature, a user can
restore previous file versions for recovery or system restore. In recent
ransomware attacks, ransomware actors have been noted to delete the
shadow copies on a victim&rsquo;s file systems to prevent them from recovering
their data.</p>


<h3 class="relative group">Alternate Data Streams 
    <div id="alternate-data-streams" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#alternate-data-streams" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>A file is a stream of data organized in a file system. Alternate data
streams (ADS) is a feature in NTFS that allows files to have multiple
streams of data stored in a single file. Internet Explorer and other
browsers use Alternate Data Streams to identify files downloaded from
the internet (using the ADS Zone Identifier). Malware has also been
observed to hide their code in ADS.</p>


<h2 class="relative group"><strong>Master File Table</strong> 
    <div id="master-file-table" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#master-file-table" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Like the File Allocation Table, there is a Master File Table in NTFS.
However, the Master File Table, or MFT, is much more extensive than the
File Allocation Table. It is a structured database that tracks the
objects stored in a volume. Therefore, we can say that the NTFS file
system data is organized in the Master File Table. From a forensics
point of view, the following are some of the critical files in the MFT:</p>


<h3 class="relative group">$MFT 
    <div id="mft" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#mft" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The $MFT is the first record in the volume. The Volume Boot Record
(VBR) points to the cluster where it is located. $MFT stores information
about the clusters where all other objects present on the volume are
located. This file contains a directory of all the files present on the
volume.</p>


<h3 class="relative group">$LOGFILE 
    <div id="logfile" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#logfile" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The $LOGFILE stores the transactional logging of the file system. It
helps maintain the integrity of the file system in the event of a crash.</p>


<h3 class="relative group">$UsnJrnl 
    <div id="usnjrnl" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#usnjrnl" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>It stands for the Update Sequence Number (USN) Journal. It is present
in the $Extend record. It contains information about all the files that
were changed in the file system and the reason for the change. It is
also called the change journal.</p>


<h3 class="relative group">MFT Explorer 
    <div id="mft-explorer" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#mft-explorer" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>MFT Explorer is one of Eric Zimmerman&rsquo;s tools used to explore MFT
files. It is available in both command line and GUI versions. We will be
using the CLI version for this task.</p>
<p>Start the machine attached
with the task. It will open in the split view. If preferred, login to
the machine through RDP using the following credentials:</p>
<p>Username: thm-4n6</p>
<p>Password: 123</p>
<p>Open an elevated command prompt (right-click command prompt, and click <code>Run as Administrator</code>). Navigate to the directory <code>C:\Users\THM-4n6\Desktop\Eztools</code> and run the command <code>MFTECmd.exe</code>. You will see the following options:</p>
<p>Administrator: Command Prompt</p>
<pre tabindex="0"><code>user@machine$ MFTECmd.exeMFTECmd version 0.5.0.1

Author: Eric Zimmerman (saericzimmerman@gmail.com)
https://github.com/EricZimmerman/MFTECmd

        f               File to process ($MFT | $J | $LogFile | $Boot | $SDS). Required        m               $MFT file to use when -f points to a $J file (Use this to resolve parent path in $J CSV output).        json            Directory to save JSON formatted results to. This or --csv required unless --de or --body is specified
        jsonf           File name to save JSON formatted results to. When present, overrides default name
        csv             Directory to save CSV formatted results to. This or --json required unless --de or --body is specified
        csvf            File name to save CSV formatted results to. When present, overrides default name

        body            Directory to save bodyfile formatted results to. --bdl is also required when using this option
        bodyf           File name to save body formatted results to. When present, overrides default name
        bdl             Drive letter (C, D, etc.) to use with bodyfile. Only the drive letter itself should be provided
        blf             When true, use LF vs CRLF for newlines. Default is FALSE

        dd              Directory to save exported FILE record. --do is also required when using this option
        do              Offset of the FILE record to dump as decimal or hex. Ex: 5120 or 0x1400 Use --de or --vl 1 to see offsets

        de              Dump full details for entry/sequence #. Format is &#39;Entry&#39; or &#39;Entry-Seq&#39; as decimal or hex. Example: 5, 624-5 or 0x270-0x5.        fls             When true, displays contents of directory specified by --de. Ignored when --de points to a file.
        ds              Dump full details for Security Id as decimal or hex. Example: 624 or 0x270

        dt              The custom date/time format to use when displaying time stamps. Default is: yyyy-MM-dd HH:mm:ss.fffffff
        sn              Include DOS file name types. Default is FALSE
        fl              Generate condensed file listing. Requires --csv. Default is FALSE
        at              When true, include all timestamps from 0x30 attribute vs only when they differ from 0x10. Default is FALSE

        vss             Process all Volume Shadow Copies that exist on drive specified by -f . Default is FALSE
        dedupe          Deduplicate -f &amp; VSCs based on SHA-1. First file found wins. Default is FALSE

        debug           Show debug information during processing
        trace           Show trace information during processing

Examples: MFTECmd.exe -f &#34;C:\Temp\SomeMFT&#34; --csv &#34;c:\temp\out&#34; --csvf MyOutputFile.csv
          MFTECmd.exe -f &#34;C:\Temp\SomeMFT&#34; --csv &#34;c:\temp\out&#34;
          MFTECmd.exe -f &#34;C:\Temp\SomeMFT&#34; --json &#34;c:\temp\jsonout&#34;
          MFTECmd.exe -f &#34;C:\Temp\SomeMFT&#34; --body &#34;c:\temp\bout&#34; --bdl c
          MFTECmd.exe -f &#34;C:\Temp\SomeMFT&#34; --de 5-5

          Short options (single letter) are prefixed with a single dash. Long commands are prefixed with two dashes
</code></pre><p>MFTECmd parses data from the different files created by the NTFS file
system like $MFT, $Boot, etc. The above screenshot shows the available
options for parsing MFT files. For parsing the $MFT file, we can use the
following command:</p>
<p><code>MFTECmd.exe -f &lt;path-to-$MFT-file&gt; --csv &lt;path-to-save-results-in-csv&gt;</code></p>
<p>You can then use the EZviewer tool inside the EZtools folder to view
the output of MFTECmd, or to view CSV files in the next tasks as well.
You will see that it lists information about all the files present on
the volume. You can similarly parse the $Boot file, which will provide
information about the boot sector of the volume. MFTECmd doesn&rsquo;t support
$LOGFILE as of now.</p>
<p>Let&rsquo;s parse the MFT files present on the location <code>C:\users\THM-4n6\Desktop\triage\C\</code> in the attached VM and answer the questions below. Currently, MFTECmd.exe doesn&rsquo;t support $Logfile.</p>
<p><strong>Recovering deleted files</strong></p>


<h2 class="relative group"><strong>Deleted files and Data recovery:</strong> 
    <div id="deleted-files-and-data-recovery" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#deleted-files-and-data-recovery" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Understanding the file systems makes it easier to know how files are
deleted, recovered, and wiped. As we learned in the previous two tasks, a
file system stores the location of a file on the disk in a table or a
database. When we delete a file from the file system, the file system
deletes the entries that store the file&rsquo;s location on the disk. For the
file system, the location where the file existed is now available for
writing or unallocated. However, the file contents on disk are still
there, as long as they are not overwritten by the file system while
copying another file or by the disk firmware while performing
maintenance on the disk.</p>
<p>Similarly, there is data on the disk in
different unallocated clusters, which can possibly be recovered. To
recover this data, we have to understand the file structure of different
file types to identify the specific file through the data we see in a
hex editor. However, we will not cover that in this room. What we will
do, is to use a tool that does this work for us and identifies deleted
files in a disk image file. But what is a disk image file?</p>


<h3 class="relative group">Disk Image: 
    <div id="disk-image" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#disk-image" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>A disk image file is a file that contains a bit-by-bit copy of a disk
drive. A bit-by-bit copy saves all the data in a disk image file,
including the metadata, in a single file. Thus, while performing
forensics, one can make several copies of the physical evidence, i.e.,
the disk, and use them for investigation. This helps in two ways. 1) The
original evidence is not contaminated while performing forensics, and
2) The disk image file can be copied to another disk and analyzed
without using specialized hardware.</p>


<h3 class="relative group">Recovering files using Autopsy 
    <div id="recovering-files-using-autopsy" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#recovering-files-using-autopsy" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>With that out of the way, let&rsquo;s see how we can recover deleted files
from a disk. We will use Autopsy for recovering deleted files. For a
room dedicated to Autopsy, you can go <a href="https://tryhackme.com/room/btautopsye0" target="_blank">here</a>.</p>
<p>On
the attached VM, you will find an icon for Autopsy on the Desktop.
Double-click it to run Autopsy. You will be greeted with the following
screen:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/1efa320c87b2f2d564e60bf4c6ec6dc5.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/1efa320c87b2f2d564e60bf4c6ec6dc5.png" />
    
  </figure>
</p>
<p>Click on the &lsquo;New Case&rsquo; Option. You will find a window similar to the following:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/1411fbe2ad57d4cd474be027c72b3968.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/1411fbe2ad57d4cd474be027c72b3968.png" />
    
  </figure>
</p>
<p>Enter a name to save your case by, and click Next.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a60c87484f00a38ce9e5250cb3b85055.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a60c87484f00a38ce9e5250cb3b85055.png" />
    
  </figure>
</p>
<p>You
can add the required details here. For now, we can click Finish to move
forward. Autopsy will perform some processing and then show the
following screen. Click Next to move forward.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/77d222f83d80c4682301a809fb98999f.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/77d222f83d80c4682301a809fb98999f.png" />
    
  </figure>
</p>
<p>You
will see this screen. Since we will be performing analysis on a disk
image, select the topmost option, Disk Image or VM File.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/83d738a83fc1dd47e49106508087fab7.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/83d738a83fc1dd47e49106508087fab7.png" />
    
  </figure>
</p>
<p>It will ask you for the location of the data source.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/deb3837cf6fd3766b084cc4ecb006650.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/deb3837cf6fd3766b084cc4ecb006650.png" />
    
  </figure>
</p>
<p>Provide
the location of the data source. You will find a disk image named
&lsquo;usb.001&rsquo; on the Desktop. Provide the path to that file in the above
window and click next. You will see the following window:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/99a0874ffec490f0468910cc2990ec2f.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/99a0874ffec490f0468910cc2990ec2f.png" />
    
  </figure>
</p>
<p>Here,
click Deselect All. These are different modules that Autopsy runs on
the data for processing. For this task, we don&rsquo;t need any of these. If
enabled, they take a lot of time to run. Click Next after clicking
Deselect All. Autopsy will load the disk image. You will see the
following in the left panel.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6aa98fadbab058ee3d760e520198d2f1.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/6aa98fadbab058ee3d760e520198d2f1.png" />
    
  </figure>
</p>
<p>The
Data Sources show the data sources that we have added to Autopsy. We
can add more sources as well. The File Views and Tags menus show what
Autopsy has found after processing the data. Expand the Data Sources,
and click on the usb.001 device. Autopsy will show the contents of the
disk image in the following way:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/905832f92232c0e982fb84588d5fea1f.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/905832f92232c0e982fb84588d5fea1f.png" />
    
  </figure>
</p>
<p>The
contents of the disk are shown on the right side. All the files and
folders present in the disk are listed in the upper tab. In the lower
tab, details about the selected files are shown. There are different
options to see the details here. You can check them out to find
interesting information.</p>
<p>Notice the X mark on the last file in the
screenshot above, named New Microsoft Excel
Worksheet.xlsx~RFcd07702.TMP. This indicates that this is a deleted
file. Deleted files will have this X mark on them. To recover a deleted
file, right-click on it, and select the Extract File(s) option.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/14acd357e9c89b8ce8297b076ed43c02.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/14acd357e9c89b8ce8297b076ed43c02.png" />
    
  </figure>
</p>
<p><strong>Evidence of Execution</strong></p>
<p>Now that we have
learned about the File system, let&rsquo;s learn where to find artifacts
present in the file system to perform forensic analysis. In this task,
we will look into the artifacts that provide us evidence of execution:</p>


<h2 class="relative group">Windows Prefetch files 
    <div id="windows-prefetch-files" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#windows-prefetch-files" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>When a program is run in Windows, it stores its information for
future use. This stored information is used to load the program quickly
in case of frequent use. This information is stored in prefetch files
which are located in the <code>C:\Windows\Prefetch</code> directory.</p>
<p>Prefetch files have an extension of <code>.pf</code>. Prefetch files
contain the last run times of the application, the number of times the
application was run, and any files and device handles used by the file.
Thus it forms an excellent source of information about the last executed
programs and files.</p>
<p>We can use Prefetch Parser (PECmd.exe) from
Eric Zimmerman&rsquo;s tools for parsing Prefetch files and extracting data.
When we run PECmd.exe in an elevated command prompt, we get this output:</p>
<p>Administrator: Command Prompt</p>
<pre tabindex="0"><code>user@machine$ PECmd.exePECmd version 1.4.0.0

Author: Eric Zimmerman (saericzimmerman@gmail.com)
https://github.com/EricZimmerman/PECmd

        d               Directory to recursively process. Either this or -f is required
        f               File to process. Either this or -d is required
        k               Comma separated list of keywords to highlight in output. By default, &#39;temp&#39; and &#39;tmp&#39; are highlighted. Any additional keywords will be added to these.
        o               When specified, save prefetch file bytes to the given path. Useful to look at decompressed Win10 files
        q               Do not dump full details about each file processed. Speeds up processing when using --json or --csv. Default is FALSE

        json            Directory to save json representation to.
        jsonf           File name to save JSON formatted results to. When present, overrides default name
        csv             Directory to save CSV results to. Be sure to include the full path in double quotes
        csvf            File name to save CSV formatted results to. When present, overrides default name
        html            Directory to save xhtml formatted results to. Be sure to include the full path in double quotes
        dt              The custom date/time format to use when displaying timestamps. See https://goo.gl/CNVq0k for options. Default is: yyyy-MM-dd HH:mm:ss
        mp              When true, display higher precision for timestamps. Default is FALSE

        vss             Process all Volume Shadow Copies that exist on drive specified by -f or -d . Default is FALSE
        dedupe          Deduplicate -f or -d &amp; VSCs based on SHA-1. First file found wins. Default is TRUE

        debug           Show debug information during processing
        trace           Show trace information during processing

Examples: PECmd.exe -f &#34;C:\Temp\CALC.EXE-3FBEF7FD.pf&#34;
          PECmd.exe -f &#34;C:\Temp\CALC.EXE-3FBEF7FD.pf&#34; --json &#34;D:\jsonOutput&#34; --jsonpretty
          PECmd.exe -d &#34;C:\Temp&#34; -k &#34;system32, fonts&#34;
          PECmd.exe -d &#34;C:\Temp&#34; --csv &#34;c:\temp&#34; --csvf foo.csv --json c:\temp\json
          PECmd.exe -d &#34;C:\Windows\Prefetch&#34;

          Short options (single letter) are prefixed with a single dash. Long commands are prefixed with two dashes

Either -f or -d is required. Exiting
</code></pre><p>To run Prefetch Parser on a file and save the results in a CSV, we can use the following command:</p>
<p><code>PECmd.exe -f &lt;path-to-Prefetch-files&gt; --csv &lt;path-to-save-csv&gt;</code></p>
<p>Similarly, for parsing a whole directory, we can use the following command:</p>
<p><code>PECmd.exe -d &lt;path-to-Prefetch-directory&gt; --csv &lt;path-to-save-csv&gt;</code></p>
<p>We can use this information to answer the questions at the end.</p>


<h2 class="relative group">Windows 10 Timeline 
    <div id="windows-10-timeline" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#windows-10-timeline" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Windows 10 stores recently used applications and files in an SQLite
database called the Windows 10 Timeline. This data can be a source of
information about the last executed programs. It contains the
application that was executed and the focus time of the application. The
Windows 10 timeline can be found at the following location:</p>
<p><code>C:\Users\&lt;username&gt;\AppData\Local\ConnectedDevicesPlatform\{randomfolder}\ActivitiesCache.db</code></p>
<p>We can use Eric Zimmerman&rsquo;s WxTCmd.exe for parsing Windows 10 Timeline. We get the following options when we run it:</p>
<p>Administrator: Command Prompt</p>
<pre tabindex="0"><code>user@machine$ WxTCmd.exeWxTCmd version 0.6.0.0

Author: Eric Zimmerman (saericzimmerman@gmail.com)
https://github.com/EricZimmerman/WxTCmd

        f               File to process. Required
        csv             Directory to save CSV formatted results to. Be sure to include the full path in double quotes
        dt              The custom date/time format to use when displaying timestamps. See https://goo.gl/CNVq0k for options. Default is: yyyy-MM-dd HH:mm:ss

Examples: WxTCmd.exe -f &#34;C:\Users\eric\AppData\Local\ConnectedDevicesPlatform\L.eric\ActivitiesCache.db&#34; --csv c:\temp

          Database files are typically found at &#39;C:\Users\\AppData\Local\ConnectedDevicesPlatform\L.\ActivitiesCache.db&#39;

          Short options (single letter) are prefixed with a single dash. Long commands are prefixed with two dashes

-f is required. Exiting
</code></pre><p>We can use the following command to run WxTCmd:</p>
<p><code>WxTCmd.exe -f &lt;path-to-timeline-file&gt; --csv &lt;path-to-save-csv&gt;</code></p>


<h2 class="relative group">Windows Jump Lists 
    <div id="windows-jump-lists" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#windows-jump-lists" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Windows introduced jump lists to help users go directly to their
recently used files from the taskbar. We can view jumplists by
right-clicking an application&rsquo;s icon in the taskbar, and it will show us
the recently opened files in that application. This data is stored in
the following directory:</p>
<p><code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations</code></p>
<p>Jumplists include information about the applications executed, first
time of execution, and last time of execution of the application against
an AppID.</p>
<p>We can use Eric Zimmerman&rsquo;s JLECmd.exe to parse Jump Lists. We get the following options when we run it:</p>
<p>Administrator: Command Prompt</p>
<pre tabindex="0"><code>user@machine$ JLECmd.exeJLECmd version 1.4.0.0

Author: Eric Zimmerman (saericzimmerman@gmail.com)
https://github.com/EricZimmerman/JLECmd

        d               Directory to recursively process. Either this or -f is required
        f               File to process. Either this or -d is required
        q               Only show the filename being processed vs all output. Useful to speed up exporting to json and/or csv. Default is FALSE

        all             Process all files in directory vs. only files matching *.automaticDestinations-ms or *.customDestinations-ms. Default is FALSE

        csv             Directory to save CSV formatted results to. Be sure to include the full path in double quotes
        csvf            File name to save CSV formatted results to. When present, overrides default name

        html            Directory to save xhtml formatted results to. Be sure to include the full path in double quotes
        json            Directory to save json representation to. Use --pretty for a more human readable layout
        pretty          When exporting to json, use a more human readable layout. Default is FALSE

        ld              Include more information about lnk files. Default is FALSE
        fd              Include full information about lnk files (Alternatively, dump lnk files using --dumpTo and process with LECmd). Default is FALSE

        appIds          Path to file containing AppIDs and descriptions (appid|description format). New appIds are added to the built-in list, existing appIds will have their descriptions updated
        dumpTo          Directory to save exported lnk files
        withDir         When true, show contents of Directory not accounted for in DestList entries
        Debug           Debug mode

        dt              The custom date/time format to use when displaying timestamps. See https://goo.gl/CNVq0k for options. Default is: yyyy-MM-dd HH:mm:ss
        mp              Display higher precision for timestamps. Default is FALSE

Examples: JLECmd.exe -f &#34;C:\Temp\f01b4d95cf55d32a.customDestinations-ms&#34; --mp
          JLECmd.exe -f &#34;C:\Temp\f01b4d95cf55d32a.automaticDestinations-ms&#34; --json &#34;D:\jsonOutput&#34; --jsonpretty
          JLECmd.exe -d &#34;C:\CustomDestinations&#34; --csv &#34;c:\temp&#34; --html &#34;c:\temp&#34; -q
          JLECmd.exe -d &#34;C:\Users\e\AppData\Roaming\Microsoft\Windows\Recent&#34; --dt &#34;ddd yyyy MM dd HH:mm:ss.fff&#34;

          Short options (single letter) are prefixed with a single dash. Long commands are prefixed with two dashes

Either -f or -d is required. Exiting
</code></pre><p>We can use the following command to parse Jumplists using JLECmd.exe:</p>
<p><code>JLECmd.exe -f &lt;path-to-Jumplist-file&gt; --csv &lt;path-to-save-csv&gt;</code></p>
<p><strong>File/folder knowledge</strong></p>


<h2 class="relative group">Shortcut Files 
    <div id="shortcut-files" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#shortcut-files" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Windows creates a shortcut file for each file opened either locally
or remotely. The shortcut files contain information about the first and
last opened times of the file and the path of the opened file, along
with some other data. Shortcut files can be found in the following
locations:</p>
<p><code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\</code></p>
<p><code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Office\Recent\</code></p>
<p>We
can use Eric Zimmerman&rsquo;s LECmd.exe (Lnk Explorer) to parse Shortcut
files. When we run the LECmd.exe, we see the following options:</p>
<p>Administrator: Command Prompt</p>
<pre tabindex="0"><code>user@machine$ LECmd.exeLECmd version 1.4.0.0

Author: Eric Zimmerman (saericzimmerman@gmail.com)
https://github.com/EricZimmerman/LECmd

        d               Directory to recursively process. Either this or -f is required
        f               File to process. Either this or -d is required
        q               Only show the filename being processed vs all output. Useful to speed up exporting to json and/or csv. Default is FALSE

        r               Only process lnk files pointing to removable drives. Default is FALSE
        all             Process all files in directory vs. only files matching *.lnk. Default is FALSE

        csv             Directory to save CSV formatted results to. Be sure to include the full path in double quotes
        csvf            File name to save CSV formatted results to. When present, overrides default name

        xml             Directory to save XML formatted results to. Be sure to include the full path in double quotes
        html            Directory to save xhtml formatted results to. Be sure to include the full path in double quotes
        json            Directory to save json representation to. Use --pretty for a more human readable layout
        pretty          When exporting to json, use a more human readable layout. Default is FALSE

        nid             Suppress Target ID list details from being displayed. Default is FALSE
        neb             Suppress Extra blocks information from being displayed. Default is FALSE

        dt              The custom date/time format to use when displaying time stamps. See https://goo.gl/CNVq0k for options. Default is: yyyy-MM-dd HH:mm:ss
        mp              Display higher precision for time stamps. Default is FALSE

Examples: LECmd.exe -f &#34;C:\Temp\foobar.lnk&#34;
          LECmd.exe -f &#34;C:\Temp\somelink.lnk&#34; --json &#34;D:\jsonOutput&#34; --jsonpretty
          LECmd.exe -d &#34;C:\Temp&#34; --csv &#34;c:\temp&#34; --html c:\temp --xml c:\temp\xml -q
          LECmd.exe -f &#34;C:\Temp\some other link.lnk&#34; --nid --neb
          LECmd.exe -d &#34;C:\Temp&#34; --all

          Short options (single letter) are prefixed with a single dash. Long commands are prefixed with two dashes

Either -f or -d is required. Exiting
</code></pre><p>We can use the following command to parse shortcut files using LECmd.exe:</p>
<p><code>LECmd.exe -f &lt;path-to-shortcut-files&gt; --csv &lt;path-to-save-csv&gt;</code></p>
<p>The creation date of the shortcut file points to the date/time when
the file was first opened. The date/time of modification of the shortcut
file points to the last time the file was accessed.</p>


<h2 class="relative group">IE/Edge history 
    <div id="ieedge-history" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#ieedge-history" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>An interesting thing about the IE/Edge browsing history is that it
includes files opened in the system as well, whether those files were
opened using the browser or not. Hence, a valuable source of information
on opened files in a system is the IE/Edge history. We can access the
history in the following location:</p>
<p><code>C:\Users\&lt;username&gt;\AppData\Local\Microsoft\Windows\WebCache\WebCacheV*.dat</code></p>
<p>The files/folders accessed appear with a <code>file:///*</code> prefix
in the IE/Edge history. Though several tools can be used to analyze Web
cache data, you can use Autopsy to do so in the attached VM. For doing
that, select Logical Files as a data source.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8da15f822b9a82b094d1cd4b80aed83c.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8da15f822b9a82b094d1cd4b80aed83c.png" />
    
  </figure>
</p>
<p>It will then ask you to select the path from which you want files to be analyzed. You can provide the path to the triage folder.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/c5d0b8ea02333e7609edf0a727e037dd.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/c5d0b8ea02333e7609edf0a727e037dd.png" />
    
  </figure>
</p>
<p>In
the Window where Autopsy asks about ingest modules to process data,
check the box in front of &lsquo;Recent Activity&rsquo; and uncheck everything else.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/413c734d28f51bfdba616f9c6c8a9ed8.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/413c734d28f51bfdba616f9c6c8a9ed8.png" />
    
  </figure>
</p>
<p>You will be able to view local files accessed in the Web history option in the left panel.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/2ff14f1bd6b4e92c5e700054e7f68e5c.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/2ff14f1bd6b4e92c5e700054e7f68e5c.png" />
    
  </figure>
</p>
<p>This is what it will look like in the right panel.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/4169c85581f1f227a44c12a5da776617.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/4169c85581f1f227a44c12a5da776617.png" />
    
  </figure>
</p>
<p>As shown above, the &lsquo;Data Artifacts&rsquo; tab displays information about the file accessed.</p>


<h2 class="relative group">Jump Lists 
    <div id="jump-lists" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#jump-lists" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>As we already learned in the last task, Jump Lists create a list of
the last opened files. This information can be used to identify both the
last executed programs and the last opened files in a system.
Remembering from the last task, Jump Lists are present at the following
location:</p>
<p><code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations</code></p>
<p>We
have already learned about parsing Jump lists in the previous task so
we won&rsquo;t go over that again. Let&rsquo;s analyze the triage data available on
the following location in the attached VM to answer the questions:</p>
<p><code>C:\Users\THM-4n6\Desktop\triage\C\</code></p>
<p><strong>External Devices/USB device forensics</strong></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8fff2de1491706bdf56f9abec132b02b.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8fff2de1491706bdf56f9abec132b02b.png" />
    
  </figure>
</p>
<p>Setupapi dev logs for USB devices</p>
<p>When any new device is attached to a system, information related to the setup of that device is stored in the <code>setupapi.dev.log</code>. This log is present at the following location:</p>
<p><code>C:\Windows\inf\setupapi.dev.log</code></p>
<p>This log contains the device serial number and the first/last times when the device was connected.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/da93720ac86a73115f4eeabd6581a5a7.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/da93720ac86a73115f4eeabd6581a5a7.png" />
    
  </figure>
</p>
<p>Here is what it looks like when opened in Notepad.exe. Notice the first line where we can see the device ID and Serial Number.</p>


<h2 class="relative group">Shortcut files 
    <div id="shortcut-files-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#shortcut-files-1" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>As we learned in the previous task, shortcut files are created
automatically by Windows for files opened locally or remotely. These
shortcut files can sometimes provide us with information about connected
USB devices. It can provide us with information about the volume name,
type, and serial number. Recalling from the previous task, this
information can be found at:</p>
<p><code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\</code></p>
<p><code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Office\Recent\</code></p>


<h3 class="relative group"><strong>LINNUX FORENSIC</strong> 
    <div id="linnux-forensic" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#linnux-forensic" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><strong>os and Account Information</strong></p>


<h2 class="relative group">OS release information 
    <div id="os-release-information" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#os-release-information" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>To find the OS release information, we can use the <code>cat</code> utility to read the file located at <code>/etc/os-release</code>.To know more about the <code>cat</code> utility, you can read its man page.</p>
<p><code>man cat</code></p>
<p>The below terminal shows the OS release information.</p>
<p>OS release</p>
<pre tabindex="0"><code>user@machine$ cat /etc/os-release NAME=&#34;Ubuntu&#34;
VERSION=&#34;20.04.1 LTS (Focal Fossa)&#34;
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME=&#34;Ubuntu 20.04.1 LTS&#34;
VERSION_ID=&#34;20.04&#34;
HOME_URL=&#34;https://www.ubuntu.com/&#34;
SUPPORT_URL=&#34;https://help.ubuntu.com/&#34;
BUG_REPORT_URL=&#34;https://bugs.launchpad.net/ubuntu/&#34;
PRIVACY_POLICY_URL=&#34;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&#34;
VERSION_CODENAME=focal
UBUNTU_CODENAME=focal
</code></pre>

<h2 class="relative group">User accounts 
    <div id="user-accounts" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#user-accounts" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>The <code>/etc/passwd</code> file contains information about the user accounts that exist on a Linux system. We can use the <code>cat</code>
utility to read this file. The output contains 7 colon-separated
fields, describing username, password information, user id (uid), group
id (gid), description, home directory information, and the default shell
that executes when the user logs in. It can be noticed that just like
Windows, the user-created user accounts have uids 1000 or above. You can
use the following command to make it more readable:</p>
<p><code>cat /etc/passwd| column -t -s :</code></p>
<p>User accounts</p>
<pre tabindex="0"><code>user@machine$cat /etc/passwd| column -t -s :root                  x  0      0      root                                /root                    /bin/bash
daemon                x  1      1      daemon                              /usr/sbin                /usr/sbin/nologin
bin                   x  2      2      bin                                 /bin                     /usr/sbin/nologin
sys                   x  3      3      sys                                 /dev                     /usr/sbin/nologin
sync                  x  4      65534  sync                                /bin                     /bin/sync
games                 x  5      60     games                               /usr/games               /usr/sbin/nologin
.
.
.
.
.
ubuntu                x  1000   1000   Ubuntu                              /home/ubuntu             /bin/bash
pulse                 x  123    130    PulseAudio daemon,,,                /var/run/pulse           /usr/sbin/nologin
tryhackme             x  1001   1001   tryhackme,,,                        /home/tryhackme          /bin/bash
</code></pre><p>In the above command, we can see the information for the user ubuntu.
The username is ubuntu, its password information field shows <code>x</code>, which signifies that the password information is stored in the <code>/etc/shadow</code>
file. The uid of the user is 1000. The gid is also 1000. The
description, which often contains the full name or contact information,
mentions the name Ubuntu. The home directory is set to <code>/home/ubuntu</code>, and the default shell is set to <code>/bin/bash</code>. We can see similar information about other users from the file as well.</p>


<h2 class="relative group">Group Information 
    <div id="group-information" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#group-information" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>The <code>/etc/group</code> file contains information about the different user groups present on the host. It can be read using the cat utility.</p>
<p>Group information</p>
<pre tabindex="0"><code>user@machine$ cat /etc/grouproot:x:0:
daemon:x:1:
bin:x:2:
sys:x:3:
adm:x:4:syslog,ubuntu
tty:x:5:syslog
</code></pre><p>We can see that the user <code>ubuntu</code> belongs to the <code>adm</code> group, which has a password stored in the <code>/etc/shadow</code> file, signified by the <code>x</code> character. The gid is 4, and the group contains 2 users, Syslog, and ubuntu.</p>


<h2 class="relative group">Sudoers List 
    <div id="sudoers-list" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#sudoers-list" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>A Linux host allows only those users to elevate privileges to <code>sudo</code>, which are present in the Sudoers list. This list is stored in the file <code>/etc/sudoers</code> and can be read using the <code>cat</code> utility. You will need to elevate privileges to access this file.</p>
<p>Sudoers list</p>
<pre tabindex="0"><code>user@machine$ sudo cat /etc/sudoers#
# This file MUST be edited with the &#39;visudo&#39; command as root.#
# Please consider adding local content in /etc/sudoers.d/ instead of# directly modifying this file.#
# See the man page for details on how to write a sudoers file.#
Defaults	env_reset
Defaults	mail_badpass
Defaults	secure_path=&#34;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin&#34;

# Host alias specification# User alias specification# Cmnd alias specification# User privilege specificationroot	ALL=(ALL:ALL) ALL

# Members of the admin group may gain root privileges%admin ALL=(ALL) ALL# Allow members of group sudo to execute any command%sudo	ALL=(ALL:ALL) ALL# See sudoers(5) for more information on &#34;#include&#34; directives:#includedir /etc/sudoers.d
</code></pre>

<h2 class="relative group">Login information 
    <div id="login-information" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#login-information" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>In the /var/log directory, we can find log files of all kinds including <code>wtmp</code> and <code>btmp</code>. The <code>btmp</code> file saves information about failed logins, while the <code>wtmp</code> keeps historical data of logins. These files are not regular text files that can be read using <code>cat</code>, <code>less</code> or <code>vim</code>; instead, they are binary files, which have to be read using the <code>last</code> utility. You can learn more about the <code>last</code> utility by reading its man page.</p>
<pre tabindex="0"><code>man last
</code></pre><p>The following terminal shows the contents of <code>wtmp</code> being read using the <code>last</code> utility.</p>
<p>Login information</p>
<pre tabindex="0"><code>user@machine$ sudo last -f /var/log/wtmpreboot   system boot  5.4.0-1029-aws   Tue Mar 29 17:28   still running
reboot   system boot  5.4.0-1029-aws   Tue Mar 29 04:46 - 15:52  (11:05)
reboot   system boot  5.4.0-1029-aws   Mon Mar 28 01:35 - 01:51 (1+00:16)

wtmp begins Mon Mar 28 01:35:10 2022
</code></pre>

<h2 class="relative group">Authentication logs 
    <div id="authentication-logs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#authentication-logs" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Every user that authenticates on a Linux host is logged in the auth log. The auth log is a file placed in the location <code>/var/log/auth.log</code>. It can be read using the <code>cat</code> utility, however, given the size of the file, we can use <code>tail</code>, <code>head</code>, <code>more</code> or <code>less</code> utilities to make it easier to read.</p>
<p>Auth logs</p>
<pre tabindex="0"><code>user@machine$ cat /var/log/auth.log |tailMar 29 17:28:48 tryhackme gnome-keyring-daemon[989]: The PKCS#11 component was already initialized
Mar 29 17:28:48 tryhackme gnome-keyring-daemon[989]: The SSH agent was already initialized
Mar 29 17:28:49 tryhackme polkitd(authority=local): Registered Authentication Agent for unix-session:2 (system bus name :1.73 [/usr/lib/x86_64-linux-gnu/polkit-mate/polkit-mate-authentication-agent-1], object path /org/mate/PolicyKit1/AuthenticationAgent, locale en_US.UTF-8)
Mar 29 17:28:58 tryhackme pkexec[1618]: ubuntu: Error executing command as another user: Not authorized [USER=root] [TTY=unknown] [CWD=/home/ubuntu] [COMMAND=/usr/lib/update-notifier/package-system-locked]
Mar 29 17:29:09 tryhackme dbus-daemon[548]: [system] Failed to activate service &#39;org.bluez&#39;: timed out (service_start_timeout=25000ms)
Mar 29 17:30:01 tryhackme CRON[1679]: pam_unix(cron:session): session opened for user root by (uid=0)
Mar 29 17:30:01 tryhackme CRON[1679]: pam_unix(cron:session): session closed for user root
Mar 29 17:49:52 tryhackme sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/cat /etc/sudoers
Mar 29 17:49:52 tryhackme sudo: pam_unix(sudo:session): session opened for user root by (uid=0)
Mar 29 17:49:52 tryhackme sudo: pam_unix(sudo:session): session closed for user root
</code></pre><p>In the above log file, we can see that the user ubuntu elevated privileges on <code>Mar 29 17:49:52</code> using <code>sudo</code> to run the command <code>cat /etc/sudoers</code>.
We can see the subsequent session opened and closed events for the root
user, which were a result of the above-mentioned privilege escalation.</p>
<p><strong>System Configuration</strong></p>
<p>Once we have identified the OS and account information, we can start looking into the system configuration of the host.</p>


<h2 class="relative group">Hostname 
    <div id="hostname" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#hostname" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>The hostname is stored in the <code>/etc/hostname</code> file on a Linux Host. It can be accessed using the <code>cat</code> utility.</p>
<p>Hostname</p>
<pre tabindex="0"><code>user@machine$ cat /etc/hostname tryhackme
</code></pre>

<h2 class="relative group">Timezone 
    <div id="timezone" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#timezone" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Timezone information is a significant piece of information that gives
an indicator of the general location of the device or the time window
it might be used in. Timezone information can be found at the location <code>/etc/timezone</code> and it can be read using the <code>cat</code> utility.</p>
<p>Timezone</p>
<pre tabindex="0"><code>user@machine$ cat /etc/timezoneEtc/UTC
</code></pre>

<h2 class="relative group">Network Configuration 
    <div id="network-configuration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#network-configuration" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>To find information about the network interfaces, we can <code>cat</code> the <code>/etc/network/interfaces</code> file. The output on your machine might be different from the one shown here, depending on your configuration.</p>
<p>Network interfaces</p>
<pre tabindex="0"><code>user@machine$ cat /etc/network/interfaces# This file describes the network interfaces available on your system# and how to activate them. For more information, see interfaces(5).source /etc/network/interfaces.d/*

# The loopback network interfaceauto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp
</code></pre><p>Similarly, to find information about the MAC and IP addresses of the different interfaces, we can use the <code>ip</code> utility. To learn more about the <code>ip</code> utility, we can see its <code>man</code> page.</p>
<p><code>man ip</code></p>
<p>The below terminal shows the usage of the <code>ip</code> utility. Note that this will only be helpful on a live system.</p>
<p>IP information</p>
<pre tabindex="0"><code>user@machine$ ip address show 1: lo:  mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: eth0:  mtu 9001 qdisc mq state UP group default qlen 1000
    link/ether 02:20:61:f1:3c:e9 brd ff:ff:ff:ff:ff:ff
    inet 10.10.95.252/16 brd 10.10.255.255 scope global dynamic eth0
       valid_lft 2522sec preferred_lft 2522sec
    inet6 fe80::20:61ff:fef1:3ce9/64 scope link
       valid_lft forever preferred_lft forever
</code></pre>

<h2 class="relative group">Active network connections 
    <div id="active-network-connections" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#active-network-connections" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>On a live system, knowing the active network connections provides additional context to the investigation. We can use the <code>netstat</code> utility to find active network connections on a Linux host. We can learn more about the <code>netstat</code> utility by reading its <code>man</code> page.</p>
<p><code>man netstat</code></p>
<p>The below terminal shows the usage of the <code>netstat</code> utility.</p>
<p>Active network connections</p>
<pre tabindex="0"><code>user@machine$ netstat -natp(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.0.1:5901          0.0.0.0:*               LISTEN      829/Xtigervnc
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      -
tcp        0      0 127.0.0.1:60602         127.0.0.1:5901          ESTABLISHED -
tcp        0      0 10.10.95.252:57432      18.66.171.77:443        ESTABLISHED -
tcp        0      0 10.10.95.252:80         10.100.1.33:51934       ESTABLISHED -
tcp        0      0 127.0.0.1:5901          127.0.0.1:60602         ESTABLISHED 829/Xtigervnc
tcp6       0      0 ::1:5901                :::*                    LISTEN      829/Xtigervnc
tcp6       0      0 :::22                   :::*                    LISTEN      -
tcp6       0      0 ::1:631                 :::*                    LISTEN      -
</code></pre>

<h2 class="relative group">Running processes 
    <div id="running-processes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#running-processes" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>If performing forensics on a live system, it is helpful to check the running processes. The <code>ps</code> utility shows details about the running processes. To find out about the <code>ps</code> utility, we can use the <code>man</code> page.</p>
<p><code>man ps</code></p>
<p>The below terminal shows the usage of the <code>ps</code> utility.</p>
<p>Running processes</p>
<pre tabindex="0"><code>user@machine$ ps auxUSER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMANDroot         729  0.0  0.0   7352  2212 ttyS0    Ss+  17:28   0:00 /sbin/agetty -o -p -- \u --keep-baud 115200,38400,9600 ttyS0 vt220
root         738  0.0  0.0   5828  1844 tty1     Ss+  17:28   0:00 /sbin/agetty -o -p -- \u --noclear tty1 linux
root         755  0.0  1.5 272084 63736 tty7     Ssl+ 17:28   0:00 /usr/lib/xorg/Xorg -core :0 -seat seat0 -auth /var/run/lightdm/root/:0 -nolisten tcp vt7 -novtswitch
ubuntu      1672  0.0  0.1   5264  4588 pts/0    Ss   17:29   0:00 bash
ubuntu      1985  0.0  0.0   5892  2872 pts/0    R+   17:40   0:00 ps au
</code></pre>

<h2 class="relative group">DNS information 
    <div id="dns-information" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#dns-information" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>The file <code>/etc/hosts</code> contains the configuration for the DNS name assignment. We can use the <code>cat</code> utility to read the hosts file. To learn more about the hosts file, we can use the <code>man</code> page.</p>
<p><code>man hosts</code></p>
<p>The below terminal shows a sample output of the hosts file.</p>
<p>hosts file</p>
<pre tabindex="0"><code>user@machine$ cat /etc/hosts127.0.0.1 localhost

# The following lines are desirable for IPv6 capable hosts::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts
</code></pre><p>The information about DNS servers that a Linux host talks to for DNS
resolution is stored in the resolv.conf file. Its location is <code>/etc/resolv.conf</code>. We can use the <code>cat</code> utility to read this file.</p>
<p>Resolv.conf</p>
<pre tabindex="0"><code>user@machine$ cat /etc/resolv.conf # This file is managed by man:systemd-resolved(8). Do not edit.#
# This is a dynamic resolv.conf file for connecting local clients to the# internal DNS stub resolver of systemd-resolved. This file lists all# configured search domains.#
# Run &#34;resolvectl status&#34; to see details about the uplink DNS servers# currently in use.#
# Third party programs must not access this file directly, but only through the# symlink at /etc/resolv.conf. To manage man:resolv.conf(5) in a different way,# replace this symlink by a static file or a different symlink.#
# See man:systemd-resolved.service(8) for details about the supported modes of# operation for /etc/resolv.conf.nameserver 127.0.0.53
options edns0 trust-ad
search eu-west-1.compute.internal
</code></pre><p><strong>Persistence mechanisms</strong></p>
<p>Knowing the environment
we are investigating, we can then move on to finding out what
persistence mechanisms exist on the Linux host under investigation.
Persistence mechanisms are ways a program can survive after a system
reboot. This helps malware authors retain their access to a system even
if the system is rebooted. Let&rsquo;s see how we can identify persistence
mechanisms in a Linux host.</p>


<h2 class="relative group">Cron jobs 
    <div id="cron-jobs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#cron-jobs" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Cron jobs are commands that run periodically after a set amount of
time. A Linux host maintains a list of Cron jobs in a file located at <code>/etc/crontab</code>. We can read the file using the <code>cat</code> utility.</p>
<p>Cron jobs</p>
<pre tabindex="0"><code>user@machine$ cat /etc/crontab # /etc/crontab: system-wide crontab# Unlike any other crontab you don&#39;t have to run the `crontab&#39;# command to install the new version when you edit this file# and files in /etc/cron.d. These files also have username fields,# that none of the other crontabs do.SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# Example of job definition:# .---------------- minute (0 - 59)# |  .------------- hour (0 - 23)# |  |  .---------- day of month (1 - 31)# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat# |  |  |  |  |# *  *  *  *  * user-name command to be executed17 *	* * *	root    cd / &amp;&amp; run-parts --report /etc/cron.hourly
25 6	* * *	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )
47 6	* * 7	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )
52 6	1 * *	root	test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )
#
</code></pre><p>The above terminal output shows the contents of a sample <code>/etc/crontab</code>
file. As can be seen, the file contains information about the time
interval after which the command has to run, the username that runs the
command, and the command itself. It can also contain scripts to run,
where the script that needs to be run will be placed on the disk, and
the command to run it will be added to this file.</p>


<h2 class="relative group">Service startup 
    <div id="service-startup" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#service-startup" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Like Windows, services can be set up in Linux that will start and run
in the background after every system boot. A list of services can be
found in the <code>/etc/init.d</code> directory. We can check the contents of the directory by using the <code>ls</code> utility.</p>
<p>Service startup</p>
<pre tabindex="0"><code>user@machine$ ls /etc/init.d/acpid       avahi-daemon      cups          hibagent           kmod             networking     pppd-dns                     screen-cleanup     unattended-upgrades
alsa-utils  bluetooth         cups-browsed  hwclock.sh         lightdm          open-iscsi     procps                       speech-dispatcher  uuidd
anacron     console-setup.sh  dbus          irqbalance         lvm2             open-vm-tools  pulseaudio-enable-autospawn  spice-vdagent      whoopsie
apparmor    cron              gdm3          iscsid             lvm2-lvmpolld    openvpn        rsync                        ssh                x11-common
apport      cryptdisks        grub-common   kerneloops         multipath-tools  plymouth       rsyslog                      udev
atd         cryptdisks-early  hddtemp       keyboard-setup.sh  network-manager  plymouth-log   saned                        ufw
</code></pre>

<h2 class="relative group">.Bashrc 
    <div id="bashrc" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#bashrc" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>When a bash shell is spawned, it runs the commands stored in the <code>.bashrc</code>
file. This file can be considered as a startup list of actions to be
performed. Hence it can prove to be a good place to look for
persistence.</p>
<p>The following terminal shows an example .bashrc file.</p>
<p>Bashrc</p>
<pre tabindex="0"><code>user@machine$ cat ~/.bashrc# ~/.bashrc: executed by bash(1) for non-login shells.# see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)# for examples# If not running interactively, don&#39;t do anything
case $- in
    *i*) ;;
      *) return;;
esac

# set variable identifying the chroot you work in (used in the prompt below)
if [ -z &#34;${debian_chroot:-}&#34; ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi

# set a fancy prompt (non-color, unless we know we &#34;want&#34; color)
case &#34;$TERM&#34; in
    xterm-color|*-256color) color_prompt=yes;;
esac

# If this is an xterm set the title to user@host:dir
case &#34;$TERM&#34; in
xterm*|rxvt*)
    PS1=&#34;\[\e]0;${debian_chroot:+($debian_chroot)}\u@\h: \w\a\]$PS1&#34;
    ;;
*)
    ;;
esac

# Add an &#34;alert&#34; alias for long running commands.  Use like so:
#   sleep 10; alert
alias alert=&#39;notify-send --urgency=low -i &#34;$([ $? = 0 ] &amp;&amp; echo terminal || echo error)&#34; &#34;$(history|tail -n1|sed -e &#39;\&#39;&#39;s/^\s*[0-9]\+\s*//;s/[;&amp;|]\s*alert$//&#39;\&#39;&#39;)&#34;&#39;

# Alias definitions.
# You may want to put all your additions into a separate file like
# ~/.bash_aliases, instead of adding them here directly.
# See /usr/share/doc/bash-doc/examples in the bash-doc package.

if [ -f ~/.bash_aliases ]; then
    . ~/.bash_aliases
fi

# enable programmable completion features (you don&#39;t need to enable# this, if it&#39;s already enabled in /etc/bash.bashrc and /etc/profile
# sources /etc/bash.bashrc).if ! shopt -oq posix; then
  if [ -f /usr/share/bash-completion/bash_completion ]; then
    . /usr/share/bash-completion/bash_completion
  elif [ -f /etc/bash_completion ]; then
    . /etc/bash_completion
  fi
fi
</code></pre><p>System-wide settings are stored in <code>/etc/bash.bashrc</code> and <code>/etc/profile</code> files, so it is often a good idea to take a look at these files as well.</p>
<p><strong>Evidence of Execution</strong></p>
<p>Knowing what programs
have been executed on a host is one of the main purposes of performing
forensic analysis. On a Linux host, we can find the evidence of
execution from the following sources.</p>


<h2 class="relative group">Sudo execution history 
    <div id="sudo-execution-history" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#sudo-execution-history" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>All the commands that are run on a Linux host using <code>sudo</code> are stored in the auth log. We already learned about the auth log in Task 3. We can use the <code>grep</code> utility to filter out only the required information from the auth log.</p>
<p>Auth logs</p>
<pre tabindex="0"><code>user@machine$ cat /var/log/auth.log* |grep -i COMMAND|tailMar 29 17:28:58 tryhackme pkexec[1618]: ubuntu: Error executing command as another user: Not authorized [USER=root] [TTY=unknown] [CWD=/home/ubuntu] [COMMAND=/usr/lib/update-notifier/package-system-locked]
Mar 29 17:49:52 tryhackme sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/cat /etc/sudoers
Mar 29 17:55:22 tryhackme sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/cat /var/log/btmp
Mar 29 17:55:39 tryhackme sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/cat /var/log/wtmp
Mar 29 18:00:54 tryhackme sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/tail -f /var/log/btmp
Mar 29 18:01:24 tryhackme sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/last -f /var/log/btmp
Mar 29 18:03:58 tryhackme sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/last -f /var/log/wtmp
Mar 29 18:05:41 tryhackme sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/last -f /var/log/btmp
Mar 29 18:07:51 tryhackme sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/last -f /var/log/utmp
Mar 29 18:08:13 tryhackme sudo:   ubuntu : TTY=pts/0 ; PWD=/home/ubuntu ; USER=root ; COMMAND=/usr/bin/last -f /var/run/utmp
</code></pre><p>The above terminal shows commands run by the user ubuntu using <code>sudo</code>.</p>


<h2 class="relative group">Bash history 
    <div id="bash-history" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#bash-history" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Any commands other than the ones run using <code>sudo</code> are
stored in the bash history. Every user&rsquo;s bash history is stored
separately in that user&rsquo;s home folder. Therefore, when examining bash
history, we need to get the bash_history file from each user&rsquo;s home
directory. It is important to examine the bash history from the root
user as well, to make note of all the commands run using the root user
as well.</p>
<p>Bash history</p>
<pre tabindex="0"><code>user@machine$ cat ~/.bash_history cd Downloads/
ls
unzip PracticalMalwareAnalysis-Labs-master.zip
cd PracticalMalwareAnalysis-Labs-master/
ls
cd ..
ls
rm -rf sality/
ls
mkdir wannacry
mv Ransomware.WannaCry.zip wannacry/
cd wannacry/
unzip Ransomware.WannaCry.zip
cd ..
rm -rf wannacry/
ls
mkdir exmatter
mv 325ecd90ce19dd8d184ffe7dfb01b0dd02a77e9eabcb587f3738bcfbd3f832a1.7z exmatter/
cd exmatter/
strings -d 325ecd90ce19dd8d184ffe7dfb01b0dd02a77e9eabcb587f3738bcfbd3f832a1|sort|uniq&gt;str-sorted
cd ..
ls
</code></pre>

<h2 class="relative group">Files accessed using vim 
    <div id="files-accessed-using-vim" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#files-accessed-using-vim" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>The <code>Vim</code> text editor stores logs for opened files in <code>Vim</code> in the file named <code>.viminfo</code>
in the home directory. This file contains command line history, search
string history, etc. for the opened files. We can use the <code>cat</code> utility to open <code>.viminfo</code>.</p>
<p>Viminfo</p>
<pre tabindex="0"><code>user@machine$ cat ~/.viminfo# This viminfo file was generated by Vim 8.1.# You may edit it if you&#39;re careful!

# Viminfo version
|1,4

# Value of &#39;encoding&#39; when this file was written
*encoding=utf-8

# hlsearch on (H) or off (h):
~h
# Command Line History (newest to oldest):
:q
|2,0,1636562413,,&#34;q&#34;

# Search String History (newest to oldest):

# Expression History (newest to oldest):

# Input Line History (newest to oldest):

# Debug Line History (newest to oldest):

# Registers:

# File marks:
&#39;0  1139  0  ~/Downloads/str|4,48,1139,0,1636562413,&#34;~/Downloads/str&#34;

# Jumplist (newest first):-&#39;  1139  0  ~/Downloads/str
|4,39,1139,0,1636562413,&#34;~/Downloads/str&#34;
-&#39;  1  0  ~/Downloads/str
|4,39,1,0,1636562322,&#34;~/Downloads/str&#34;

# History of marks within files (newest to oldest):&gt; ~/Downloads/str
	*	1636562410	0
	&#34;	1139	0
</code></pre><p><strong>Log files</strong></p>
<p>One of the most
important sources of information on the activity on a Linux host is the
log files. These log files maintain a history of activity performed on
the host and the amount of logging depends on the logging level defined
on the system. Let&rsquo;s take a look at some of the important log sources.
Logs are generally found in the <code>/var/log</code> directory.</p>


<h2 class="relative group">Syslog 
    <div id="syslog" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#syslog" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>The Syslog contains messages that are recorded by the host about
system activity. The detail which is recorded in these messages is
configurable through the logging level. We can use the <code>cat</code> utility to view the Syslog, which can be found in the file <code>/var/log/syslog</code>. Since the Syslog is a huge file, it is easier to use <code>tail</code>, <code>head</code>, <code>more</code> or <code>less</code> utilities to help make it more readable.</p>
<p>Syslog</p>
<pre tabindex="0"><code>user@machine$ cat /var/log/syslog* | headMar 29 00:00:37 tryhackme systemd-resolved[519]: Server returned error NXDOMAIN, mitigating potential DNS violation DVE-2018-0001, retrying transaction with reduced feature level UDP.
Mar 29 00:00:37 tryhackme rsyslogd: [origin software=&#34;rsyslogd&#34; swVersion=&#34;8.2001.0&#34; x-pid=&#34;635&#34; x-info=&#34;https://www.rsyslog.com&#34;] rsyslogd was HUPed
Mar 29 00:00:37 tryhackme systemd[1]: man-db.service: Succeeded.
Mar 29 00:00:37 tryhackme systemd[1]: Finished Daily man-db regeneration.
Mar 29 00:09:01 tryhackme CRON[7713]: (root) CMD (   test -x /etc/cron.daily/popularity-contest &amp;&amp; /etc/cron.daily/popularity-contest --crond)
Mar 29 00:17:01 tryhackme CRON[7726]: (root) CMD (   cd / &amp;&amp; run-parts --report /etc/cron.hourly)
Mar 29 00:30:45 tryhackme snapd[2930]: storehelpers.go:721: cannot refresh: snap has no updates available: &#34;amazon-ssm-agent&#34;, &#34;core&#34;, &#34;core18&#34;, &#34;core20&#34;, &#34;lxd&#34;
Mar 29 00:30:45 tryhackme snapd[2930]: autorefresh.go:536: auto-refresh: all snaps are up-to-date
Mar 29 01:17:01 tryhackme CRON[7817]: (root) CMD (   cd / &amp;&amp; run-parts --report /etc/cron.hourly)
Mar 29 01:50:37 tryhackme systemd[1]: Starting Cleanup of Temporary Directories...
</code></pre><p>The above terminal shows the system time, system name, the process
that sent the log [the process id], and the details of the log. We can
see a couple of cron jobs being run here in the logs above, apart from
some other activity. We can see an asterisk(<em>) after the syslog. This is
to include rotated logs as well. With the passage of time, the Linux
machine rotates older logs into files such as syslog.1, syslog.2 etc, so
that the syslog file doesn&rsquo;t become too big. In order to search through
all of the syslogs, we use the asterisk(</em>) wildcard.</p>


<h2 class="relative group">Auth logs 
    <div id="auth-logs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#auth-logs" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>We have already discussed the auth logs in the previous tasks. The
auth logs contain information about users and authentication-related
logs. The below terminal shows a sample of the auth logs.</p>
<p>Auth logs</p>
<pre tabindex="0"><code>user@machine$ cat /var/log/auth.log* |headFeb 27 13:52:33 ip-10-10-238-44 useradd[392]: new group: name=ubuntu, GID=1000
Feb 27 13:52:33 ip-10-10-238-44 useradd[392]: new user: name=ubuntu, UID=1000, GID=1000, home=/home/ubuntu, shell=/bin/bash, from=none
Feb 27 13:52:33 ip-10-10-238-44 useradd[392]: add &#39;ubuntu&#39; to group &#39;adm&#39;
Feb 27 13:52:33 ip-10-10-238-44 useradd[392]: add &#39;ubuntu&#39; to group &#39;dialout&#39;
Feb 27 13:52:33 ip-10-10-238-44 useradd[392]: add &#39;ubuntu&#39; to group &#39;cdrom&#39;
Feb 27 13:52:33 ip-10-10-238-44 useradd[392]: add &#39;ubuntu&#39; to group &#39;floppy&#39;
Feb 27 13:52:33 ip-10-10-238-44 useradd[392]: add &#39;ubuntu&#39; to group &#39;sudo&#39;
Feb 27 13:52:33 ip-10-10-238-44 useradd[392]: add &#39;ubuntu&#39; to group &#39;audio&#39;
Feb 27 13:52:33 ip-10-10-238-44 useradd[392]: add &#39;ubuntu&#39; to group &#39;dip&#39;
Feb 27 13:52:33 ip-10-10-238-44 useradd[392]: add &#39;ubuntu&#39; to group &#39;video&#39;
</code></pre><p>We can see above that the log stored information about the creation
of a new group, a new user, and the addition of the user into different
groups.</p>


<h3 class="relative group">Third-party logs 
    <div id="third-party-logs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#third-party-logs" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Similar to the syslog and authentication logs, the <code>/var/log/</code>
directory contains logs for third-party applications such as webserver,
database, or file share server logs. We can investigate these by
looking at the <code>/var/log/</code> directory.</p>
<p>Third-party logs</p>
<pre tabindex="0"><code>user@machine$ ls /var/logXorg.0.log          apt                    cloud-init.log  dmesg.2.gz      gdm3                    kern.log.1         prime-supported.log  syslog.2.gz
Xorg.0.log.old      auth.log               cups            dmesg.3.gz      gpu-manager-switch.log  landscape          private              syslog.3.gz
alternatives.log    auth.log.1             dist-upgrade    dmesg.4.gz      gpu-manager.log         lastlog            samba                syslog.4.gz
alternatives.log.1  btmp                   dmesg           dpkg.log        hp                      lightdm            speech-dispatcher    syslog.5.gz
amazon              btmp.1                 dmesg.0         dpkg.log.1      journal                 openvpn            syslog               unattended-upgrades
apache2             cloud-init-output.log  dmesg.1.gz      fontconfig.log  kern.log                prime-offload.log  syslog.1             wtmp
</code></pre><p>As is obvious, we can find the apache logs in the apache2 directory and samba logs in the samba directory.</p>
<p>Apache logs</p>
<pre tabindex="0"><code>user@machine$  ls /var/log/apache2/access.log  error.log  other_vhosts_access.log
</code></pre><p>Similarly, if any database server like MySQL is installed on the system, we can find the logs in this directory.</p>


<h3 class="relative group"><strong>AUTOPSY</strong> 
    <div id="autopsy-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#autopsy-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><a href="https://www.autopsy.com/" target="_blank"><strong>The official description</strong></a>: &ldquo;<em>Autopsy is the premier open source forensics platform which is fast,
easy-to-use, and capable of analysing all types of mobile devices and
digital media. Its plug-in architecture enables extensibility from
community-developed or custom-built modules. Autopsy evolves to meet the
needs of hundreds of thousands of professionals in law enforcement,
national security, litigation support, and corporate investigation.</em>&rdquo;</p>
<p><strong>Workflow Overview and Case Analysis</strong></p>
<p><strong>Workflow Overview</strong></p>
<p>Before
diving into Autopsy and analysing data, there are a few steps to
perform; such as identifying the data source and what Autopsy actions to
perform with the data source.</p>
<p>Basic workflow:</p>
<ol>
<li>Create/open the case for the data source you will investigate</li>
<li>Select the data source you wish to analyse</li>
<li>Configure the ingest modules to extract specific artefacts from the data source</li>
<li>Review the artefacts extracted by the ingest modules</li>
<li>Create the report</li>
</ol>


<h1 class="relative group"><strong>Case Analysis | Create a New Case</strong> 
    <div id="case-analysis--create-a-new-case" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#case-analysis--create-a-new-case" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>To prepare a new case investigation, you need to create a case file from the data source. When you start Autopsy, there will be three options. You can create a new case file using the <strong>&ldquo;New Case&rdquo;</strong> option. Once you click on the &ldquo;New Case&rdquo; option, the <strong>Case Information</strong> menu opens**,** where information about the case is populated.</p>
<ul>
<li><strong>Case Name</strong>: The name you wish to give to the case</li>
<li><strong>Base Directory</strong>: The root directory that will store all the files specific to the case (the full path will be displayed)</li>
<li><strong>Case Type</strong>: Specify whether this case will be local (<strong>Single-user</strong>) or hosted on a server where multiple analysts can review (<strong>Multi-user</strong>)</li>
</ul>
<p><strong>Note</strong>: In this room, the focus is on <strong>Single-User</strong>. Also, the room doesn&rsquo;t simulate a new case creation, and the given VM has a sample case file to practice covered Autopsy features.</p>
<p>The following screen is titled &ldquo;<strong>Optional Information&rdquo;</strong> and
can be left blank for our purposes. In an actual forensic environment,
you should fill out this information. Once you click on &ldquo;Finish&rdquo;,
Autopsy will create a new case file from the given data source.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/e488c3548327c1bd78aff63060e2d2a9.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/e488c3548327c1bd78aff63060e2d2a9.png" />
    
  </figure>
</p>


<h1 class="relative group"><strong>Case Analysis | Open an Existing Case</strong> 
    <div id="case-analysis--open-an-existing-case" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#case-analysis--open-an-existing-case" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The
Autopsy can also open prebuilt case files. Note that supported data
sources are discussed in the next task. This part aims to show how to
create/open case files with Autopsy.</p>
<p><strong>Note:</strong> Autopsy case files have a &ldquo;.aut&rdquo; file extension.</p>
<p><strong>In this room, you will import a case.</strong> To
open a case, select the &ldquo;Open Case&rdquo; option. Navigate to the case folder
(located on the desktop) and select the .aut file you wish to open.
Next, Autopsy will process the case files and open the case. You can
identify the name of the case at the top left corner of the Autopsy
window. In the image below, the name of this case is <strong>&ldquo;Sample Case&rdquo;</strong>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/e54b49da6843e66582b797a8a3553723.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/e54b49da6843e66582b797a8a3553723.png" />
    
  </figure>
</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-casename2.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-casename2.png" />
    
  </figure>
</p>
<p><strong>Note</strong>: A warning box will appear if Autopsy cannot locate the disk image. At this point, you can point to the location of the disk image it&rsquo;s attempting to find, or you can click <strong>NO</strong>; you can still analyse the data from the Autopsy case.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-missing-image3.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-missing-image3.png" />
    
  </figure>
</p>
<p>Once the case you wish to analyse is open, you are ready to start exploring the data.</p>
<p><strong>Data Sources</strong></p>
<p>Autopsy
can analyse multiple disk image formats. Before diving into the data
analysis step, let&rsquo;s briefly cover the different data sources Autopsy
can analyse. You can add data sources by using the <strong>&ldquo;Add Data Source&rdquo;</strong> button. Available options are shown in the picture below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/c75224413dfb9884adbdc8c5a778383d.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/c75224413dfb9884adbdc8c5a778383d.png" />
    
  </figure>
</p>
<p><strong>We will focus primarily on the Disk Image or VM File option in this room.</strong></p>
<p>Supported Disk Image Formats:</p>
<ul>
<li><strong>Raw Single</strong> (For example: *.img, *.dd, *.raw, *.bin)</li>
<li><strong>Raw Split</strong> (For example: *.001, *.002, *.aa, *.ab, etc)</li>
<li><strong>EnCase</strong> (For example: *.e01, *.e02, etc)</li>
<li><strong>Virtual Machines</strong> (For example: *.vmdk, *.vhd)</li>
</ul>
<p>If
there are multiple image files (e.i. E01, E02, E03, etc.) Autopsy only
needs you to point to the first image file, and Autopsy will handle the
rest.</p>
<p><strong>Note</strong>: Refer to the Autopsy <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/ds_page.html" target="_blank">documentation</a> to understand the other data sources that can be added to a case.</p>
<p><strong>Ingest Modules</strong></p>
<p>Essentially <strong>Ingest Modules</strong>
are Autopsy plug-ins. Each Ingest Module is designed to analyse and
retrieve specific data from the drive. You can configure Autopsy to run
specific modules during the source-adding stage or later by choosing the
target data source available on the dashboard. By default, the Ingest Modules are configured to run on All Files, Directories, and Unallocated Space.
You can change this setting during the module selecting step. You can
track the process with the bar appearing in the lower right corner.</p>
<p>The
below screenshots simulate mentioned two different approaches to using
ingest modules. Note that using ingest modules requires time to
implement. Therefore we will not cover ingest modules in this room.</p>
<p>Note: Autopsy adds metadata about files to the local database, not the actual file contents.</p>
<p><strong>Configuring ingest modules while adding data sources:</strong></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-configure-modules.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-configure-modules.png" />
    
  </figure>
</p>
<p><strong>Using ingest modules after adding data sources:</strong></p>
<ol>
<li>Open the &ldquo;Run Ingest Modules&rdquo; menu by right-clicking on the data source.</li>
<li>Choose the modules to implement and click on the finish button.</li>
<li>Track the progress of implementation.</li>
</ol>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/04138be7675286ea5f9066a893c0b199.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/04138be7675286ea5f9066a893c0b199.png" />
    
  </figure>
</p>
<p>The
results of any Ingest Module you select to run against a data source
will populate the Results node in the Tree view, which is the left pane
of the Autopsy user interface. Below is an example of using the <strong>&ldquo;Interesting Files Identifier&rdquo;</strong> ingest
module. Note that the results depend on the dataset. If you choose a
module to retrieve specific data that is unavailable in the drive, there
will be no results.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/9ee9f606ea3444fd04c45b15c2c7f819.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/9ee9f606ea3444fd04c45b15c2c7f819.png" />
    
  </figure>
</p>
<p>Drawing the attention back to the Configure Ingest Modules window, notice that some Ingest Modules have per-run settings and some do not. For example, the Keyword Search Ingest Module does not have per-run settings. In contrast, the Interesting Files Finder Ingest Module does. The yellow triangle represents the &ldquo;per-run settings option&rdquo;.</p>
<p>As Ingest Modules run, alerts may appear in the <strong>Ingest Inbox</strong>. Below is an example of the Ingest Inbox after a few Ingest Modules have completed running.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/212c83e75693ce2d8f485633a11dd697.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/212c83e75693ce2d8f485633a11dd697.png" />
    
  </figure>
</p>
<p>To learn more about Ingest Modules, read Autopsy documentation <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/ingest_page.html" target="_blank">here</a>.</p>


<h1 class="relative group"><strong>The User Interface I</strong> 
    <div id="the-user-interface-i" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-user-interface-i" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Let&rsquo;s look at the Autopsy user interface, which is comprised of 5 primary areas:</p>
<p><strong>Tree Viewer</strong></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-tree-view.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-tree-view.png" />
    
  </figure>
</p>
<p>The <strong>Tree Viewer</strong> has <strong>five top-level nodes</strong>:</p>
<ul>
<li><strong>Data Sources</strong> all the data will be organised as you would typically see it in a normal Windows File Explorer.</li>
<li><strong>Views</strong> - files will be organised based on file types, MIME types, file size, etc.</li>
<li><strong>Results</strong> - as mentioned earlier, this is where the results from Ingest Modules will appear.</li>
<li><strong>Tags</strong> - will display files and/or results that have been tagged (read more about tagging <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/tagging_page.html" target="_blank">here</a>).</li>
<li><strong>Reports</strong> - will display reports either generated by modules or the analyst (read more about reporting <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/reporting_page.html" target="_blank">here</a>).</li>
</ul>
<p>Refer to the Autopsy documentation on the <strong>Tree Viewer</strong> for more information <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/tree_viewer_page.html" target="_blank">here</a>.</p>


<h1 class="relative group"><strong>Result Viewer</strong> 
    <div id="result-viewer" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#result-viewer" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p><strong>Note</strong>: Don&rsquo;t confuse the Results node (from the Tree Viewer) with the Result Viewer.</p>
<p>When ****a
volume, file, folder, etc., is selected from the Tree Viewer,
additional information about the selected item is displayed in the
Result Viewer. For example, the Sample case&rsquo;s data source is selected, and now additional information is visible in the Results Viewer.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-table-view.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-table-view.png" />
    
  </figure>
</p>
<p>If
a volume is selected, the Result Viewer&rsquo;s information will change to
reflect the information in the local database for the selected volume.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-table-view2.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-table-view2.png" />
    
  </figure>
</p>
<p>Notice that the Result Viewer pane has three tabs: <strong>Table</strong>, <strong>Thumbnail</strong>, and <strong>Summary</strong>. The above screenshots reflect the information displayed in the Table tab. The Thumbnail tab works best with image or video files. If the view of the above data is changed from Table to Thumbnail, not much information will be displayed. See below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-thumbnail-view.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-thumbnail-view.png" />
    
  </figure>
</p>
<p>Volume nodes can be expanded, and an analyst can navigate the volume&rsquo;s contents like a typical Windows system.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-volume.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-volume.png" />
    
  </figure>
</p>
<p>In the <strong>Views</strong> tree node, files are categorised by File Types - <strong>By Extension, By</strong> <strong>MIME Type</strong>, <strong>Deleted Files</strong>, and <strong>By</strong> <strong>File Size</strong>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-views.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-views.png" />
    
  </figure>
</p>
<p><strong>Tip</strong>: When it comes to <strong>File Types</strong>,
pay attention to this section. An adversary can rename a file with a
misleading file extension. So the file will be &lsquo;miscategorised&rsquo; <strong>By</strong> <strong>Extension</strong> but will be categorised appropriately by <strong>MIME Type</strong>. Expand <strong>By Extension</strong> and more children nodes appear, categorising files even further (see below).</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-byextension.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-byextension.png" />
    
  </figure>
</p>
<p>Refer to the Autopsy documentation on the <strong>Result Viewer</strong> for more information <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/result_viewer_page.html" target="_blank">here</a>.</p>


<h1 class="relative group"><strong>Contents Viewer</strong> 
    <div id="contents-viewer" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#contents-viewer" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>From
the Table tab in the Result Viewer, if you click any folder/file,
additional information is displayed in the Contents Viewer pane.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-contents-view.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-contents-view.png" />
    
  </figure>
</p>
<p>In the given image, three columns might not be quickly understood what they represent.</p>
<ul>
<li><strong>S</strong> = <strong>Score</strong></li>
</ul>
<p>The <strong>Score</strong>
will show a red exclamation point for a folder/file marked/tagged as
notable and a yellow triangle pointing downward for a folder/file
marked/tagged as suspicious. These items can be marked/tagged by an
Ingest Module or the analyst.</p>
<ul>
<li><strong>C</strong> = <strong>Comment</strong></li>
</ul>
<p>If a yellow page is visible in the Comment column, it will indicate that there is a comment for the folder/file.</p>
<ul>
<li><strong>O</strong> = <strong>Occurrence</strong></li>
</ul>
<p>In a nutshell, this column will indicate how many times this file/folder has been seen in past cases (this will require the <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/central_repo_page.html" target="_blank">Central Repository</a>)</p>
<p>Refer to the Autopsy documentation on the Contents Viewer for more information <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/content_viewer_page.html" target="_blank">here</a>.</p>
<p><strong>Keyword Search</strong></p>
<p>At the top right, you will find <strong>Keyword Lists</strong> and <strong>Keyword Search</strong>. With <strong>Keyword Search,</strong> an analyst can perform an AD-HOC keyword search.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-keyword-search.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-keyword-search.png" />
    
  </figure>
</p>
<p>In the image above, the analyst searches for the word &lsquo;secret.&rsquo; Below are the search results.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-keyword-search2.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-keyword-search2.png" />
    
  </figure>
</p>
<p>Refer to the Autopsy <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/ad_hoc_keyword_search_page.html" target="_blank">documentation</a> for more information on performing keyword searches with either option.</p>
<p><strong>Status Area</strong></p>
<p>Lastly, the <strong>Status Area</strong> is
at the bottom right. When Ingest Modules run, a progress bar (along
with the percentage completed) will be displayed in this area. More
detailed information regarding the Ingest Modules is provided if you
click on the bar.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-statusbar2.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-statusbar2.png" />
    
  </figure>
</p>
<p>If the <code>X</code> (directly next to the progress bar) is clicked, a prompt will appear confirming if you wish to end/cancel the Ingest Modules.</p>


<h1 class="relative group"><strong>The User Interface II</strong> 
    <div id="the-user-interface-ii" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-user-interface-ii" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Let&rsquo;s
look at where we can find summarised info with ease. Summarised info
can help analysts decide where to focus by evaluating available
artefacts. It is suggested to view the summary of the data sources
before starting an investigation. Therefore you can have a general idea
about the system and artefacts.</p>
<p><strong>Data Sources Summary</strong></p>
<p>The <strong>Data Sources Summary</strong> provides
summarised info in nine different categories. Note that this is an
overview of the total findings. If you want to dive deep into the
findings and look for a specific artefact, you need to analyse each
module separately using the <strong>&ldquo;Result Viewer&rdquo;</strong> shown in the previous task.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/a8ab6999fabaf538c2e9eb3742b0ff29.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/a8ab6999fabaf538c2e9eb3742b0ff29.png" />
    
  </figure>
</p>


<h1 class="relative group">Generate Report 
    <div id="generate-report" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#generate-report" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>You
can create a report of your findings in multiple formats, enabling you
to create data sheets for your investigation case. The report provides
all information listed under the &ldquo;Result Viewer&rdquo; pane. Reports can help
you to re-investigate findings after finishing the live investigation. <strong>However, reports don&rsquo;t have additional search options, so you must manually find artefacts for the event of interest.</strong></p>
<p><strong>Tip:</strong> The
Autopsy tool can be heavy for systems with low resources. Therefore
completing an investigation with Autopsy on low resources can be slow
and painful. Especially browsing long results might end up with a system
freeze. You can avoid that situation by using reports. You can use the
tool for parsing the data and generating the report, then continue to
analyse through the generated report without a need for Autopsy. Note
that it is always easier to conduct and manage an investigation with the
GUI.</p>
<p>You can use the <strong>&ldquo;Generate Report&rdquo;</strong> option to create reports. The steps are shown below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/581fe3b1caa19ed94ad2564e3ecd8003.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/581fe3b1caa19ed94ad2564e3ecd8003.png" />
    
  </figure>
</p>
<p>Once
you choose your report format and scope, Autopsy will generate the
report. You can click on the &ldquo;HTML Report&rdquo; section (shown above) to view
the report on your browser. Reports contain all of the &ldquo;Result Viewer&rdquo;
pane results on the left side.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/68fc3dcf815f47183dd62c35438dc98c.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6131132af49360005df01ae3/room-content/68fc3dcf815f47183dd62c35438dc98c.png" />
    
  </figure>
</p>
<p>**
Visualisation Tools**</p>
<p>You may have noticed that other parts of the user interface weren&rsquo;t discussed as of yet.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-top-bar.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-top-bar.png" />
    
  </figure>
</p>
<p>Please refer to the Autopsy documentation for the following visualisation tool:</p>
<ul>
<li><strong>Images/Videos:</strong> <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/image_gallery_page.html" target="_blank">http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/image_gallery_page.html</a></li>
<li><strong>Communications:</strong> <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/communications_page.html" target="_blank">http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/communications_page.html</a></li>
<li><strong>Timeline:</strong> <a href="http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/timeline_page.html" target="_blank">http://sleuthkit.org/autopsy/docs/user-docs/4.12.0/timeline_page.html</a></li>
</ul>
<p><strong>Note</strong>: Within the attached VM, you will <strong>NOT</strong> be able to practice with some of the visualisation tools, except for <strong>Timeline</strong>. Below is a screenshot of the <strong>Timeline</strong>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline.png" />
    
  </figure>
</p>
<p><strong>The Timeline tool is composed of three areas:</strong></p>
<ol>
<li><strong>Filters:</strong> Narrow the events displayed based on the filter criteria</li>
<li><strong>Events:</strong> The events are displayed here based on the <strong>View Mode</strong></li>
<li><strong>Files/Contents:</strong> Additional information on the event(s) is displayed in this area</li>
</ol>
<p><strong>There are three view modes:</strong></p>
<ol>
<li><strong>Counts:</strong> The number of events is displayed in a bar chart view</li>
<li><strong>Details:</strong> Information on events is displayed, but they are clustered and collapsed, so the UI is not overloaded</li>
<li><strong>List:</strong> The events are displayed in a table view</li>
</ol>
<p>In the above screenshot, the View Mode is <strong>Counts</strong>. Below is a screenshot of the <strong>Details</strong> View Mode.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-details.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-details.png" />
    
  </figure>
</p>
<p>The numbers (seen above) indicate the number of clustered/collapsed events for a specific time frame. For example, for /Windows, there are 130,257 events between 2009-06-10 and 2010-03-18. See the below image.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-clustered.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-clustered.png" />
    
  </figure>
</p>
<p>To expand a cluster, click on the <code>green icon with the plus sign</code>. See the below example.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-cluster-expand.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-cluster-expand.png" />
    
  </figure>
</p>
<p>To collapse the events, click on the <code>red icon with a minus sign</code>. Click <code>the map marker icon with a plus sign</code> if you wish to pin a group of events. This will move (pin) the events to an isolated section of the Events view.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-clustered2.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-clustered2.png" />
    
  </figure>
</p>
<p>To unpin the events, click on the <code>map marker with the minus sign</code>. The last group of icons to cover are the <code>eye</code> icons. If you wish to hide a group of events from the Events view, click on the <code>eye with a minus sign</code>.  In the below screenshot, the clustered events for /Boot were hidden and placed in <code>Hidden Descriptions</code> (in the Filters area).</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-hidden.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-hidden.png" />
    
  </figure>
</p>
<p>If you wish to reverse that action and unhide the events, right-click and select <code>Unhide and remove from list</code>. See the below example.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-unhide.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-unhide.png" />
    
  </figure>
</p>
<p>Last but not least, a screenshot of the <strong>List</strong> View Mode is below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-list.png" alt="https://assets.tryhackme.com/additional/autopsy/autopsy-timeline-list.png" />
    
  </figure>
</p>
<p>This should be enough information to get you started interacting with the Timeline with some level of confidence.</p>


<h3 class="relative group"><strong>REDLINE</strong> 
    <div id="redline-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#redline-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Data Collection</p>
<p>Now that you have the overview for Redline, let&rsquo;s move to the Data Collection stage.</p>
<p>There are three ways or options to collect data using Redline:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/redline101/capture2.png" alt="https://assets.tryhackme.com/additional/redline101/capture2.png" />
    
  </figure>
</p>
<ol>
<li>Standard Collector - this method configures the script to gather a minimum amount of data
for the analysis. This is going to be our preferred method to collect
data in this room. It is also usually the fastest method to collect the
data you need. It takes only a few minutes to complete.</li>
<li>Comprehensive Collector - this method configures the script to gather the most data from your
host for further analysis. This method takes up to an hour or more. You
will choose this method if you prefer the full analysis of the system.</li>
<li>IOC Search Collector (Windows only) - this method collects data that matches with the <a href="https://www.crowdstrike.com/cybersecurity-101/indicators-of-compromise/" target="_blank">Indicators of Compromise (IOCs)</a> that you created with the help of <a href="https://fireeye.market/apps/S7cWpi9W" target="_blank">IOC Editor</a>. You will choose this method if you want to run the data collection
against known IOCs that you have gathered either through threat
intelligence (data feed or narrative report), incident response, or
malware analysis. You imported them into <a href="https://fireeye.market/apps/S7cWpi9W" target="_blank">IOC Editor</a>. We&rsquo;ll look at the IOC Editor a bit further in the next task.</li>
</ol>
<p>Before proceeding, launch Redline. The icon is conveniently on the taskbar.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/021b2784b3b39c0e5817c79815885a15.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/021b2784b3b39c0e5817c79815885a15.png" />
    
  </figure>
</p>
<p>In this task, we will be using the Standard Collector method.</p>
<ul>
<li>From Redline, click on &ldquo;Create a Standard Collector&rdquo;.</li>
<li>You will have an option to choose the target platform. In our case, we will select <strong>Windows</strong>.</li>
</ul>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/redline101/targetos.png" alt="https://assets.tryhackme.com/additional/redline101/targetos.png" />
    
  </figure>
</p>
<ul>
<li>Under the <em>Review Script Configuration,</em> click on “Edit your script”, this is one of the crucial steps since you will be presented with the set of data to choose to collect from the host. There will be five tabs, which include <strong>Memory, Disk, System, Network</strong>, and <strong>Other.</strong></li>
</ul>
<p>Let&rsquo;s dive into some details:</p>
<p>Memory:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/redline101/memoryyy.png" alt="https://assets.tryhackme.com/additional/redline101/memoryyy.png" />
    
  </figure>
</p>
<p>You
can configure the script to collect memory data such as process
listings, drivers enumeration (Windows hosts only), and hook detection (versions before Windows 10).</p>
<p><strong>Note</strong>: For this exercise, uncheck <strong>Hook Detection</strong> and make sure <strong>Aquire Memory Image</strong> is also unchecked.</p>
<p>Be sure to make changes to the settings in each tab as necessary to mirror the settings illustrated in the task content.</p>
<p>Disk:</p>
<p>This is where you can collect the data on Disks partitions and Volumes along with File Enumeration.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/redline101/diskkk.png" alt="https://assets.tryhackme.com/additional/redline101/diskkk.png" />
    
  </figure>
</p>
<p>System:</p>
<p>The system will provide you with machine information:</p>
<ul>
<li>Machine and operating system (OS) information</li>
<li>Analyze system restore points (Windows versions before 10 only)</li>
<li>Enumerate the registry hives (Windows only)</li>
<li>Obtain user accounts (Windows and OS X only)</li>
<li>Obtain groups (OS X only)</li>
<li>Obtain the prefetch cache (Windows only)</li>
</ul>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/redline101/systemm.png" alt="https://assets.tryhackme.com/additional/redline101/systemm.png" />
    
  </figure>
</p>
<p>Network:</p>
<p>Network Options supports Windows, OS
X, and Linux platforms. You can configure the script to collect network
information and browser history, which is essential when investigating
the browser activities, including malicious file downloads and
inbound/outbound connections.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/redline101/networkkk.png" alt="https://assets.tryhackme.com/additional/redline101/networkkk.png" />
    
  </figure>
</p>
<p>Other:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/redline101/other.png" alt="https://assets.tryhackme.com/additional/redline101/other.png" />
    
  </figure>
</p>
<p>With this option, you can collect the data on different services and tasks running on the system, including the hashes.</p>
<ul>
<li>Now we are ready to proceed to the next important step. After choosing your data options - click OK. And then click on*&ldquo;Browse&rdquo;* under <em>&ldquo;Save Your Collector To&rdquo;</em>. Why is this an important step? Because you will need to create a folder where your analysis file will be saved and the script for collecting
the data you need. In our case, we are saving it to the <em>Analysis</em> folder.</li>
</ul>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/redline101/32.png" alt="https://assets.tryhackme.com/additional/redline101/32.png" />
    
  </figure>
</p>
<p><strong>Note</strong>: You can choose any folder you wish but make sure that the folder is EMPTY. Complete this dialog by clicking the OK button.</p>
<ul>
<li>After you choose to save the collector to the folder, you will see the Collector Instructions.</li>
</ul>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/f8ddaa960778e373c108ea2fa3ebe67f.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/f8ddaa960778e373c108ea2fa3ebe67f.png" />
    
  </figure>
</p>
<ul>
<li>If you go into the folder, you will notice the bat file under the name &ldquo;RunRedlineAudit&rdquo;. This is the executable script to collect data from the host. The script needs to be <em>run as Administrator</em> to be able to collect the data we need.</li>
</ul>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/ef6666436c67665ba44f03f149a89320.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/ef6666436c67665ba44f03f149a89320.png" />
    
  </figure>
</p>
<ul>
<li>Running the script will open a command prompt window; this indicates that the
script is running successfully. It will close automatically when the
data collection process finishes.</li>
</ul>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/redline101/1213.png" alt="https://assets.tryhackme.com/additional/redline101/1213.png" />
    
  </figure>
</p>
<p><strong>Note</strong>: This process may take between 15-20 minutes to complete.</p>
<ul>
<li>After the script is finished, you will notice a new file created - AnalysisSession1 (in the <strong>Sessions</strong> folder) with the <em>.mans</em> extension. This file is what we need to be able to import into Redline for
investigation. Just double-click on the file to import the audit data.</li>
</ul>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/93f84b334ff930f8fdbb3bb316d010c3.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/93f84b334ff930f8fdbb3bb316d010c3.png" />
    
  </figure>
</p>
<p><strong>The Redline Interface</strong></p>
<p>Let&rsquo;s look at the Redline Interface.</p>
<p>You should have your first analysis file. Double-click on the <em>AnalysisSession1.mans</em> file and the data will be imported automatically into Redline. Please give it up to 10 minutes to get the data imported.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/CH6zS38/red1.png" alt="https://i.ibb.co/CH6zS38/red1.png" />
    
  </figure>
</p>
<p>When the data is imported, you will be presented with this view:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/8YhfzHb/redlineee.png" alt="https://i.ibb.co/8YhfzHb/redlineee.png" />
    
  </figure>
</p>
<p>On the left panel, you will see different types of <em>Analysis Data;</em> this is where you will perform information gathering and investigation process.</p>
<ul>
<li>System Information: this is where you will see the information about the machine, BIOS (Windows only), operating system, and user information.</li>
<li>Processes: processes will contain different attributes such as Process Name, PID, Path,
Arguments, Parent process, Username, etc. When you expand the Processes
tab, there will be four sections: Handles, Memory Sections, Strings, and Ports.</li>
</ul>
<p>A handle is a
connection from a process to an object or resource in a Windows
operating system. Operating systems use handles for referencing internal
objects like files, registry keys, resources, etc.</p>
<p>Memory Sections will
let you investigate unsigned memory sections used by some processes.
Many processes usually use legitimate dynamic link libraries (DLLs),
which will be signed. This is particularly interesting because if you
see any unsigned DLLs then it will be worth taking a closer look.</p>
<p>Strings - you will see the information on the captured strings.</p>
<p>Ports -
this is one of the critical sections to pay attention to. Most malware
often initiates the outbound or inbound connections to communicate to
their command and control server (C2) to do some malicious activities
like exfiltrating the data or grabbing a payload to the machine. This
situation is where you can review the suspicious connections from ports
and IP addresses. Pay attention to the system processes as well. The
threat actors like to avoid detection by hiding under the system
processes. For example, explorer.exe or notepad.exe shouldn&rsquo;t be on the
list of processes with outbound connections.</p>
<p>Some of the other important sections you need to pay attention to are:</p>
<ul>
<li>File System (<strong>not included in this analysis session</strong>)</li>
<li>Registry</li>
<li>Windows Services</li>
<li>Tasks (Threat actors like to create scheduled tasks for persistence)</li>
<li>Event Logs (this another great place to look for the suspicious Windows
PowerShell events as well as the Logon/Logoff, user creation events, and others)</li>
<li>ARP and Route Entries (<strong>not included in this analysis session</strong>)</li>
<li>Browser URL History (<strong>not included in this analysis session</strong>)</li>
<li>File Download History</li>
</ul>
<p>The <strong>Timeline</strong>
will help you to better understand when the compromise happened and
what steps the malicious actor took to escalate the attack. The <strong>Timeline</strong> will also record every action on the file if it got create, changed, modified, accessed.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/mN1GyRf/files.png" alt="https://i.ibb.co/mN1GyRf/files.png" />
    
  </figure>
</p>
<p>If you know when the host compromise or suspicious activity occurred, you can use TimeWrinkles™ to filter out the timeline to only the events that took place around that time.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/0d3564554dec83b1e948cf2e78a41b26.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/0d3564554dec83b1e948cf2e78a41b26.png" />
    
  </figure>
</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/k4gB91m/wrinklee.png" alt="https://i.ibb.co/k4gB91m/wrinklee.png" />
    
  </figure>
</p>
<p>TimeCrunches™ helps
to reduce the excessive amount of data that is not relevant in the
table view. A TimeCrunch will hide the same types of events that
occurred within the same minute you specified.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/e38cdd16a6b56e484a6d9a4549c7348b.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/e38cdd16a6b56e484a6d9a4549c7348b.png" />
    
  </figure>
</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/RTc3t0z/timeline2.png" alt="https://i.ibb.co/RTc3t0z/timeline2.png" />
    
  </figure>
</p>
<p>You can find out more about each type of data analysis using the Redline User Guide: <a href="https://fireeye.market/assets/apps/211364/documents/877936_en.pdf" target="_blank">https://fireeye.market/assets/apps/211364/documents/877936_en.pdf</a>.</p>
<p><strong>IOC Search Collector</strong></p>
<p>We briefly discussed the usage of the <strong>IOC Search Collector</strong> in the <strong>Data Collection</strong> task.</p>
<p>Let&rsquo;s take a closer look at the capabilities of this collector type. But first, let&rsquo;s recap what an IOC is.</p>
<p>IOC stands for <strong>Indicators of Compromise</strong>;
they are artifacts of the potential compromise and host intrusion on
the system or network that you need to look for when conducting threat
hunting or performing incident response. IOCs can be MD5, SHA1, SHA256 hashes, IP address, C2 domain, file size, filename, file path, a registry key, etc.</p>
<p>One of the great tools you can use is <a href="https://fireeye.market/apps/S7cWpi9W" target="_blank">IOC Editor,</a> created by FireEye, to create IOC files. You can refer to this link to learn how to use the IOC Editor: <a href="https://fireeye.market/assets/apps/S7cWpi9W//9cb9857f/ug-ioc-editor.pdf" target="_blank">https://fireeye.market/assets/apps/S7cWpi9W//9cb9857f/ug-ioc-editor.pdf</a>.</p>
<p><strong>Note</strong>: According to the <a href="https://fireeye.market/apps/S7cWpi9W" target="_blank">IOC Editor</a> download page Windows 7 is the latest operating system officially supported. It is the same version installed in the attached VM. There is another tool called <a href="https://fireeye.market/apps/211404" target="_blank">OpenIOC Editor</a> by FireEye, which supports Windows 10 that is worth taking a look at.</p>
<p><strong>Tip</strong>: Before proceeding you can close Redline to free up some system resources while using IOC Editor.</p>
<p>You can create a text file containing IOCs, modify them, and share it with other people in the InfoSec industry.</p>
<p>In this example, we will look at an IOC of a keylogger created with IOC Editor.</p>
<p><strong>Note</strong>: Below, you may follow along with the screenshots and don&rsquo;t have to create the IOC file in this task. You will create an IOC file using IOC Editor and perform an IOC Search in the next task.</p>
<p>Open IOC Editor which was conveniently placed for you in the taskbar next to Redline.</p>
<p><strong>Note:</strong> It may take ~60 seconds for the application to launch.</p>
<p>Before proceeding,  create the directory which will store the IOC file (IOC Directory).</p>
<p>Next, create the IOC file.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/b26d9e80ac55821643531c3a0436f633.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/b26d9e80ac55821643531c3a0436f633.png" />
    
  </figure>
</p>
<p><strong>Keylogger indicators in IOC Editor</strong>:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/02VS0M6/keylogger2.png" alt="https://i.ibb.co/02VS0M6/keylogger2.png" />
    
  </figure>
</p>
<p>A brief explanation of the above image:</p>
<ul>
<li>The <strong>Name</strong> of the IOC file is Keylogger, Keylogger.ioc. (this field you can edit)</li>
<li>The <strong>Author</strong> is RussianPanda. (this field you can edit)</li>
<li><strong>GUID</strong>, <strong>Created</strong>, and <strong>Modified</strong> are fields you can <strong>NOT</strong> edit, and IOC Editor populates the information.</li>
<li>Under <strong>Description</strong>, you can add a summary explaining the purpose of the IOC file.</li>
</ul>
<p>The actual IOCs will be added under, you guessed it, <strong>Add</strong>.</p>
<p>Here are the values from the image above:</p>
<ul>
<li><strong>File Strings</strong> - <code>psylog.exe</code></li>
<li><strong>File Strings</strong> - <code>RIDEV_INPUTSINK</code></li>
<li><strong>File MD5</strong> - <code>791ca706b285b9ae3192a33128e4ecbb</code></li>
<li><strong>File Size</strong> - <code>35400</code></li>
</ul>
<p>Refer to the gif below to get an idea of adding specific IOCs to the IOC file.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/01db4361981d214c2692aa10d59961d1.gif" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/01db4361981d214c2692aa10d59961d1.gif" />
    
  </figure>
</p>
<p>Once you select an item you can enter the value for the item directly.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/81e9ffdb97a2ce98e8b9cec57a2be261.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/81e9ffdb97a2ce98e8b9cec57a2be261.png" />
    
  </figure>
</p>
<p>You can also add it within the <strong>Properties</strong>.</p>
<p>All the fields are read-only except for <strong>Content</strong> and <strong>Comment</strong>. To add a value to the item enter it under <strong>Content</strong>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/5a0e549950f7ca673699d51a2ff14bc9.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/5a0e549950f7ca673699d51a2ff14bc9.png" />
    
  </figure>
</p>
<p>Once you enter the value click Save to save it.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/9d95abf1f3d62f3fe7d2eb6352b86235.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/9d95abf1f3d62f3fe7d2eb6352b86235.png" />
    
  </figure>
</p>
<p><strong>Note</strong>: You can right-click on an item for additional options. See below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/f5173beaf331e84b7672daf6be726092.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/f5173beaf331e84b7672daf6be726092.png" />
    
  </figure>
</p>
<p>We&rsquo;ll leave that for you to explore on your own.</p>
<p>Now that we&rsquo;ve created and saved the IOC file, let&rsquo;s move on and go back to the <strong>IOC Search Collector</strong> in the <strong>Redline</strong> tool.</p>
<p><strong>Note</strong>: If you closed Redline now is the time to relaunch the application. You can close IOC Editor, again, to free up system resources.</p>
<p><strong>IOC Search Collector</strong></p>
<p>will ignore the data that doesn&rsquo;t match an</p>
<p>IOC</p>
<p>you have gathered. Although, you can always choose to collect
additional data. As the Redline User Guide states, the quality of the
IOC analysis will depend on the data you have available in the analysis
session.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/SwvyRyq/ioc.png" alt="https://i.ibb.co/SwvyRyq/ioc.png" />
    
  </figure>
</p>
<p>To create an IOC
Search Collector, click &ldquo;Browse&hellip;&rdquo; and choose the location of the .ioc
file. Redline will automatically detect the .ioc file and place it in
the Indicators section, as shown below.</p>
<p><strong>IOC Search Collector</strong>:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/2S2t1sB/keylogger.png" alt="https://i.ibb.co/2S2t1sB/keylogger.png" />
    
  </figure>
</p>
<p><strong>Unsupported Search Terms:</strong> These terms will not show any successful hits in Redline, which means Redline doesn&rsquo;t recognize specific search terms.</p>
<p><strong>Supported Search Terms:</strong> The terms that Redline will recognize and search for.</p>
<p>After
you are finished reviewing the configured IOCs, click &ldquo;Next&rdquo;. Now click
on &ldquo;Edit your script&rdquo; to configure what data will be collected for the
analysis. For this example, Keylogger file IOC Search, the following parameters were selected.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/g7JkhPr/keylogger3.png" alt="https://i.ibb.co/g7JkhPr/keylogger3.png" />
    
  </figure>
</p>
<p><strong>Note</strong>: When you configure your own IOC Search, you will choose different settings for your script compared to the settings above.</p>
<p>When done editing the script, click &ldquo;OK&rdquo;.</p>
<p>In
the &ldquo;Save Your Collector To&rdquo; section, click &ldquo;Browse&rdquo; and choose an
empty folder where your analysis file will be saved along with the <strong>RunRedlineAudit.bat</strong> file.</p>
<p>After executing the .bat file in the same manner as before, let&rsquo;s now wait for the analysis to finish.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5c549500924ec576f953d9fc/room-content/014d546f9f31bb0e7458c835ebf17386.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5c549500924ec576f953d9fc/room-content/014d546f9f31bb0e7458c835ebf17386.png" />
    
  </figure>
</p>
<p>After
the analysis is finished, you will see the .mans file (AnalysisSession1
in our example). Double-click the file to open it in Redline.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/xhJwX1f/analysis.png" alt="https://i.ibb.co/xhJwX1f/analysis.png" />
    
  </figure>
</p>
<p>If Redline fails to generate the IOC Report automatically, you can manually generate it by clicking &ldquo;Create a New IOC Report&rdquo; and importing your .ioc file.</p>
<p>When the report generation completes, you should see the &ldquo;Hits&rdquo;. You can expand the list by clicking on the entries in each row.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/bvVVdj5/keyllogger4.png" alt="https://i.ibb.co/bvVVdj5/keyllogger4.png" />
    
  </figure>
</p>
<p>From the screenshot, you can see that there was one hit on &ldquo;chrome.dll&rdquo;, this is a false positive. Let&rsquo;s review the details below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/d0RCvdH/hits2.png" alt="https://i.ibb.co/d0RCvdH/hits2.png" />
    
  </figure>
</p>
<p>As you can see, the DLL
file matched with the string &ldquo;RIDEV_INPUTSINK&rdquo; that we had in our .ioc
file. It&rsquo;s important to gather granulated and accurate artifacts to add
to your IOC file to avoid false positives.</p>
<p>The screenshot below is of a file with the most amount of &ldquo;Hits&rdquo;, which means it is most likely the file we are looking for.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://i.ibb.co/tzvyS6w/hits3.png" alt="https://i.ibb.co/tzvyS6w/hits3.png" />
    
  </figure>
</p>
<ul>
<li>Redline User Guide: <a href="https://fireeye.market/assets/apps/211364/documents/877936_en.pdf" target="_blank">https://fireeye.market/assets/apps/211364/documents/877936_en.pdf</a></li>
<li>IOC Editor User Guide: <a href="https://fireeye.market/assets/apps/S7cWpi9W//9cb9857f/ug-ioc-editor.pdf" target="_blank">https://fireeye.market/assets/apps/S7cWpi9W//9cb9857f/ug-ioc-editor.pdf</a></li>
</ul>


<h3 class="relative group"><strong>KAPE</strong> 
    <div id="kape-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#kape-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Kroll Artifact Parser and Extractor (KAPE) parses and extracts
Windows forensics artifacts. It is a tool that can significantly reduce
the time needed to respond to an incident by providing forensic
artifacts from a live system or a storage device much earlier than the
imaging process completes.</p>
<p>KAPE serves two primary purposes, 1) collect files and 2) process the
collected files as per the provided options. For achieving these
purposes, KAPE uses the concept of targets and modules. Targets can be
defined as the forensic artifacts that need to be collected. Modules are
programs that process the collected artifacts and extract information
from them. We will learn about them in the upcoming tasks.</p>


<h2 class="relative group"><strong>How it works</strong> 
    <div id="how-it-works" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#how-it-works" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>KAPE is extensible and highly configurable. In essence, the KAPE
binary ﻿ collects files and processes them as per the provided
configuration.</p>
<p>The collection of files (targets) KAPE adds the files to a queue and
copies them in two passes. In the first pass, it copies the files that
it can. This works for files that the OS has not locked. The rest of the
files are passed to a secondary queue. The secondary queue is processed
using a different technique that uses raw disk reads to bypass the OS
locks and copy the files. The copied files are saved with original
timestamps and metadata and stored in a similar directory structure.</p>
<p>Once the data is collected, KAPE can process it using modules. The
modules can be independent binaries that run on the collected data and
process them to extract information. For example, KAPE will collect and
copy the Prefetch file to our target destination during the target
collection. Running a Prefetch Parser (PECmd) module on this target will
extract the prefetch file and save it in a CSV file.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/d1489a8062d714fa227dd3382dfd15d1.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/d1489a8062d714fa227dd3382dfd15d1.png" />
    
  </figure>
</p>
<p>As the above image shows, KAPE can extract targets from a Live system, a mounted image, or the <a href="https://www.f-response.com/" target="_blank">F-response</a> utility. KAPE does not need to be installed. It is portable and can be used from network locations or USB drives.</p>
<p><strong>Target Options</strong></p>
<p>In KAPE&rsquo;s lexicon, <code>Targets</code>
are the artifacts that need to be collected from a system or image and
copied to our provided destination. For example, as we learned in the
last room, Windows Prefetch is a forensic artifact for evidence of
execution so that we can create a <code>Target</code> for it. Similarly, we can also create <code>Targets</code> for the registry hives. In short, <code>Targets</code> copy files from one place to another.</p>
<p>When we open the <code>Targets</code> directory of KAPE, this is what we will see:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/3902f2f2088969b01e9672553f48c9e4.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/3902f2f2088969b01e9672553f48c9e4.png" />
    
  </figure>
</p>
<p>The last four files at the bottom are guides and templates to create <code>Targets</code> and <code>Compound Targets</code> of our own. We will discuss <code>Compound Targets</code> later in this task. As you can see, the targets are grouped into different directories. Let&rsquo;s check out the <code>Windows</code> directory to see what we have:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/20d9d19240bcaeb95b55ad2efb105c1c.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/20d9d19240bcaeb95b55ad2efb105c1c.png" />
    
  </figure>
</p>
<p>We can see different .tkape extension files. This is how a <code>Target</code>
is defined for KAPE. A TKAPE file contains information about the
artifact that we want to collect, such as the path, category, and file
masks to collect. As an example, below is how the Prefetch <code>Target</code> is defined.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/92dce7807d9ea37f6f5e1e62f271275b.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/92dce7807d9ea37f6f5e1e62f271275b.png" />
    
  </figure>
</p>
<p>This TKAPE file tells KAPE to collect files with the file mask <code>*.pf</code> from the path <code>C:\Windows\prefetch</code> and <code>C:\Windows.old\prefetch</code>.</p>
<p>Notice that we have the <code>C:\Windows.old</code> path listed here
as well. This path contains files retained after Windows has updated to a
new version. For forensic analysis, we can also find interesting
historical artifacts from this directory.</p>


<h2 class="relative group"><strong>Compound Targets:</strong> 
    <div id="compound-targets" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#compound-targets" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>KAPE also supports <code>Compound Targets</code>. These are <code>Targets</code>
that are compounds of multiple other targets. As mentioned in the
previous tasks, KAPE is often used for quick triage collection and
analysis. The purpose of KAPE will not be fulfilled if we have to
collect each artifact individually. Therefore, <code>Compound Targets</code> help us collect multiple targets by giving a single command. Examples of <code>Compound Targets</code> include <code>!BasicCollection</code>, <code>!SANS_triage</code> and <code>KAPEtriage</code>. We can view the <code>Compound Targets</code> on the path <code>KAPE\Targets\Compound</code>. The following image shows what a <code>Compound Target</code> for evidence of execution looks like:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/76260284a8d68c7d38126a7237e9c16a.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/76260284a8d68c7d38126a7237e9c16a.png" />
    
  </figure>
</p>
<p>The above <code>Compound Target</code> will collect evidence of execution from Prefetch, RecentFileCache, AmCache, and Syscache <code>Targets</code>.</p>


<h2 class="relative group"><strong>!Disabled</strong> 
    <div id="disabled" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#disabled" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>This directory contains <code>Targets</code> that you want to keep in the KAPE instance, but you don&rsquo;t want them to appear in the active Targets list.</p>


<h2 class="relative group"><strong>!Local</strong> 
    <div id="local" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#local" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>If you have created some <code>Targets</code> that you don&rsquo;t want to sync with the KAPE Github repository, you can place them in this directory. These can be <code>Targets</code> that are specific to your environment. Similarly, anything not present in th</p>
<p><strong>Module Options</strong></p>
<p><code>Modules</code>,
in KAPE&rsquo;s lexicon, run specific tools against the provided set of files.
Their goal is not to copy files from one place to another but rather
run some command and store the output. Generally, the output is in the
form of CSV or TXT files.</p>
<p>This is what the <code>Modules</code> directory looks like in KAPE:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/e4dbd842fa5b548ac8fade7b94ab0c8a.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/e4dbd842fa5b548ac8fade7b94ab0c8a.png" />
    
  </figure>
</p>
<p>Similar to the previous task, we see guides and templates for creating <code>Modules</code> and <code>Compound Modules</code>. We also see the <code>!Disabled</code>, <code>!Local</code> and <code>Compound</code>
directories, which are similar to what we saw in the previous task. We
will not discuss these again, as we discussed them in the last task. We
see that most of the <code>Modules</code> are grouped together in different directories. One thing we find different is the <code>bin</code> directory. We will discuss that in a bit. For now, let&rsquo;s open the Windows directory and see what we have there:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9a9760a2f1004e74b23294681f7bfdef.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9a9760a2f1004e74b23294681f7bfdef.png" />
    
  </figure>
</p>
<p>Here we see files with the <code>.mkape</code> extension. These are understood as <code>Modules</code> by KAPE. Let&rsquo;s open an MKAPE file and see how it is structured. The following image shows the Windows_IPConfig MKAPE file.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/15bfb563be1d5bf1e988ab3e7486b58e.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/15bfb563be1d5bf1e988ab3e7486b58e.png" />
    
  </figure>
</p>
<p>Notice
that the MKAPE file tells KAPE about the executable that has to be run,
the command line parameters of the executable file, the output export
format, and the filename to export to. But what if the executable that
we want to run is not present on the system? This brings us to the <code>bin</code> directory.</p>


<h2 class="relative group"><strong>The bin directory:</strong> 
    <div id="the-bin-directory" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-bin-directory" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>The <code>bin</code> directory contains executables that we want to
run on the system but are not natively present on most systems. KAPE
will run executables either from the <code>bin</code> directory or the complete path. An example of files to be kept in the <code>bin</code>
directory are Eric Zimmerman&rsquo;s tools, which are generally not present
on a Windows system. We used them extensively in the Windows Forensics
rooms.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a3547f25552d5d440d4f85022b53bc01.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a3547f25552d5d440d4f85022b53bc01.png" />
    
  </figure>
</p>
<p>Notice that most of the binaries present here are from Eric Zimmerman&rsquo;s Tools.</p>
<p><strong>KAPE GUI</strong></p>
<p>Now that we have learned about the different components of KAPE let&rsquo;s take it for a test drive. In the attached VM, double-click to open the gkape.exe file. You will see the following Window:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/2c483331a6c0218db3bad9d79289447c.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/2c483331a6c0218db3bad9d79289447c.png" />
    
  </figure>
</p>
<p><strong>Tip:</strong> If the Window is not correctly visible in the split-screen, you can open it in a full browser tab by clicking this button:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/af1a133b7384aac273451343dadc032d.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/af1a133b7384aac273451343dadc032d.png" />
    
  </figure>
</p>
<p>Here you can see that there are different options, but most are disabled. To collect <code>Targets</code> We will go ahead by enabling the <code>Use Target Options</code> checkbox. This will enable the options present in the left half of the Window:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/ef839c3076a311b29ac9fedd933d58d8.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/ef839c3076a311b29ac9fedd933d58d8.png" />
    
  </figure>
</p>
<p>If we want to perform forensics on the same machine on which KAPE is running, we will provide <code>C:\</code>
for the Target source. We can select the target destination of our
choice. All the triage files will be copied to the Target destination
that we provide.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f4a865927aef7b0fa4668f13ef8f9cfa.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/f4a865927aef7b0fa4668f13ef8f9cfa.png" />
    
  </figure>
</p>
<p>Here, the <code>Flush</code>
checkbox will delete all the contents of the Target destination, so we
have to be careful when using that. We have disabled the <code>Flush</code> checkbox so that it does not delete data already present in the directories. <code>Add %d</code> will append date info to the directory name where the collected data is saved. Similarly, <code>Add %m</code>
will append machine info to the Target destination directory. We can
select our desired Target from the list shown above. The Search bar
helps us search for the names of the desired Targets quickly.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a513c60028421e8fd103a161e1492e0a.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a513c60028421e8fd103a161e1492e0a.png" />
    
  </figure>
</p>
<p>We can select if we want to process Volume Shadow Copies by enabling <code>Process VSCs</code>. We can select the <code>transfer</code> checkbox if we want to transfer the collected artifacts through an SFTP server or an S3 bucket.
For transfer, the files must be enclosed in a container, which can be
Zip, VHD, or VHDX. Similarly, we can provide exclusions based on SHA-1,
and KAPE will not copy the excluded files. When enclosing in a container, we will need to give a <code>Base name</code>
that will be used for all the created files. It is not required if we
are not transferring files or enclosing them in a container.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/22a7063c7c3bb75bc2ddaede7fcf9f57.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/22a7063c7c3bb75bc2ddaede7fcf9f57.png" />
    
  </figure>
</p>
<p>In the <code>Current command line</code> tab,
we can see the command line options being added or removed while
configuring the UI. This Window will show more options in the command
line as we add options. Please note that the destination path in your
case will be different from the one shown in the image. Notice the <code>--tflush</code> flag here. It means that when this command line was created, the <code>Flush</code> checkbox was still checked.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/fd514feceacfd972097ef26b5ac433ed.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/fd514feceacfd972097ef26b5ac433ed.png" />
    
  </figure>
</p>
<p>By checking the Use Module Options checkbox, the right side of the KAPE Window will also be enabled.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/811ceeea4083ab70546d89f5ecfc2f6f.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/811ceeea4083ab70546d89f5ecfc2f6f.png" />
    
  </figure>
</p>
<p>When
using both Target and Module Options, providing Module Source is not
required. The selected Modules will use the Target destination as the
source.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8807a5d8eaf027af5f6e0a174e8079d3.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/8807a5d8eaf027af5f6e0a174e8079d3.png" />
    
  </figure>
</p>
<p>The rest of the options for Modules are similar to the ones for Targets, so we won&rsquo;t go into details for them.</p>
<p>Below you will see what the configuration looks like when we have KAPE all set up for collecting Targets and processing them using Modules.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/d4e260cbc96fd497859c9133cdb345a8.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/d4e260cbc96fd497859c9133cdb345a8.png" />
    
  </figure>
</p>
<p>We have selected the <code>KapeTriage</code> compound Target and <code>!EZParser</code> Compound Module. The command line below shows the CLI command that will be run. The <code>Execute!</code> button in the bottom right corner will execute the command. The <code>Disable flush warnings</code> checkbox underneath it will not warn us when we are using the <code>Flush</code> flags. When we press <code>Execute!</code> We will see a command line window open and show us the logs as KAPE
performs its tasks. It will take a few minutes to execute since it will
be collecting all the data and then running the module processes on it.
Once it completes, it will show us the total execution time, and we can
press any key to terminate the command window.</p>
<p>D:\Kape\kape.exe</p>
<pre tabindex="0"><code>KAPE version 1.1.0.1 Author: Eric Zimmerman (kape@kroll.com)

KAPE directory: D:\KAPE
Command line: --tsource C: --tdest C:\Users\Umair\Desktop\kape --target KapeTriage --mdest C:\Users\Umair\Desktop\4n6-2 --module !EZParser --gui

System info: Machine name: UMAIR-THINKBOOK, 64-bit: True, User: Umair OS: Windows10 (10.0.22000)

Using Target operations
Found 14 targets. Expanding targets to file list...
Target &#39;ApplicationEvents&#39; with Id &#39;2da16dbf-ea47-448e-a00f-fc442c3109ba&#39; already processed. Skipping!
Target &#39;ApplicationEvents&#39; with Id &#39;2da16dbf-ea47-448e-a00f-fc442c3109ba&#39; already processed. Skipping!
Target &#39;ApplicationEvents&#39; with Id &#39;2da16dbf-ea47-448e-a00f-fc442c3109ba&#39; already processed. Skipping!
Target &#39;ApplicationEvents&#39; with Id &#39;2da16dbf-ea47-448e-a00f-fc442c3109ba&#39; already processed. Skipping!
Target &#39;ApplicationEvents&#39; with Id &#39;2da16dbf-ea47-448e-a00f-fc442c3109ba&#39; already processed. Skipping!
Found 3,059 files in 4.257 seconds. Beginning copy...
        Deferring &#39;C:\Windows\System32\winevt\logs\Application.evtx&#39; due to IOException...
        Deferring &#39;C:\Windows\System32\winevt\Logs\Microsoft-Windows-Windows Defender%4Operational.evtx&#39; due to IOException...
        Deferring &#39;C:\Windows\System32\winevt\Logs\Microsoft-Windows-Windows Defender%4WHC.evtx&#39; due to IOException...
        Deferring &#39;C:\ProgramData\Microsoft\Windows Defender\Support\MPDetection-20220126-183133.log&#39; due to IOException...
        Deferring &#39;C:\ProgramData\Microsoft\Windows Defender\Support\MPDeviceControl-20211016-164735.log&#39; due to IOException...
        Deferring &#39;C:\ProgramData\Microsoft\Windows Defender\Support\MPLog-10172021-040927.log&#39; due to IOException...
        Deferring &#39;C:\ProgramData\Microsoft\Windows Defender\Support\MpWppTracing-20220210-070038-00000003-ffffffff.bin&#39; due to IOException...
        Deferring &#39;C:\Windows\System32\winevt\logs\HardwareEvents.evtx&#39; due to IOException...
        Deferring &#39;C:\Windows\System32\winevt\logs\IntelAudioServiceLog.evtx&#39; due to IOException...
        Deferring &#39;C:\Windows\System32\winevt\logs\Internet Explorer.evtx&#39; due to IOException...
.
.
.
.
Executing remaining modules...
        Running &#39;EvtxECmd\EvtxECmd.exe&#39;: -d C:\Users\Umair\Desktop\kape --csv C:\Users\Umair\Desktop\4n6-2\EventLogs
        Running &#39;JLECmd.exe&#39;: -d C:\Users\Umair\Desktop\kape --csv C:\Users\Umair\Desktop\4n6-2\FileFolderAccess -q
        Running &#39;LECmd.exe&#39;: -d C:\Users\Umair\Desktop\kape --csv C:\Users\Umair\Desktop\4n6-2\FileFolderAccess -q
        Running &#39;PECmd.exe&#39;: -d C:\Users\Umair\Desktop\kape --csv C:\Users\Umair\Desktop\4n6-2\ProgramExecution -q
        Running &#39;RBCmd.exe&#39;: -d C:\Users\Umair\Desktop\kape --csv C:\Users\Umair\Desktop\4n6-2\FileDeletion -q
        Running &#39;RECmd\RECmd.exe&#39;: -d C:\Users\Umair\Desktop\kape --bn BatchExamples\Kroll_Batch.reb --nl false --csv C:\Users\Umair\Desktop\4n6-2\Registry -q
        Running &#39;SBECmd.exe&#39;: -d C:\Users\Umair\Desktop\kape --csv C:\Users\Umair\Desktop\4n6-2\FileFolderAccess -q
        Running &#39;SQLECmd\SQLECmd.exe&#39;: -d C:\Users\Umair\Desktop\kape --csv C:\Users\Umair\Desktop\4n6-2\SQLDatabases
        Running &#39;SrumECmd.exe&#39;: -d C:\Users\Umair\Desktop\kape -k --csv C:\Users\Umair\Desktop\4n6-2\SystemActivity
        Running &#39;SumECmd.exe&#39;: -d C:\Users\Umair\Desktop\kape\Windows\System32\LogFiles\SUM --csv C:\Users\Umair\Desktop\4n6-2\SUMDatabase
Executed 18 processors in 192.2738 seconds

Total execution time: 258.1812 seconds

Press any key to exit
</code></pre><p>Notice that at the backend, KAPE is running the <code>kape.exe</code> in a command line. We can check out the files created by KAPE once it completes processing them. The below snapshot shows our <code>Module destination</code>. Notice how KAPE has processed the files according to different categories.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a0fad94b0afd9f8f424f3071f0d4e475.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/a0fad94b0afd9f8f424f3071f0d4e475.png" />
    
  </figure>
</p>
<p><strong>KAPE CLI</strong></p>
<p>Though we used the GUI
in the previous task, KAPE is a command-line tool. Therefore, it is
pertinent to know how to use KAPE through the command line to make full
use of it.</p>
<p>For a list of all the different switches that can be used with KAPE, open an elevated PowerShell (Run As Administrator), go to the path where the KAPE binary is located, and type <code>kape.exe</code>. You will see something like this as an output.</p>
<p>Administrator: Command Prompt</p>
<pre tabindex="0"><code>D:\KAPE&gt;kape.exe

KAPE version 1.1.0.1 Author: Eric Zimmerman (kape@kroll.com)

        tsource         Target source drive to copy files from (C, D:, or F:\ for example)
        target          Target configuration to use
        tdest           Destination directory to copy files to. If --vhdx, --vhd or --zip is set, files will end up in VHD(X) container or zip file
        tlist           List available Targets. Use . for Targets directory or name of subdirectory under Targets.
        tdetail         Dump Target file details
        tflush          Delete all files in &#39;tdest&#39; prior to collection
        tvars           Provide a list of key:value pairs to be used for variable replacement in Targets. Ex: --tvars user:eric would allow for using %user% in a Target which is replaced with eric at runtime. Multiple pairs should be separated by ^
        tdd             Deduplicate files from --tsource (and VSCs, if enabled) based on SHA-1. First file found wins. Default is TRUE

        msource         Directory containing files to process. If using Targets and this is left blank, it will be set to --tdest automatically
        module          Module configuration to use
        mdest           Destination directory to save output to
        mlist           List available Modules. Use . for Modules directory or name of subdirectory under Modules.
        mdetail         Dump Module processors details
        mflush          Delete all files in &#39;mdest&#39; prior to running Modules
        mvars           Provide a list of key:value pairs to be used for variable replacement in Modules. Ex: --mvars foo:bar would allow for using %foo% in a module which is replaced with bar at runtime. Multiple pairs should be separated by ^
        mef             Export format (csv, html, json, etc.). Overrides what is in Module config

        sim             Do not actually copy files to --tdest. Default is FALSE
        vss             Process all Volume Shadow Copies that exist on --tsource. Default is FALSE

        vhdx            The base name of the VHDX file to create from --tdest. This should be an identifier, NOT a filename. Use this or --vhd or --zip
        vhd             The base name of the VHD file to create from --tdest. This should be an identifier, NOT a filename. Use this or --vhdx or --zip
        zip             The base name of the ZIP file to create from --tdest. This should be an identifier, NOT a filename. Use this or --vhdx or --vhd

        scs             SFTP server host/IP for transferring *compressed VHD(X)* container
        scp             SFTP server port. Default is 22
        scu             SFTP server username. Required when using --scs
        scpw            SFTP server password
        scd             SFTP default directory to upload to. Will be created if it does not exist
        scc             Comment to include with transfer. Useful to include where a transfer came from. Defaults to the name of the machine where KAPE is running

        s3p             S3 provider name. Example: spAmazonS3 or spGoogleStorage. See &#39;https://bit.ly/34s9nS6&#39; for list of providers. Default is &#39;spAmazonS3&#39;
        s3r             S3 region name. Example: us-west-1 or ap-southeast-2. See &#39;https://bit.ly/3aNxXhc&#39; for list of regions by provider
        s3b             S3 bucket name
        s3k             S3 Access key
        s3s             S3 Access secret
        s3st            S3 Session token
        s3kp            S3 Key prefix. When set, this value is used as the beginning of the key. Example: &#39;US1012/KapeData&#39;
        s3o             When using &#39;spOracle&#39; provider, , set this to the &#39;Object Storage Namespace&#39; to use
        s3c             Comment to include with transfer. Useful to include where a transfer came from. Defaults to the name of the machine where KAPE is running

        s3url           S3 Presigned URL. Must be a PUT request vs. a GET request

        asu             Azure Storage SAS Uri
        asc             Comment to include with transfer. Useful to include where a transfer came from. Defaults to the name of the machine where KAPE is running

        zv              If true, the VHD(X) container will be zipped after creation. Default is TRUE
        zm              If true, directories in --mdest will be zipped. Default is FALSE
        zpw             If set, use this password when creating zip files (--zv | --zm | --zip)

        hex             Path to file containing SHA-1 hashes to exclude. Only files with hashes not found will be copied

        debug           Show debug information during processing
        trace           Show trace information during processing

        gui             If true, KAPE will not close the window it executes in when run from gkape. Default is FALSE

        ul              When using _kape.cli, when true, KAPE will execute entries in _kape.cli one at a time vs. in parallel. Default is FALSE

        cu              When using _kape.cli, if true, KAPE will delete _kape.cli and both Target/Module directories upon exiting. Default is FALSE

        sftpc           Path to config file defining SFTP server parameters, including port, users, etc. See documentation for examples
        sftpu           When true, show passwords in KAPE switches for connection when using --sftpc. Default is TRUE

        rlc             If true, local copy of transferred files will NOT be deleted after upload. Default is FALSE
        guids           KAPE will generate 10 GUIDs and exit. Useful when creating new Targets/Modules. Default is FALSE
        sync            If true, KAPE will download the latest Targets and Modules from specified URL prior to running. Default is https://github.com/EricZimmerman/KapeFiles/archive/master.zip

        ifw             If false, KAPE will warn if a process related to FTK is found, then exit. Set to true to ignore this warning and attempt to proceed. Default is FALSE

        Variables: %d = Timestamp (yyyyMMddTHHmmss)
                   %s = System drive letter                   %m = Machine nameExamples: kape.exe --tsource L: --target RegistryHives --tdest &#34;c:\temp\RegistryOnly&#34;
          kape.exe --tsource H --target EvidenceOfExecution --tdest &#34;c:\temp\default&#34; --debug
          kape.exe --tsource \\server\directory\subdir --target Windows --tdest &#34;c:\temp\default_%d&#34; --vhdx LocalHost
          kape.exe --msource &#34;c:\temp\default&#34; --module LECmd --mdest &#34;c:\temp\modulesOut&#34; --trace --debug

          Short options (single letter) are prefixed with a single dash. Long commands are prefixed with two dashes

          Full documentation: https://ericzimmerman.github.io/KapeDocs/

D:\KAPE&gt;
</code></pre><p>We can see from the above screenshot that while collecting Targets, the switches <code>tsource</code>, <code>target</code> and <code>tdest</code> are required. Similarly, when processing files using Modules, <code>module</code> and <code>mdest</code> are required switches. The other switches are optional as per the requirements of the collection.</p>
<p>With
this information, let&rsquo;s build a command to perform the same task we
performed in the previous task. i.e., collect triage data using the <code>KapeTriage</code> Compound Target and process it using the <code>!EZParser</code> Compound Module. Since we are not using the GUI version, we will start with typing:</p>
<p><code>kape.exe</code></p>
<p>To add a Target source, let&rsquo;s append <code>--tsource</code> and that Target path:</p>
<p><code>kape.exe --tsource C:</code></p>
<p>The <code>--target</code> flag will be used for selecting the Target the <code>--tdest</code>
flag for the Target destination. For the sake of simplicity, we will
set the Target destination to a directory named target on the Desktop. KAPE will create a new directory if it doesn&rsquo;t already exist. Our command line now looks like this:</p>
<p><code>kape.exe --tsource C: --target KapeTriage --tdest C:\Users\thm-4n6\Desktop\target</code></p>
<p>Running
the above command will collect triage data defined in the KapeTriage
Target and save it to the provided destination. However, it will not
process it or perform any other activity on the data.</p>
<p>If we want to flush the Target destination, we can add <code>--tflush</code> to do that. For now, let&rsquo;s move on to adding the Module options. If we were using a Module source, we would have used a &gt;<code>--msource</code> flag in a similar manner to the <code>--tsource</code>
flag. But in this case, let&rsquo;s use the Target destination as the Module
source. By doing this, we will not need to add it explicitly, and we can
move on to adding the Module destination using the <code>--mdest</code> flag:</p>
<p><code>kape.exe --tsource C: --target KapeTriage --tdest C:\Users\thm-4n6\Desktop\Target --mdest C:\Users\thm-4n6\Desktop\module</code></p>
<p>We have just used a directory named module for the Module destination.</p>
<p>To Process the Target destination using a Module, we need to provide the Module name using the <code>--module</code> flag. To process it using the <code>!EZParser</code> Module, we will append <code>--module !EZParser</code>, making our command look like this:</p>
<p><code>kape.exe --tsource C: --target KapeTriage --tdest  C:\Users\thm-4n6\Desktop\Target --mdest C:\Users\thm-4n6\Desktop\module  --module !EZParser</code></p>
<p>Please note that we will need to run this command in an elevated shell (with Administrator privileges) for KAPE to collect the data.</p>
<p>We can modify the command as per our needs and the switches provided by KAPE.
When we run this command, we will see a similar window as in the
previous task. You can check out the files collected by KAPE Targets and
Modules once it completes.</p>


<h2 class="relative group"><strong>Batch Mode:</strong> 
    <div id="batch-mode" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#batch-mode" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>KAPE can also be run in batch mode. What this means is that we can provide a list of commands for KAPE to run in a file named <code>_kape.cli</code>. Then we keep this file in the directory containing the KAPE binary. When <code>kape.exe</code> is executed as an administrator, it checks if there is <code>_kape.cli</code>
file present in the directory. If so, it executes the commands
mentioned in the cli file. This mode can be used if you need someone to
run KAPE
for you, you will keep all the commands in a single line, and all you
need is for the person to right-click and run kape.exe as administrator.
For example, if we have to perform the same task as we did earlier in
this task using batch mode, we will have to create a _kape.cli file with
the following content:</p>
<ul>
<li><code>-tsource C: --target KapeTriage --tdest C:\Users\thm-4n6\Desktop\Target --mdest C:\Users\thm-4n6\Desktop\module --module !EZParser</code></li>
</ul>
<p>When we run <code>kape.exe</code>, it will perform the same tasks as when we ran it through CLI above.</p>


<h3 class="relative group"><strong>VOLATILITY</strong> 
    <div id="volatility-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#volatility-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><strong>Identifying Image Info and Profiles</strong></p>
<p>By default, Volatility comes with all existing Windows profiles from Windows XP to Windows 10.</p>
<p>Image profiles can be hard to determine if you don&rsquo;t know exactly
what version and build the machine you extracted a memory dump from was.
In some cases, you may be given a memory file with no other context,
and it is up to you to figure out where to go from there. In that case,
Volatility has your back and comes with the <code>imageinfo</code> plugin. This plugin will take the provided memory dump and assign it a list of the best possible OS
profiles. OS profiles have since been deprecated with Volatility3, so
we will only need to worry about identifying the profile if using
Volatility2; this makes life much easier for analyzing memory dumps.</p>
<p>Note: <code>imageinfo</code> is not always correct and can have
varied results depending on the provided dump; use with caution and test
multiple profiles from the provided list.</p>
<p>If we are still looking to get information about what the host is
running from the memory dump, we can use the following three plugins <code>windows.info</code> <code>linux.info</code> <code>mac.info</code>.  This plugin will provide information about the host from the memory dump.</p>
<p>Syntax: <code>python3 vol.py -f &lt;file&gt; windows.info</code></p>
<p><code>DTB     0x2fe000                                                                                                                                                Symbols file:///opt/volatility3/volatility3/symbols/windows/ntkrnlpa.pdb/30B5FB31AE7E4ACAABA750AA241FF331-1.json.xz                                             Is64Bit False                                                                                                                                                   IsPAE   True                                                                                                                                                    primary 0 WindowsIntelPAE                                                                                                                                       memory_layer    1 FileLayer                                                                                                                                     KdDebuggerDataBlock     0x80545ae0                                                                                                                              NTBuildLab      2600.xpsp.080413-2111                                                                                                                           CSDVersion      3                                                                                                                                               KdVersionBlock  0x80545ab8                                                                                                                                      Major/Minor     15.2600                                                                                                                                         MachineType     332                                                                                                                                             KeNumberProcessors      1                                                                                                                                       SystemTime      2012-07-22 02:45:08                                                                                                                             NtSystemRoot    C:\WINDOWS                                                                                                                                      NtProductType   NtProductWinNt                                                                                                                                  NtMajorVersion  5                                                                                                                                               NtMinorVersion  1                                                                                                                                               PE MajorOperatingSystemVersion  5                                                                                                                               PE MinorOperatingSystemVersion  1                                                                                                                               PE Machine      332                                                                                                                                             PE TimeDateStamp        Sun Apr 13 18:31:06 2008                                                                                                                thmanalyst@ubuntu:/opt/volatility3$ exit</code></p>
<p>Listing Processes and Connections</p>
<p>Five different plugins
within Volatility allow you to dump processes and network connections,
each with varying techniques used. In this task, we will be discussing
each and its pros and cons when it comes to evasion techniques used by
adversaries.</p>
<p>The most basic way of listing processes is using <code>pslist</code>;
this plugin will get the list of processes from the doubly-linked list
that keeps track of processes in memory, equivalent to the process list
in task manager. The output from this plugin will include all current
processes and terminated processes with their exit times.</p>
<p>Syntax: <code>python3 vol.py -f &lt;file&gt; windows.pslist</code></p>
<pre tabindex="0"><code></code></pre><p>00:00</p>
<p>Some
malware, typically rootkits, will, in an attempt to hide their
processes, unlink itself from the list. By unlinking themselves from the
list you will no longer see their processes when using <code>pslist</code>.  To combat this evasion technique, we can use <code>psscan</code>;this technique of listing processes will locate processes by finding data structures that match <code>_EPROCESS</code>. While this technique can help with evasion countermeasures, it can also cause false positives.</p>
<p>Syntax: <code>python3 vol.py -f &lt;file&gt; windows.psscan</code></p>
<pre tabindex="0"><code></code></pre><p>00:00</p>
<p>The third process plugin, <code>pstree</code>,
does not offer any other kind of special techniques to help identify
evasion like the last two plugins; however, this plugin will list all
processes based on their parent process ID, using the same methods as <code>pslist</code>.
This can be useful for an analyst to get a full story of the processes
and what may have been occurring at the time of extraction.</p>
<p>Syntax: <code>python3 vol.py -f &lt;file&gt; windows.pstree</code></p>
<pre tabindex="0"><code></code></pre><p>00:00</p>
<p>Now
that we know how to identify processes, we also need to have a way to
identify the network connections present at the time of extraction on
the host machine. <code>netstat</code> will attempt to identify all memory structures with a network connection.</p>
<p>Syntax: <code>python3 vol.py -f &lt;file&gt; windows.netstat</code></p>
<p>This
command in the current state of volatility3 can be very unstable,
particularly around old Windows builds. To combat this, you can utilize
other tools like bulk_extractor to extract a PCAP
file from the memory file. In some cases, this is preferred in network
connections that you cannot identify from Volatility alone. <a href="https://tools.kali.org/forensics/bulk-extractor" target="_blank">https://tools.kali.org/forensics/bulk-extractor</a></p>
<p>The last plugin we will cover is <code>dlllist</code>. This plugin will list all DLLs
associated with processes at the time of extraction. This can be
especially useful once you have done further analysis and can filter
output to a specific DLL that might be an indicator for a specific type
of malware you believe to be present on the system.</p>
<p>Syntax: <code>python3 vol.py -f &lt;file&gt; windows.dlllist</code></p>
<p><strong>Volatility Hunting and Detection Capabilities</strong></p>
<p>Volatility offers a
plethora of plugins that can be used to aid in your hunting and
detection capabilities when hunting for malware or other anomalies
within a system&rsquo;s memory.</p>
<p>It is recommended that you have a basic understanding of how evasion
techniques and various malware techniques are employed by adversaries,
as well as how to hunt and detect them before going through this
section.</p>
<p>The first plugin we will be talking about that is one of the most useful when hunting for code injection is <code>malfind</code>.
This plugin will attempt to identify injected processes and their PIDs
along with the offset address and a Hex, Ascii, and Disassembly view of
the infected area. The plugin works by scanning the heap and identifying
processes that have the executable bit set <code>RWE or RX</code> and/or no memory-mapped file on disk (file-less malware).</p>
<p>Based on what <code>malfind</code> identifies, the injected area will
change. An MZ header is an indicator of a Windows executable file. The
injected area could also be directed towards shellcode which requires
further analysis.</p>
<p>Syntax: <code>python3 vol.py -f &lt;file&gt; windows.malfind</code></p>
<pre tabindex="0"><code>01 00 00 00 00 00 00 00 ........        00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2a 00 2a 00 01 00 00 00 00 00 00 00                                                                                         1484    explorer.exe    0x1460000       0x1480fff       VadS    PAGE_EXECUTE_READWRITE  33      1       Disabled                                                4d 5a 90 00 03 00 00 00 MZ......                                                                                                                                04 00 00 00 ff ff 00 00 ........                                                                                                                                b8 00 00 00 00 00 00 00 ........                                                                                                                                40 00 00 00 00 00 00 00 @.......                                                                                                                                00 00 00 00 00 00 00 00 ........                                                                                                                                00 00 00 00 00 00 00 00 ........                                                                                                                                00 00 00 00 00 00 00 00 ........                                                                                                                                00 00 00 00 e0 00 00 00 ........        4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e0 00 00 00                                                                                         1640    reader_sl.exe   0x3d0000        0x3f0fff        VadS    PAGE_EXECUTE_READWRITE  33      1       Disabled                                                4d 5a 90 00 03 00 00 00 MZ......                                                                                                                                04 00 00 00 ff ff 00 00 ........                                                                                                                                b8 00 00 00 00 00 00 00 ........                                                                                                                                40 00 00 00 00 00 00 00 @.......                                                                                                                                00 00 00 00 00 00 00 00 ........                                                                                                                                00 00 00 00 00 00 00 00 ........                                                                                                                                00 00 00 00 00 00 00 00 ........                                                                                                                                00 00 00 00 e0 00 00 00 ........        4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e0 00 00 00                                                                                         thmanalyst@ubuntu:/opt/volatility3$ exit
</code></pre><p>00:12</p>
<p>Volatility also offers the capability to compare the memory file against YARA rules. <code>yarascan</code>
will search for strings, patterns, and compound rules against a rule
set. You can either use a YARA file as an argument or list rules within
the command line.</p>
<p>Syntax: <code>python3 vol.py -f &lt;file&gt; windows.yarascan</code></p>
<p>There
are other plugins that can be considered part of Volatility&rsquo;s hunting
and detection capabilities; however, we will be covering them in the
next task.</p>
<p><strong>Advanced Memory Forensics</strong></p>
<p>Advanced Memory
Forensics can become confusing when you begin talking about system
objects and how malware interacts directly with the system, especially
if you do not have prior experience hunting some of the techniques used
such as hooking and driver manipulation. When dealing with an advanced
adversary, you may encounter malware, most of the time rootkits that
will employ very nasty evasion measures that will require you as an
analyst to dive into the drivers, mutexes, and hooked functions. A
number of modules can help us in this journey to further uncover malware
hiding within memory.</p>
<p>The first evasion technique we will be hunting is hooking; there are
five methods of hooking employed by adversaries, outlined below:</p>
<ul>
<li>SSDT Hooks</li>
<li>IRP Hooks</li>
<li>IAT Hooks</li>
<li>EAT Hooks</li>
<li>Inline Hooks</li>
</ul>
<p>We will only be focusing on hunting SSDT hooking as this one of the
most common techniques when dealing with malware evasion and the easiest
plugin to use with the base volatility plugins.</p>
<p>The <code>ssdt</code> plugin will search for hooking and output its
results. Hooking can be used by legitimate applications, so it is up to
you as the analyst to identify what is evil. As a brief overview of what
SSDT hooking is: <code>SSDT</code> stands for <em>System Service Descriptor Table;</em> the
Windows kernel uses this table to look up system functions. An
adversary can hook into this table and modify pointers to point to a
location the rootkit controls.</p>
<p>There can be hundreds of table entries that <code>ssdt</code> will
dump; you will then have to analyze the output further or compare
against a baseline. A suggestion is to use this plugin after
investigating the initial compromise and working off it as part of your
lead investigation.</p>
<p>Syntax: <code>python3 vol.py -f &lt;file&gt; windows.ssdt</code></p>
<pre tabindex="0"><code>262     0x8057971c      ntoskrnl        NtUnloadDriver                                                                                                          263     0x80618b36      ntoskrnl        NtUnloadKey                                                                                                             264     0x80618d50      ntoskrnl        NtUnloadKeyEx                                                                                                           265     0x8056e856      ntoskrnl        NtUnlockFile                                                                                                            266     0x805ac4ce      ntoskrnl        NtUnlockVirtualMemory                                                                                                   267     0x805a8296      ntoskrnl        NtUnmapViewOfSection                                                                                                    268     0x805f1502      ntoskrnl        NtVdmControl                                                                                                            269     0x80639288      ntoskrnl        NtWaitForDebugEvent                                                                                                     270     0x805b6176      ntoskrnl        NtWaitForMultipleObjects                                                                                                271     0x805b608c      ntoskrnl        NtWaitForSingleObject                                                                                                   272     0x8060d5ba      ntoskrnl        NtWaitHighEventPair                                                                                                     273     0x8060d556      ntoskrnl        NtWaitLowEventPair                                                                                                      274     0x80572248      ntoskrnl        NtWriteFile                                                                                                             275     0x80572858      ntoskrnl        NtWriteFileGather                                                                                                       276     0x8059b1ac      ntoskrnl        NtWriteRequestData                                                                                                      277     0x805a981c      ntoskrnl        NtWriteVirtualMemory                                                                                                    278     0x8050222c      ntoskrnl        NtYieldExecution                                                                                                        279     0x8060e632      ntoskrnl        NtCreateKeyedEvent                                                                                                      280     0x8060e71c      ntoskrnl        NtOpenKeyedEvent                                                                                                        281     0x8060e7ce      ntoskrnl        NtReleaseKeyedEvent                                                                                                     282     0x8060ea5a      ntoskrnl        NtWaitForKeyedEvent                                                                                                     283     0x805c1798      ntoskrnl        NtQueryPortInformationProcess                                                                                           thmanalyst@ubuntu:/opt/volatility3$ exit
</code></pre><p>00:09</p>
<p>Adversaries will also use malicious driver files as part of their evasion. Volatility offers two plugins to list drivers.</p>
<p>The <code>modules</code>
plugin will dump a list of loaded kernel modules; this can be useful in
identifying active malware. However, if a malicious file is idly
waiting or hidden, this plugin may miss it.</p>
<p>This plugin is best
used once you have further investigated and found potential indicators
to use as input for searching and filtering.</p>
<p>Syntax: <code>python3 vol.py -f &lt;file&gt; windows.modules</code></p>
<pre tabindex="0"><code>0x8205f2f8      0xf888a000      0x9000  wanarp.sys      \SystemRoot\system32\DRIVERS\wanarp.sys Disabled                                                        0x822095b8      0xf889a000      0x10000 Cdfs.SYS        \SystemRoot\System32\Drivers\Cdfs.SYS   Disabled                                                        0x82291110      0xf89aa000      0x8000  usbccgp.sys     \SystemRoot\system32\DRIVERS\usbccgp.sys        Disabled                                                0x82250cc8      0xf82d4000      0x3000  hidusb.sys      \SystemRoot\system32\DRIVERS\hidusb.sys Disabled                                                        0x81e86090      0xf88aa000      0x9000  HIDCLASS.SYS    \SystemRoot\system32\DRIVERS\HIDCLASS.SYS       Disabled                                                0x81e350c8      0xf89b2000      0x7000  HIDPARSE.SYS    \SystemRoot\system32\DRIVERS\HIDPARSE.SYS       Disabled                                                0x82303488      0xf82d0000      0x3000  mouhid.sys      \SystemRoot\system32\DRIVERS\mouhid.sys Disabled                                                        0x8224e700      0xf7f77000      0x18000 dump_atapi.sys  \SystemRoot\System32\Drivers\dump_atapi.sys     Disabled                                                0x821488a8      0xf8bae000      0x2000  dump_WMILIB.SYS \SystemRoot\System32\Drivers\dump_WMILIB.SYS    Disabled                                                0x8224d280      0xbf800000      0x1c3000        win32k.sys      \SystemRoot\System32\win32k.sys Disabled                                                        0x820c21f8      0xf82c0000      0x3000  Dxapi.sys       \SystemRoot\System32\drivers\Dxapi.sys  Disabled                                                        0x82219e78      0xf89ba000      0x5000  watchdog.sys    \SystemRoot\System32\watchdog.sys       Disabled                                                        0x822f31d8      0xbf9c3000      0x12000 dxg.sys \SystemRoot\System32\drivers\dxg.sys    Disabled                                                                0x82066e80      0xf8d43000      0x1000  dxgthk.sys      \SystemRoot\System32\drivers\dxgthk.sys Disabled                                                        0x81e85008      0xbff50000      0x3000  framebuf.dll    \SystemRoot\System32\framebuf.dll       Disabled                                                        0x81e296b8      0xf7c6f000      0x4000  ndisuio.sys     \SystemRoot\system32\DRIVERS\ndisuio.sys        Disabled                                                0x8227aa38      0xf792a000      0x15000 wdmaud.sys      \SystemRoot\system32\drivers\wdmaud.sys Disabled                                                        0x822d64a8      0xf7bdf000      0xf000  sysaudio.sys    \SystemRoot\system32\drivers\sysaudio.sys       Disabled                                                0x822937c0      0xf7887000      0x2d000 mrxdav.sys      \SystemRoot\system32\DRIVERS\mrxdav.sys Disabled                                                        0x82198138      0xf8be0000      0x2000  ParVdm.SYS      \SystemRoot\System32\Drivers\ParVdm.SYS Disabled                                                        0x82259430      0xf780d000      0x52000 srv.sys \SystemRoot\system32\DRIVERS\srv.sys    Disabled                                                                0x821c5120      0xf75c4000      0x41000 HTTP.sys        \SystemRoot\System32\Drivers\HTTP.sys   Disabled                                                        thmanalyst@ubuntu:/opt/volatility3$ exit
</code></pre><p>00:09</p>
<p>The <code>driverscan</code> plugin will scan for drivers present on
the system at the time of extraction. This plugin can help to identify
driver files in the kernel that the <code>modules</code> plugin might have missed or were hidden.</p>
<p>As
with the last plugin, it is again recommended to have a prior
investigation before moving on to this plugin. It is also recommended to
look through the <code>modules</code> plugin before <code>driverscan</code>.</p>
<p>Syntax: <code>python3 vol.py -f &lt;file&gt; windows.driverscan</code></p>
<p>In most cases, <code>driverscan</code> will come up with no output; however, if you do not find anything with the <code>modules</code> plugin, it can be useful to attempt using this plugin.</p>
<p>There are also other plugins listed below that can be helpful when attempting to hunt for advanced malware in memory.</p>
<ul>
<li><code>modscan</code></li>
<li><code>driverirp</code></li>
<li><code>callbacks</code></li>
<li><code>idt</code></li>
<li><code>apihooks</code></li>
<li><code>moddump</code></li>
<li><code>handles</code></li>
</ul>
<p>Note: Some of these are only present on Volatility2 or are part
of third-party plugins. To get the most out of Volatility, you may need
to move to some third-party or custom plugins.</p>


<h3 class="relative group"><strong>VELOCIRAPTOR</strong> 
    <div id="velociraptor-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#velociraptor-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Per the official Velociraptor <a href="https://docs.velociraptor.app/docs/overview/" target="_blank">documentation</a>, &ldquo;<em>Velociraptor is a unique, advanced open-source endpoint monitoring, digital forensic and cyber response platform. It was developed by Digital Forensic and Incident Response (DFIR)
professionals who needed a powerful and efficient way to hunt for
specific artifacts and monitor activities across fleets of endpoints.
Velociraptor provides you with the ability to more effectively respond
to a wide range of digital forensic and cyber incident response
investigations and data breaches</em>&rdquo;.</p>
<p>This tool was created by Mike Cohen, a former Google employee who worked on tools such as <a href="https://github.com/google/grr" target="_blank">GRR</a> (GRR Rapid Response) and <a href="https://github.com/google/rekall" target="_blank">Rekall</a> (Rekall
Memory Forensic Framework). Mike joined Rapid7&rsquo;s Detection and Response
Team and continues to work on improving Velociraptor. At the date of
this entry, the latest release for Velociraptor is <a href="https://www.rapid7.com/blog/post/2022/02/03/velociraptor-version-0-6-3-dig-deeper-with-more-speed-and-scalability/" target="_blank">0.6.3</a>.</p>
<p><strong>Interacting with client machines</strong></p>
<p><strong>Inspecting Clients</strong></p>
<p>If you didn&rsquo;t notice, some links are grayed out when you first log into Velociraptor. See below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/dashboard-grayed-out-links.png" alt="https://assets.tryhackme.com/additional/velociraptor/dashboard-grayed-out-links.png" />
    
  </figure>
</p>
<p>These
links are specific to client endpoints and will become active once the
analyst interacts with these endpoints within the Velociraptor UI.</p>
<p>Let&rsquo;s add a client to Velociraptor. Remember, since the attached VM is running Windows Subsystem for Linux (WSL), the Velociraptor server is running in Ubuntu, but the client will be Windows.</p>
<p>Run the commands for &lsquo;Add Windows as a client (CMD)&rsquo; from the commands.txt on the desktop.</p>
<p>Add Windows as a client (CMD)</p>
<pre tabindex="0"><code>C:\Program Files\Velociraptor&gt; velociraptor-v0.5.8-windows-amd64.exe --config velociraptor.config.yaml client -v
[INFO] 2022-03-31T05:47:36-07:00  _    __     __           _                  __
[INFO] 2022-03-31T05:47:36-07:00 | |  / /__  / /___  _____(_)________ _____  / /_____  _____
[INFO] 2022-03-31T05:47:36-07:00 | | / / _ \/ / __ \/ ___/ / ___/ __ `/ __ \/ __/ __ \/ ___/
[INFO] 2022-03-31T05:47:36-07:00 | |/ /  __/ / /_/ / /__/ / /  / /_/ / /_/ / /_/ /_/ / /
[INFO] 2022-03-31T05:47:36-07:00 |___/\___/_/\____/\___/_/_/   \__,_/ .___/\__/\____/_/
[INFO] 2022-03-31T05:47:36-07:00                                   /_/
[INFO] 2022-03-31T05:47:36-07:00 Digging deeper!                  https://www.velocidex.com
[INFO] 2022-03-31T05:47:36-07:00 This is Velociraptor 0.5.8 built on 2021-04-11T22:11:10Z (e468f54c)
[INFO] 2022-03-31T05:47:36-07:00 Loading config from file velociraptor.config.yaml
Generating new private key....
[INFO] 2022-03-31T05:47:36-07:00 Setting temp directory to C:\Program Files\Velociraptor\Tools
[...]
</code></pre><p>To see the client and interact with it, click on the <code>magnifying glass</code> with an empty search query (no text in the search bar) or click <code>Show All</code>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/search-clients.png" alt="https://assets.tryhackme.com/additional/velociraptor/search-clients.png" />
    
  </figure>
</p>
<p>The output will display a list of client machines running the Velociraptor agent in a table form.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/client-list.png" alt="https://assets.tryhackme.com/additional/velociraptor/client-list.png" />
    
  </figure>
</p>
<p>Below is a brief explanation of each column.</p>
<p>| <strong>Online State</strong> | A
green dot indicates the endpoint is online and communicating with the
Velociraptor server. A yellow dot means the server hasn&rsquo;t received any
communication from the endpoint within a 24-hour time frame. A red dot
means it&rsquo;s been more than 24 hours since the server last heard from the</p>
<table>
  <thead>
      <tr>
          <th>endpoint.</th>
          <th></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Client ID</strong></td>
          <td>This is a unique ID</td>
      </tr>
      <tr>
          <td>assigned to the client by the Velociraptor server, and the server will</td>
          <td></td>
      </tr>
      <tr>
          <td>use this client ID to identify the endpoint. A client ID always starts</td>
          <td></td>
      </tr>
      <tr>
          <td>with the letter <strong>C</strong>.</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>Hostname</strong></td>
          <td>This</td>
      </tr>
      <tr>
          <td>is the hostname the client identifies itself to the Velociraptor server.</td>
          <td></td>
      </tr>
      <tr>
          <td>Remember that hostnames can change, hence why Velociraptor uses the</td>
          <td></td>
      </tr>
      <tr>
          <td>Client ID instead of identifying a client machine.</td>
          <td></td>
      </tr>
      <tr>
          <td><strong>Operating System Version</strong></td>
          <td>The Velociraptor client can run on Windows, Linux, or MacOS. The details regarding the client operating system are displayed in this column.</td>
      </tr>
      <tr>
          <td><strong>Labels</strong></td>
          <td>Client machines may have multiple labels attached to them. This is useful to identify multiple clients as a group.</td>
      </tr>
  </tbody>
</table>
<p>Click on the agent to bring you to a semi-detailed view. By default, the view shown is the <strong>overview</strong> for the client. </p>
<hr>


<h1 class="relative group"><strong>Overview</strong> 
    <div id="overview" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#overview" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>In this view, the analyst (you) will see additional information about the client. The additional details are listed below:</p>
<ul>
<li><strong>Client ID</strong></li>
<li><strong>Agent Version</strong></li>
<li><strong>Agent Name</strong></li>
<li><strong>Last Seen At</strong></li>
<li><strong>Last Seen IP</strong></li>
<li><strong>Operating System</strong></li>
<li><strong>Hostname</strong></li>
<li><strong>Release</strong></li>
<li><strong>Architecture</strong></li>
<li><strong>Client Metadata</strong></li>
</ul>
<p><strong>VQL Drilldown</strong>In this view, there is additional information about the client, such as Memory and CPU
usage over 24 hours timespan, the Active Directory domain if the client
is a domain-joined machine and the active local accounts for the
client.</p>
<p>The data is represented in two colors in the Memory and CPU footprint over the past 24 hours.</p>
<ul>
<li><strong>Orange</strong> - Memory usage</li>
<li><strong>Blue</strong> - CPU usage</li>
</ul>


<h1 class="relative group"><strong>Shell</strong> 
    <div id="shell" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#shell" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>With the shell, commands can be executed remotely on the client machine. Commands can be run in  <strong>PowerShell</strong>, <strong>CMD</strong>, <strong>Bash</strong>, or <strong>VQL</strong>.
Depending on the target operating system will determine which the
analyst will pick. For example, CMD will not be a viable option if the
client machine is running Linux.</p>
<p>It&rsquo;s straightforward, choose one of the options to run the command in and click <code>Launch</code>.</p>
<p>In the example below, the command <code>whoami</code> was executed with PowerShell. The command results are not immediately visible, and the <strong>eyeball</strong> icon needs to be toggled to see the command results.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/powershell-whoami.png" alt="https://assets.tryhackme.com/additional/velociraptor/powershell-whoami.png" />
    
  </figure>
</p>


<h1 class="relative group"><strong>Collected</strong> 
    <div id="collected" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#collected" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Here
the analyst will see the results from the commands executed previously
from Shell. Other actions, such as interacting with the <strong>VFS</strong> (<strong>Virtual File System</strong>), will appear here in Collected. VFS will be discussed later in upcoming tasks.</p>
<p>Across the top pane are brief details of the&rsquo; collected&rsquo; artifact. See below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/collected1.png" alt="https://assets.tryhackme.com/additional/velociraptor/collected1.png" />
    
  </figure>
</p>
<p>Clicking
on any FlowId will populate the bottom pan with additional details
regarding the information collected for that artifact or collection.</p>
<p>In the below screenshot, the output is from <strong>Artifact Collection</strong>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/collected2b.png" alt="https://assets.tryhackme.com/additional/velociraptor/collected2b.png" />
    
  </figure>
</p>
<p>This
section is very busy, and I&rsquo;ll leave you to acquaint yourself with the
information displayed here for each collected artifact.</p>
<p>The
questions in this task will help nudge you to navigate throughout the
output returned for each shell execution (e.i. whoami).</p>
<p>In the next task, we&rsquo;ll explore how to create a new collection and review the results in Collected.</p>


<h1 class="relative group"><strong>Interrogate</strong> 
    <div id="interrogate" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#interrogate" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Per the <a href="https://docs.velociraptor.app/docs/gui/clients/" target="_blank">documentation</a>,
&ldquo;Interrogate operation. Interrogation normally occurs when the client
first enrolls, but you can interrogate any client by clicking the
Interrogate button&rdquo;.</p>
<p>To confirm this, click <code>Interrogate</code>. Now navigate back to Collected. You will notice that the <strong>Artifact Collection</strong> is <strong>Generic. Client.Info</strong>, which is an additional collection on the list. The first artifact collection in the list is indeed <strong>Generic.Client.Info</strong>. This is the same information displayed under <strong>VQL Drilldown</strong>.</p>
<p>Refer to the official Velociraptor documentation titled <a href="https://docs.velociraptor.app/docs/gui/clients/" target="_blank">Inspecting Clients</a> for additional information.</p>
<p><strong>﻿
Creating a new collection</strong></p>
<p>In this task let&rsquo;s create a new collection.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/new-collection.png" alt="https://assets.tryhackme.com/additional/velociraptor/new-collection.png" />
    
  </figure>
</p>
<p>We will take advantage of the WSL set-up in the attached VM and choose an artifact specific to Ubuntu.</p>
<p>There will be 5 stages in this process.</p>
<ul>
<li><strong>Select Artifacts</strong></li>
<li><strong>Configure Parameters</strong></li>
<li><strong>Specify Resources</strong></li>
<li><strong>Review</strong></li>
<li><strong>Launch</strong></li>
</ul>


<h1 class="relative group"><strong>Select Artifacts</strong> 
    <div id="select-artifacts" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#select-artifacts" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>In the search bar, type <code>Windows.KapeFiles.Targets</code>. If you&rsquo;re not familiar with <strong>KAPE</strong>, please visit the KAPE <a href="https://tryhackme.com/room/kape" target="_blank">room</a>.</p>
<p>In short, <strong>KapeFiles</strong> are community-created targets and modules for use with KAPE. But as you can see, other tools use these Kapefiles as well.</p>
<p>When
you select the artifact, a brief description of the collector will be
displayed on the right, along with a rundown of the parameters.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/select-artifacts2.png" alt="https://assets.tryhackme.com/additional/velociraptor/select-artifacts2.png" />
    
  </figure>
</p>


<h1 class="relative group">Configure Parameters 
    <div id="configure-parameters" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#configure-parameters" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/configure-parameters.png" alt="https://assets.tryhackme.com/additional/velociraptor/configure-parameters.png" />
    
  </figure>
</p>
<p>Scroll down and check <strong>Ubuntu</strong>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/check-ubuntu.png" alt="https://assets.tryhackme.com/additional/velociraptor/check-ubuntu.png" />
    
  </figure>
</p>
<p>Next, click on <strong>Specify Resources</strong>.</p>


<h1 class="relative group"><strong>Specify Resources</strong> 
    <div id="specify-resources" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#specify-resources" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>You can leave this untouched. See the below screenshot.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/specify-resources.png" alt="https://assets.tryhackme.com/additional/velociraptor/specify-resources.png" />
    
  </figure>
</p>
<p>Next, click on <strong>Review</strong>.</p>


<h1 class="relative group"><strong>Review</strong> 
    <div id="review" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#review" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The output will display in JSON format and it&rsquo;s pretty straightforward. Only one setting was enabled to collect, which was Ubuntu.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/review-request.png" alt="https://assets.tryhackme.com/additional/velociraptor/review-request.png" />
    
  </figure>
</p>


<h1 class="relative group"><strong>Launch</strong> 
    <div id="launch" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#launch" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Everything should be in order. Now it&rsquo;s time to launch the collection to gather the artifacts.</p>
<p>When you click <strong>Launch</strong>, you will be redirected to the Collected view. Notice that there should be a new entry with the newly created collection.</p>
<p>In
particular, notice the State. It should show an hourglass which
indicates the artifacts are actively being gathered for that
collection.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/collection-running.png" alt="https://assets.tryhackme.com/additional/velociraptor/collection-running.png" />
    
  </figure>
</p>
<p>Once the artifacts have been gathered, the state will change from an hourglass to a checkmark like the others.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/collection-done-2.png" alt="https://assets.tryhackme.com/additional/velociraptor/collection-done-2.png" />
    
  </figure>
</p>
<p>As
the list of collections grows, you can search for specific collections
using the textfield at the top of the column. See the above screenshot.</p>
<p>Sweet! Now that we got that covered, let&rsquo;s look at VFS.</p>
<p>Refer to the Velociraptor documentation to learn more about <a href="https://docs.velociraptor.app/docs/gui/artifacts/" target="_blank">Artifacts</a>.</p>


<h1 class="relative group"><strong>The Virtual File System</strong> 
    <div id="the-virtual-file-system" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-virtual-file-system" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Per the <a href="https://docs.velociraptor.app/docs/gui/vfs/" target="_blank">documentation</a>, &ldquo;<em>The VFS is simply a server side cache of the files on the endpoint. It is merely a familiar GUI to allow inspection of the client’s filesystem</em>&rdquo;.</p>
<p>This can prove useful in an incident response scenario where you, the analyst, need to inspect artifacts in a client.</p>
<p>Refer
to the official documentation for a complete overview of the VFS. In
this task, we&rsquo;re going to focus on getting hands-on with VFS.</p>
<p>Below is what you should see when you first access the VFS for a client.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/default-vfs.png" alt="https://assets.tryhackme.com/additional/velociraptor/default-vfs.png" />
    
  </figure>
</p>
<p>In the left pane, along with the middle pane, there are 4 folders (or accessors, filesystem access drivers):</p>
<ul>
<li><strong>file - uses operating system APIs to access files</strong></li>
<li><strong>ntfs - uses raw NTFS parsing to access low level files</strong></li>
<li><strong>registry - uses operating system APIs to access the Windows registry</strong></li>
<li><strong>artifacts - previously run collections.</strong></li>
</ul>
<p>Three buttons are highlighted in the above image. Below is a brief explanation for each.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/vfs-buttons-2.png" alt="https://assets.tryhackme.com/additional/velociraptor/vfs-buttons-2.png" />
    
  </figure>
</p>
<ol>
<li>Refresh the current directory (sync its listing from the client)</li>
<li>Recursively refresh this directory (sync its listing from the client)</li>
<li>Recursively download this directory from the client</li>
</ol>
<p>Let&rsquo;s continue interacting with VFS.</p>
<p>When
any folder is clicked  in the left pane, additional details are
displayed in the middle pane. For example, if the file folder is
clicked, a subfolder will appear, which is <strong>C:</strong>. Now the details in the middle pane change to reflect C:.</p>


<h1 class="relative group"><strong>Velociraptor Query Language</strong> 
    <div id="velociraptor-query-language" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#velociraptor-query-language" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Per the official <a href="https://docs.velociraptor.app/docs/overview/#vql---the-velociraptor-difference" target="_blank">documentation</a>, &ldquo;<em>Velociraptor’s
power and flexibility comes from the Velociraptor Query Language (VQL).
VQL is a framework for creating highly customized artifacts, which
allow you to collect, query, and monitor almost any aspect of an
endpoint, groups of endpoints, or an entire network. It can also be used
to create continuous monitoring rules on the endpoint, as well as
automate tasks on the server</em>&rdquo;.</p>
<p>With many tools that you will encounter in your SOC career, some tools may have their own query language. For example, in Splunk its SPL (<a href="https://docs.splunk.com/Splexicon:SPL#:~:text=abbreviation,functions%2C%20arguments%2C%20and%20clauses." target="_blank">Search Processing Language</a>), Elastic has KQL (<a href="https://www.elastic.co/guide/en/kibana/current/kuery-query.html" target="_blank">Kibana Query Language</a>), Microsoft Sentinel has KQL [too] (<a href="https://docs.microsoft.com/en-us/azure/sentinel/kusto-overview" target="_blank">Kusto Query Language</a>), etc.</p>
<p>VQL
is the meat and potatoes of Velociraptor. Throughout each task thus
far, unbeknownst to you, you have been interacting with VQL.</p>
<p>To jog your memory, navigate back to <strong>Collected</strong> and inspect <strong>Generic.Client.Info</strong>. Click the Requests tab in the bottom pane. See below image.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://assets.tryhackme.com/additional/velociraptor/vql-example.png" alt="https://assets.tryhackme.com/additional/velociraptor/vql-example.png" />
    
  </figure>
</p>
<p>If you are familiar with SQL (Structured Query Language) then you should notice the similarities, for example: <strong>SELECT</strong>, <strong>FROM</strong>, and <strong>WHERE</strong>.</p>
<p>To execute a simple VQL on your own, first create a <a href="https://docs.velociraptor.app/docs/vql/notebooks" target="_blank"><strong>Notebook</strong></a>.</p>
<p>Navigate to the Notebooks tab. In Velociraptor, Notebooks are <em>containers</em> that we can use to execute our queries and commands, as demonstrated below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/a107fe7d78711c90b9c31f5584e4c281.gif" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/a107fe7d78711c90b9c31f5584e4c281.gif" />
    
  </figure>
</p>
<p>Notebooks **consist of two languages - <a href="https://www.markdownguide.org/getting-started/" target="_blank"><strong>Markdown</strong></a> and (of course) <strong>VQL</strong>. If you are familiar with <a href="https://jupyter.org/" target="_blank">Jupyter Notebooks</a> they function in a very similar fashion!</p>
<p>Let&rsquo;s create our first notebook and enter some simple markdown. We&rsquo;ll circle back to VQL shortly.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/d2879fb5600bbe69f4b2d3e67e8de2ef.gif" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/d2879fb5600bbe69f4b2d3e67e8de2ef.gif" />
    
  </figure>
</p>
<p>Sweet! Now let&rsquo;s set our notebook to use VQL instead &amp; query basic information from the current agent, we can use <code>SELECT * FROM info()</code></p>
<p><strong>Note</strong>: Click into the lower box to display the options for this, then select the pencil to edit.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/f01b684ac748c4484a4949adfae0ba89.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/f01b684ac748c4484a4949adfae0ba89.png" />
    
  </figure>
</p>
<p>Let&rsquo;s save this notebook and run it against the agent as demonstrated below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/f12b007342f3041b129d70edd408c2bf.gif" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/f12b007342f3041b129d70edd408c2bf.gif" />
    
  </figure>
</p>
<p>VQL can also be run via the command line. See the example below.</p>
<p>For this example, VQL is run from the command line querying an agent for details such as its hostname.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/646326ad4c3925702619529657e3ee36.gif" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/646326ad4c3925702619529657e3ee36.gif" />
    
  </figure>
</p>


<h1 class="relative group">Artifacts 
    <div id="artifacts-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#artifacts-1" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Before wrapping up this task, let&rsquo;s touch on <strong>Artifacts</strong> (or VQL Modules).</p>
<p>Per the <a href="https://docs.velociraptor.app/docs/vql/artifacts/" target="_blank">documentation</a>, &ldquo;<em>Velociraptor allows packaging VQL queries inside mini-programs called Artifacts. An artifact is simply a structured YAML
file containing a query, with a name attached to it. This allows
Velociraptor users to search for the query by name or description and
simply run the query on the endpoint without necessarily needing to
understand or type the query into the UI</em>&rdquo;.</p>
<p>This was a <strong>BRIEF</strong> intro to VQL. It is recommended to review the official <a href="https://docs.velociraptor.app/docs/vql/" target="_blank">documentation</a> thoroughly to fully understand it and how you can wield its power to execute advanced queries. Also, reference the <a href="https://docs.velociraptor.app/vql_reference/" target="_blank">VQL Reference</a> and <a href="https://docs.velociraptor.app/docs/extending_vql/" target="_blank">Extending VQL</a> for further information on VQL.</p>
<p><strong>Forensic Analysis VQL Plugins</strong></p>


<h1 class="relative group"><strong>Forensic Analysis</strong> 
    <div id="forensic-analysis" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#forensic-analysis" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Per the <a href="https://docs.velociraptor.app/docs/forensic/" target="_blank">documentation</a>, &ldquo;<em>VQL is not useful without a good set of plugins that make DFIR
work possible. Velociraptor’s strength lies in the wide array of VQL
plugins and functions that are geared towards making DFIR investigations
and detections effective</em>&rdquo;.</p>
<p>There is a lot of
information to cover here regarding VQL plugins. This task aims to give
you enough information regarding these plugins so you can construct your
VQL query to hunt for artifacts of a popular exploit known as
Printnightmare.</p>
<p>At the date of the entry of this content, below are the categories surrounding forensic analysis:</p>
<ul>
<li><strong>Searching Filenames</strong></li>
<li><strong>Searching Content</strong></li>
<li><strong>NTFS Analysis</strong></li>
<li><strong>Binary Parsing</strong></li>
<li><strong>Evidence of Execution</strong></li>
<li><strong>Event Logs</strong></li>
<li><strong>Volatile Machine State</strong></li>
</ul>
<p>Have a skim through <strong>Searching Filenames</strong> and <strong>NTFS Analysis</strong> to provide a solid brain dump to prep you for the questions below and for the next task.</p>


<h3 class="relative group"><strong>THE HIVE PROJECT</strong> 
    <div id="the-hive-project" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-hive-project" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Introduction</p>
<p>TheHive Project is a
scalable, open-source and freely available Security Incident Response
Platform, designed to assist security analysts and practitioners working
in SOCs, CSIRTs and CERTs to track, investigate and act upon identified
security incidents in a swift and collaborative manner.</p>
<p>Security
Analysts can collaborate on investigations simultaneously, ensuring
real-time information pertaining to new or existing cases, tasks,
observables and IOCs are available to all team members.</p>
<p>More information about the project can be found on <a href="https://thehive-project.org/" target="_blank">https://thehive-project.org/</a> &amp; their <a href="https://github.com/TheHive-Project/TheHive" target="_blank">GitHub Repo</a>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/b249487ffe52d672accdfceb365462fa.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/b249487ffe52d672accdfceb365462fa.png" />
    
  </figure>
</p>
<p>Image: Cases dashboard on TheHive by order of reported severity</p>
<p>TheHive Project operates under the guide of three core functions:</p>
<ul>
<li><strong>Collaborate:</strong> Multiple analysts from one organisation can work together on the same case
simultaneously. Through its live stream capabilities, everyone can keep
an eye on the cases in real time.</li>
<li><strong>Elaborate:</strong>
Investigations correspond to cases. The details of each case can be
broken down into associated tasks, which can be created from scratch or
through a template engine. Additionally, analysts can record their
progress, attach artifacts of evidence and assign tasks effortlessly.</li>
<li><strong>Act:</strong> A quick triaging process can be supported by allowing analysts to add
observables to their cases, leveraging tags, flagging IOCs and
identifying previously seen observables to feed their threat
intelligence.</li>
</ul>
<p><strong>TheHive Features &amp; Integrations</strong></p>
<p>TheHive allows analysts
from one organisation to work together on the same case simultaneously.
This is due to the platform&rsquo;s rich feature set and integrations that
support analyst workflows. The features include:</p>
<ul>
<li><strong>Case/Task Management:</strong> Every investigation is meant to correspond to a case that has been created.
Each case can be broken down into one or more tasks for added
granularity and even be turned into templates for easier management.
Additionally, analysts can record their progress, attach pieces of
evidence or noteworthy files, add tags and other archives to cases.</li>
<li><strong>Alert Triage:</strong> Cases can be imported from SIEM alerts, email reports and other security
event sources. This feature allows an analyst to go through the imported alerts and decide whether or not they are to be escalated into
investigations or incident response.</li>
<li><strong>Observable Enrichment with Cortex:</strong> One of the main feature integrations TheHive supports is Cortex, an
observable analysis and active response engine. Cortex allows analysts
to collect more information from threat indicators by performing
correlation analysis and developing patterns from the cases. More
information on <a href="https://github.com/TheHive-Project/Cortex/" target="_blank">Cortex</a>.</li>
<li><strong>Active Response:</strong> TheHive allows analysts to use Responders and run active actions to
communicate, share information about incidents and prevent or contain a
threat.</li>
<li><strong>Custom Dashboards:</strong> Statistics on cases,
tasks, observables, metrics and more can be compiled and distributed on
dashboards that can be used to generate useful KPIs within an
organisation.</li>
<li><strong>Built-in MISP Integration:</strong> Another useful integration is with <a href="https://www.misp-project.org/index.html" target="_blank">MISP</a>, a threat intelligence platform for sharing, storing and correlating
Indicators of Compromise of targeted attacks and other threats. This
integration allows analysts to create cases from MISP events, import
IOCs or export their own identified indicators to their MISP
communities.</li>
</ul>
<p>Other notable integrations that TheHive supports are <a href="https://github.com/TheHive-Project/DigitalShadows2TH" target="_blank">DigitalShadows2TH</a> &amp; <a href="https://github.com/TheHive-Project/Zerofox2TH" target="_blank">ZeroFox2TH</a>, free and open-source extensions of alert feeders from <a href="https://www.digitalshadows.com/" target="_blank">DigitalShadows</a> and <a href="https://www.zerofox.com/" target="_blank">ZeroFox</a> respectively.
These integrations ensure that alerts can be added into TheHive and
transformed into new cases using pre-defined incident response templates
or by adding to existing cases</p>
<p><strong>User Profiles &amp; Permissions</strong></p>
<p>TheHive
offers an administrator the ability to create an organisation group to
identify the analysts and assign different roles based on a list of
pre-configured user profiles.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/853ee5298bfa5e60bf2fcf8d832268ff.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/853ee5298bfa5e60bf2fcf8d832268ff.png" />
    
  </figure>
</p>
<p>Admin Console -  Create Organisation</p>
<p>The pre-configured user profiles are:</p>
<ul>
<li><strong>admin:</strong> full administrative permissions on the platform; can&rsquo;t manage any Cases or other data related to investigations;</li>
<li><strong>org-admin:</strong> manage users and all organisation-level
configuration, can create and edit Cases, Tasks, Observables and run
Analysers and Responders;</li>
<li><strong>analyst:</strong> can create and edit Cases, Tasks, Observables and run Analysers &amp; Responders;</li>
<li><strong>read-only:</strong> Can only read, Cases, Tasks and Observables details;</li>
</ul>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/b38aa62d7e9b6ddb08a200987a2bb3df.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/b38aa62d7e9b6ddb08a200987a2bb3df.png" />
    
  </figure>
</p>
<p>Admin Console -  Add User</p>
<p>Each
user profile has a pre-defined list of permissions that would allow the
user to perform different tasks based on their role. When a profile has
been selected, its permissions will be listed.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/a0413ab7ab43bdb220919d7a48e4ddfe.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/a0413ab7ab43bdb220919d7a48e4ddfe.png" />
    
  </figure>
</p>
<p>The full list of permissions includes:</p>
<table>
  <thead>
      <tr>
          <th><strong>Permission</strong></th>
          <th><strong>Functions</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>manageOrganisation (1)</strong></td>
          <td>Create &amp; Update an organisation</td>
      </tr>
      <tr>
          <td><strong>manageConfig (1)</strong></td>
          <td>Update Configuration</td>
      </tr>
      <tr>
          <td><strong>manageProfile (1)</strong></td>
          <td>Create, update &amp; delete Profiles</td>
      </tr>
      <tr>
          <td><strong>manageTag (1)</strong></td>
          <td>Create, update &amp; Delete Tags</td>
      </tr>
      <tr>
          <td><strong>manageCustomField (1)</strong></td>
          <td>Create, update &amp; delete Custom Fields</td>
      </tr>
      <tr>
          <td><strong>manageCase</strong></td>
          <td>Create, update &amp; delete Cases</td>
      </tr>
      <tr>
          <td><strong>manageObservable</strong></td>
          <td>Create, update &amp; delete Observables</td>
      </tr>
      <tr>
          <td><strong>manageALert</strong></td>
          <td>Create, update &amp; import Alerts</td>
      </tr>
      <tr>
          <td><strong>manageUser</strong></td>
          <td>Create, update &amp; delete Users</td>
      </tr>
      <tr>
          <td><strong>manageCaseTemplate</strong></td>
          <td>Create, update &amp; delete Case templates</td>
      </tr>
      <tr>
          <td><strong>manageTask</strong></td>
          <td>Create, update &amp; delete Tasks</td>
      </tr>
      <tr>
          <td><strong>manageShare</strong></td>
          <td>Share case, task &amp; observable with other organisations</td>
      </tr>
      <tr>
          <td><strong>manageAnalyse (2)</strong></td>
          <td>Execute Analyse</td>
      </tr>
      <tr>
          <td><strong>manageAction (2)</strong></td>
          <td>Execute Actions</td>
      </tr>
      <tr>
          <td><strong>manageAnalyserTemplate (2)</strong></td>
          <td>Create, update &amp; delete Analyser Templates</td>
      </tr>
  </tbody>
</table>
<p><em>Note
that (1) Organisations, configuration, profiles and tags are global
objects. The related permissions are effective only on the “admin”
organisation. (2) Actions, analysis and template are available only if
the Cortex connector is enabled.</em></p>
<p>In addition to adding new user profiles, the admin can also
perform other operations such as creating case custom fields, custom
observable types, custom analyser templates and importing TTPs from the
MITRE ATT&amp;CK framework, as displayed in the image below.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/23c56b240bbeabf412e2bb69651e9a52.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/23c56b240bbeabf412e2bb69651e9a52.png" />
    
  </figure>
</p>
<p>Imported list of ATT&amp;CK Patterns</p>
<p><strong>Analyst Interface Navigation</strong></p>
<p><strong>SCENARIO</strong></p>
<p>You
have captured network traffic on your network after suspicion of data
exfiltration being done on the network. This traffic corresponds to FTP
connections that were established. Your task is to analyse the traffic
and create a case on TheHive to facilitate the progress of an
investigation. If you are unfamiliar with using Wireshark, please check
out <a href="https://tryhackme.com/room/wireshark" target="_blank">this room</a> first and come back to complete this task.</p>
<p><em>Source of PCAP file: IntroSecCon CTF 2020</em></p>
<p>Once
an analyst has logged in to the dashboard, they will be greeted with
the screen below. At the top, various menu options are listed that allow
the user to create new cases and see their tasks and alerts. A list of
active cases will be populated on the centre console when analysts
create them.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/9b044f28a831732ff79c94109e84baf0.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/9b044f28a831732ff79c94109e84baf0.png" />
    
  </figure>
</p>
<p>Image: TheHive Main Landing Page</p>
<p>On clicking the <code>New Case</code>
tab, a pop-up window opens, providing the analyst with fields to input
their case details and tasks. The following options must be indicated on
the case to set different categories and filter options:</p>
<ul>
<li><strong><em>Severity</em>:</strong> This showcases the level of impact the incident being investigated has on the environment from low to critical levels.</li>
<li><strong><em>TLP</em>:</strong> The Traffic Light Protocol is a set of designations to ensure that
sensitive information is shared with the appropriate audience. The range of colours represents a scale between full disclosure of information (<em>White</em>) and No disclosure/ Restricted (<em>Red</em>). You can find more information about the definitions on the <a href="https://www.cisa.gov/tlp" target="_blank">CISA</a> website.</li>
<li><strong><em>PAP</em>:</strong> The Permissible Actions Protocol is used to indicate what an analyst
can do with the information, whether an attacker can detect the current
analysis state or defensive actions in place. It uses a colour scheme
similar to TLP and is part of the <a href="https://www.misp-project.org/taxonomies.html#_pap" target="_blank">MISP taxonomies</a>.</li>
</ul>
<p>With
this in mind, we open a new case and fill in the details of our
investigation, as seen below. Additionally, we add a few tasks to the
case that would guide the investigation of the event.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/15ff110d1a816ca7ff517ee63288783b.gif" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/15ff110d1a816ca7ff517ee63288783b.gif" />
    
  </figure>
</p>
<p>New Case Window</p>
<p>In the visual below, we add the corresponding tactic and technique associated with the case. The TTPs are imported from <a href="https://attack.mitre.org/tactics/enterprise/" target="_blank">MITRE ATT&amp;CK</a>. This provides additional
information that can be helpful to map out the threat. As this is an
exfiltration investigation, that is the specific tactic chosen and
followed by the specific T1048.003 technique for Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/f390eb83345ba7e4d5582ae8038ef2c1.gif" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/f390eb83345ba7e4d5582ae8038ef2c1.gif" />
    
  </figure>
</p>
<p>TTPs Selection Window</p>
<p>Case observables will be added from the Observables tab and you would have to indicate the following details:</p>
<table>
  <thead>
      <tr>
          <th><strong>Field</strong></th>
          <th><strong>Description</strong></th>
          <th><strong>Examples</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>*Type <em>:</em></td>
          <td>The observable dataType</td>
          <td>IP address, Hash, Domain</td>
      </tr>
      <tr>
          <td>*Value <em>:</em></td>
          <td>Your observable value</td>
          <td>8.8.8.8, 127.0.0.1</td>
      </tr>
      <tr>
          <td><em>One observable per line:</em></td>
          <td>Create one observable per line inserted in the value field.</td>
          <td></td>
      </tr>
      <tr>
          <td><em>One single multiline observable:</em></td>
          <td>Create one observable, no matter the number of lines</td>
          <td>Long URLs</td>
      </tr>
      <tr>
          <td>*TLP <em>:</em></td>
          <td>Define here the way the information should be shared.</td>
          <td></td>
      </tr>
      <tr>
          <td><em>Is IOC:</em></td>
          <td>Check if this observable is considered an Indicator of Compromise</td>
          <td>Emotet IP</td>
      </tr>
      <tr>
          <td><em>Has been sighted:</em></td>
          <td>Has this observable been sighted on your information system?</td>
          <td></td>
      </tr>
      <tr>
          <td><em>Ignore for similarity:</em></td>
          <td>Do not correlate this observable with other similar observables.</td>
          <td></td>
      </tr>
      <tr>
          <td>*Tags *<em>:</em></td>
          <td>Insightful information Tags.</td>
          <td>Malware IP; MITRE Tactics</td>
      </tr>
      <tr>
          <td>*Description *<em>:</em></td>
          <td>Description of the observable</td>
          <td></td>
      </tr>
  </tbody>
</table>
<p>In
our scenario, we are adding the IP address 192&hellip; as our observable as
this IP is the source of the FTP requests. Depending on the situation of
your analysis, this observable can be marked as an IOC or if it has
been sighted before in a different investigation.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/d3e3e6f85aa9169aa78104beebc79b8e.gif" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/5fc2847e1bbebc03aa89fbf2/room-content/d3e3e6f85aa9169aa78104beebc79b8e.gif" />
    
  </figure>
</p>
<p>New Observables Window</p>


<h3 class="relative group"><strong>MALWARE ANALYSIS</strong> 
    <div id="malware-analysis" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#malware-analysis" aria-label="Anchor">#</a>
    </span>        
    
</h3>


<h2 class="relative group">Malware 
    <div id="malware" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#malware" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>The word malware is derived from the term MALicious softWARE.
Therefore, any software that has a malicious purpose can be considered
malware. Malware is further classified into different categories based
on its behavior. However, we will not go into the details of those in
this room. Here we will ponder the steps we will take if we suspect that
we found malware in a machine. So, let&rsquo;s get started.</p>


<h2 class="relative group">The purpose behind Malware Analysis 
    <div id="the-purpose-behind-malware-analysis" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-purpose-behind-malware-analysis" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Malware Analysis is an important skill to have. As a quick overview,
Malware Analysis is performed by the following people in the Security
Industry:</p>
<ul>
<li><strong>Security Operations</strong> teams analyze malware to write detections for malicious activity in their networks.</li>
<li><strong>Incident Response</strong> teams analyze malware to determine what damage has been done to an environment to remediate and revert that damage.</li>
<li><strong>Threat Hunt</strong> teams analyze malware to identify IOCs, which they use to hunt for malware in a network.</li>
<li><strong>Malware Researchers</strong> in security product vendor teams analyze malware to add detections for them in their security products.</li>
<li><strong>Threat Research</strong> teams in OS Vendors like Microsoft and Google analyze malware to
discover the vulnerabilities exploited and add more security features to the OS/applications.</li>
</ul>
<p>Overall, it seems like many different people do malware Analysis for many compelling reasons. So let&rsquo;s see how to start!</p>


<h2 class="relative group">Before we begin! 
    <div id="before-we-begin" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#before-we-begin" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/07dbfda63ff296b6732c4533145d4eb8.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/07dbfda63ff296b6732c4533145d4eb8.png" />
    
  </figure>
</p>
<p>Please note that malware is like a weapon because it can produce
great harm if not handled with care. For this reason, always take the
following precautions while analyzing malware:</p>
<ul>
<li>Never analyze malware or suspected malware on a machine that does not have the sole purpose of analyzing malware.</li>
<li>When not analyzing or moving malware samples around to different locations,
always keep them in password-protected zip/rar or other archives so that we can avoid accidental detonation.</li>
<li>Only extract the malware from this password-protected archive inside the isolated environment, and only when analyzing it.</li>
<li>Create an isolated VM specifically for malware analysis, which has the
capability of being reverted to a clean slate once you are done.</li>
<li>Ensure that all internet connections are closed or at least monitored.</li>
<li>Once you are done with malware analysis, revert the VM to its clean slate
for the next malware analysis session to avoid residue from a previous
malware execution corrupting the next one.</li>
</ul>
<p><strong>Techniques of malware analysis</strong></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/34dab1a51b037a8d4306b7485e575c2b.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/34dab1a51b037a8d4306b7485e575c2b.png" />
    
  </figure>
</p>
<p>Malware
Analysis is like solving a puzzle. Different tools and techniques are
used to find the pieces of this puzzle, and joining those pieces gives
us the complete picture of what the malware is trying o do. Most of the
time, you will have an executable file (also called a binary or a PE
file. PE stands for Portable Executable), a malicious document file, or a
Network Packet Capture (Pcap). The Portable Executable is the most
prevalent type of file analyzed while performing Malware Analysis.</p>
<p>To find the different puzzle pieces, you will often use various tools,
tricks, and shortcuts. These techniques can be grouped into the
following two categories:</p>
<ul>
<li>Static Analysis</li>
<li>Dynamic Analysis</li>
</ul>


<h2 class="relative group">Static Analysis 
    <div id="static-analysis" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#static-analysis" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/be58bfb0a97f8987f8dc36f5d40a8ba7.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/be58bfb0a97f8987f8dc36f5d40a8ba7.png" />
    
  </figure>
</p>
<p>When malware is analyzed without being executed, it is called Static
Analysis. In this case, the different properties of the PE file are
analyzed without running it. Similarly, in the case of a malicious
document, exploring the document&rsquo;s properties without analyzing it will
be considered Static Analysis. Examples of static analysis include
checking for strings in malware, checking the PE header for information
related to different sections, or looking at the code using a
disassemble. We will look at some of these techniques later in the room.</p>
<p>Malware often uses techniques to avoid static analysis. Some of these
techniques use obfuscation, packing, or other means of hiding its
properties. To circumvent these techniques, we often use dynamic
analysis.</p>


<h2 class="relative group">Dynamic Analysis 
    <div id="dynamic-analysis" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#dynamic-analysis" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Malware faces a dilemma. It has to execute to fulfill its purpose,
and no matter how much obfuscation is added to the code, it becomes an
easy target for detection once it runs.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/83824aaebb362a7b528f7587af2f5295.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/83824aaebb362a7b528f7587af2f5295.png" />
    
  </figure>
</p>
<p>Static
analysis might provide us with crucial information regarding malware,
but sometimes that is not enough. We might need to run the malware in a
controlled environment to observe what it does in these cases. Malware
can often hide its properties to thwart Static Analysis. However, in
most of those cases, Dynamic Analysis can prove fruitful. Dynamic
analysis techniques include running the malware in a VM, either in a
manual fashion with tools installed to monitor the malware&rsquo;s activity or
in the form of sandboxes that perform this task automatically. We will
learn about some of these techniques later in this room. Once we run the
malware in a controlled environment, we can use our knowledge from the
Windows Forensics rooms to identify what it did in our environment. The
advantage here is that since we control the environment, we can
configure it to avoid noise, like activity from a legitimate user or
Windows Services. Thus, everything we observe in such an environment
points to malware activity, making it easier to identify what the
malware did in this scenario.</p>
<p>Malware, however, often uses techniques to prevent an analyst from
performing dynamic analysis. Since most dynamic analysis is performed in
a controlled environment, most methods to bypass dynamic analysis
include detecting the environment in which it is being run. Therefore,
in these cases, the malware uses a different, benign code path if it
identifies that it is being run in a controlled environment.</p>


<h2 class="relative group">Advanced Malware Analysis 
    <div id="advanced-malware-analysis" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#advanced-malware-analysis" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Advanced malware analysis techniques are used to analyze malware that
evades basic static and dynamic analysis. For performing advanced
malware analysis, disassemblers and debuggers are used. Disassemblers
convert the malware&rsquo;s code from binary to assembly so that an analyst
can look at the instructions of the malware statically. Debuggers attach
to a program and allow the analyst to monitor the instructions in
malware while it is running. A debugger allows the analyst to stop and
run the malware at different points to identify interesting pieces of
information while also providing an overview of the memory and CPU of
the system. We will not cover advanced malware a</p>
<p><strong>Basic Static Analysis</strong></p>
<p>When analyzing a new
piece of malware, the first step is usually performing basic static
analysis. Basic static analysis can be considered sizing up the malware,
trying to find its properties before diving deep into analysis. It
provides us with an overview of what we are dealing with. Sometimes it
might give us some critical information, for example, what API
calls the malware is making or whether it&rsquo;s packed or not. However,
other times, it might only give us information to help us size the
malware up and give us an idea of the effort required to analyze it.</p>
<p>So without further ado, let&rsquo;s see some of the techniques we can use to perform basic static analysis.</p>


<h2 class="relative group">Caution! 
    <div id="caution" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#caution" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Although static analysis is performed without running the malware, it
is highly recommended that you perform malware analysis in an isolated
Virtual Machine. You can create a clean snapshot of your Virtual Machine
before performing any malware analysis and revert it to start from a
clean state again after every analysis. Don&rsquo;t perform malware analysis
on a live machine not purpose-built for malware analysis. For this room,
we will be using the attached <a href="https://docs.remnux.org/" target="_blank">Remnux VM</a>. Remnux (<strong>R</strong>everse <strong>E</strong>ngineering <strong>M</strong>alware Li<strong>nux</strong>) is a Linux distribution purpose-built for malware analysis. It has many tools required for malware analysis already installed on it.</p>


<h2 class="relative group">Examining the file type 
    <div id="examining-the-file-type" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#examining-the-file-type" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Though often the file type of malware is visible in the file
extension and is obvious, sometimes malware authors try to trick users
by using misleading file extensions. In such scenarios, it is helpful to
know how to find the actual file type of a file without depending on
file extensions. In Linux, we can find the file type of a file using the <code>file</code> command. To understand what the file command does, we can read its <code>man page</code> or use the <code>--help</code> option:</p>
<p><code>man file</code> or <code>file --help</code></p>
<p>We will find out that it is a simple command to use. We can use the following command to find the file type of a file:</p>
<p><code>file &lt;filename&gt;</code></p>
<p>Remnux</p>
<pre tabindex="0"><code class="language-markup" data-lang="markup">user@machine$ file wannacry
wannacry: PE32 executable (GUI) Intel 80386, for MS Windows
user@machine$
</code></pre><p>There is a folder named <code>Samples</code> on the Desktop in the attached VM. We will be using the samples present in that folder for our analysis. The above terminal shows the <code>file</code>
command being run on the &lsquo;wannacry&rsquo; sample. The output shows a PE32
executable file with a Graphical User Interface, which was compiled for a
system that runs Microsoft Windows with an Intel 80386-based processor.
The Intel 80386 processor was one of the first 32-bit processors ever,
and the instruction set designed for the 80386 is still used for 32-bit
Intel processors, which is why you see &ldquo;x86&rdquo; processors and code. This
means that the &ldquo;80386&rdquo; in the output above tells us that this
application was designed for 32-bit Intel processors.</p>


<h2 class="relative group">Examining Strings 
    <div id="examining-strings" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#examining-strings" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Another really important command that provides us with useful information about a file is the <code>strings</code> command. This command lists down the strings present in a file. To understand what the string command does, we can read its <code>man page</code> or use the <code>--help</code> option:</p>
<p><code>man strings</code> or <code>strings --help</code></p>
<p>We will find that it is also a simple command to use. We can use the following command to find the strings in a file:</p>
<p><code>strings &lt;filename&gt;</code></p>
<p>Looking at strings in a file can often give clues related to
the behavior of malware. For example, if we see URLDownloadToFile in the
output of the strings command, we will know that this malware is doing
something with the URLDownloadToFile Windows API.
Most likely, it is downloading a file from the internet and saving it
on the disk. Similarly, strings might also provide contextual
information that helps us later during malware analysis.</p>
<p>Remnux</p>
<pre tabindex="0"><code class="language-markup" data-lang="markup">user@machine$ strings wannacry
!This program cannot be run in DOS mode.
Rich
.text
`.rdata
@.data
.rsrc
49t$
TVWj
PVVh
tE9u
.
.
.
.
 inflate 1.1.3 Copyright 1995-1998 Mark Adler
 n;^
Qkkbal
i]Wb
9a&amp;g
MGiI
wn&gt;Jj
#.zf
+o*7
- unzip 0.15 Copyright 1998 Gilles Vollant
CloseHandle
GetExitCodeProcess
TerminateProcess
WaitForSingleObject
CreateProcessA
GlobalFree
GetProcAddress
LoadLibraryA
GlobalAlloc
SetCurrentDirectoryA
GetCurrentDirectoryA
GetComputerNameW
SetFileTime
SetFilePointer
MultiByteToWideChar
GetFileAttributesW
GetFileSizeEx
.
.
.
.
user@machine$
</code></pre><p>Here we can see the <code>strings</code> command being run against the &lsquo;wannacry&rsquo; sample. We will see that the output starts with the <code>DOS Stub</code>, which is the text that says <code>!This program cannot be run in DOS mode</code>.
Some values don&rsquo;t make much sense and look like garbage, but you will
also see useful output. For example, we can see above that some strings
look like Windows APIs. For example, <code>CloseHandle</code>, <code>GetExitCodeProcess</code>, <code>TerminateProcess</code>, and so on. Similarly, we can see text that says <code>inflate 1.1.3 Copyright 1995-1998 Mark Adler</code>. A quick search shows that it is a part of the <a href="http://zlib.net/" target="_blank">zlib data compression</a> library, this tells us that the sample might be using this library.</p>
<p><strong>Tip:</strong> Sometimes, the output of the strings command is too big
to be shown on the terminal completely. We can redirect it, write it to a
file, and read it using vim or any other tool. The below terminal shows
the output being redirected to a file named str:</p>
<p>Remnux</p>
<pre tabindex="0"><code class="language-markup" data-lang="markup">user@machine$ strings wannacry&gt;str
user@machine$
</code></pre><p>Alternatively, you can use the <code>more</code> or <code>less</code> command to parse the output in a more visible manner:</p>
<p>Remnux</p>
<pre tabindex="0"><code class="language-markup" data-lang="markup">user@machine$ strings wannacry |more
!This program cannot be run in DOS mode.
Rich
.text
`.rdata
@.data
.rsrc
49t$
TVWj
PVVh
tE9u
PVVW
SVWjcf
X_^[
X_^[
^t19
QPPh
tXVP
X_^]
^t)9
X_^[]
WWWWWPj
SjJ3
X[_^
Yu#j
uSh8
Yu8S
SSh
hn!@
SVWj@
--more--
</code></pre><p>We can use the space key to scroll down the list of strings here. If you are interested, <a href="https://tryhackme.com/room/malstrings" target="_blank">this room</a> contains more information about strings.</p>


<h2 class="relative group">Calculating Hashes 
    <div id="calculating-hashes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#calculating-hashes" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>File Hashing provides us with a fixed-size unique number that
identifies a file. A File Hash can therefore be considered a unique
identifier for a file, similar to Social Security Numbers or National
Identification Numbers used for the citizens of a country. Hashing is an
important concept in malware analysis. It can be used as an identifier
for specific malware. As we will see later in this task, this identifier
can then be shared with other analysts or searched online for
information sharing purposes. Please note that a single bit of
difference in two files will result in different hashes, so changing the
hash of a file is as simple as changing one bit in it.</p>
<p>Commonly, <code>md5sum</code>, <code>sha1sum</code> and <code>sha256sum</code> hashes are used for file hashing. We can calculate file hashes by using a simple command in Linux, as shown below for the md5sum hash:</p>
<p><code>md5sum &lt;filename&gt;</code></p>
<p>Remnux</p>
<pre tabindex="0"><code>user@machine$ md5sum wannacry
84c82835a5d21bbcf75a61706d8ab549  wannacry
user@machine$
</code></pre><p>Above, we can see the md5sum hash is calculated for the file named &lsquo;wannacry.&rsquo;</p>
<p>Similarly, <code>sha1sum</code> and <code>sha256sum</code> commands can be used for calculating <code>sha1sum</code> or <code>sha256sum</code> of a file (Hashes are often referred to without the <code>sum</code> at the end, e.g. <code>md5</code> instead of <code>md5sum</code> and so on.)</p>
<p>If you are interested in learning more about hashes, you can check out <a href="https://tryhackme.com/room/malresearching" target="_blank">this room</a>.</p>


<h2 class="relative group">AV scans and VirusTotal 
    <div id="av-scans-and-virustotal" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#av-scans-and-virustotal" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Scanning a file using AVs or searching for a hash on <a href="https://www.virustotal.com/gui/home/upload" target="_blank">VirusTotal</a>
can also provide useful information about the classification of malware
performed by security researchers. However, when using an online
scanner, it is recommended to search for the malware&rsquo;s hash instead of
uploading online to avoid leaking sensitive information online. Only
upload a sample if you are sure of what you are doing.</p>
<p>Let&rsquo;s see
what it says about the sample we calculated the hash for above. We can
search for the md5sum we calculated for the wannacry sample on the
VirusTotal homepage:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/4fa91c3c465940314f55bce4427a6a4a.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/4fa91c3c465940314f55bce4427a6a4a.png" />
    
  </figure>
</p>
<p>VirusTotal has a mix of handy features. It provides scan results from 60+ AV vendors and each AV vendor&rsquo;s classification to the sample.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/60903062574c8a2c9083100f096465b6.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/60903062574c8a2c9083100f096465b6.png" />
    
  </figure>
</p>
<p>The details tab lists the history of the sample, the first submission, the last submission, and the metadata of the sample.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/88d7d3ed42be6f54b17a863fd8c9d308.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/88d7d3ed42be6f54b17a863fd8c9d308.png" />
    
  </figure>
</p>
<p>Sometimes
it also provides information about the behavior of a sample and its
relations as seen in different environments online.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/83c4544bf2865f4561b74645b1856793.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/83c4544bf2865f4561b74645b1856793.png" />
    
  </figure>
</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/99f474d91d736cf063978fbeb82dfd9c.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/99f474d91d736cf063978fbeb82dfd9c.png" />
    
  </figure>
</p>
<p>We
can also find comments about the sample by the community on VirusTotal,
which can sometimes provide additional context about the sample.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/d35a057fa8b2394174a1e4c6d12a6992.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/d35a057fa8b2394174a1e4c6d12a6992.png" />
    
  </figure>
</p>
<p>Perhaps it is very clear from the above screenshots that we are looking at a sample of wannacry ransomware.</p>
<p><strong>The PE file Header</strong></p>


<h2 class="relative group">PE Header 
    <div id="pe-header" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#pe-header" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/180bb73415dd511f9399ce6cfff9db9a.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/180bb73415dd511f9399ce6cfff9db9a.png" />
    
  </figure>
</p>
<p>The PE
File Header contains the metadata about a Portable Executable file.
This data can help us find a lot of helpful information to help us in
our analysis. We will go into detail about the PE header and the
information it contains in the upcoming Malware Analysis module for the
advanced path. However, some of the vital information found in the PE
header is explained below:</p>


<h3 class="relative group">Imports/Exports 
    <div id="importsexports" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#importsexports" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>A PE
file seldom contains all the code that it needs to run on a system on
its own. Most of the time, it re-uses code provided by the Operating
System. This is done to use less space and leverage the framework the
Operating System has laid to perform tasks instead of re-inventing the
wheel. Imports are such functions that the PE file imports from outside
to perform different tasks.</p>
<p>For example, if a developer wants to Query a Windows Registry value, they will import the <a href="https://docs.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regqueryvaluew" target="_blank">RegQueryValue</a>
function provided by Microsoft instead of writing the code themselves.
It is understood that this function will be present on any Windows
machine on which the developer&rsquo;s code is going to run, so it does not
need to be included in the PE
file itself. Similarly, any PE file export functions are exposed to
other binaries that can use that function instead of implementing it
themselves. Exports are generally associated with Dynamically-Linked
libraries (DLL files), and it is not typical for a non-DLL PE file to
have a lot of exports.</p>
<p>Since most PE
files use the Windows API to perform the bulk of their jobs, a PE
file&rsquo;s imports provide us with crucial information on what that PE file
will do. It becomes evident that a PE file that is importing the
InternetOpen function will communicate with the internet, a
URLDownloadToFile function shows that a PE file will download something
from the internet, and so on. Names of Windows APIs are generally
intuitive and self-explanatory. However, we can always consult <a href="https://docs.microsoft.com/en-us/windows/win32/api/_winprog/" target="_blank">Microsoft Documentation</a> to verify the purpose of a particular Windows function.</p>


<h3 class="relative group">Sections: 
    <div id="sections" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#sections" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Another useful piece of information available in the PE
file header is the information about sections in the PE file. A PE file
is divided into different sections which have different purposes.
Although the sections in a PE file depend on the compiler or packer used
to compile or pack the binary, the following are the most commonly seen
sections in a PE file.</p>
<ul>
<li>.<strong>text:</strong> This Section generally contains the CPU instructions executed when the PE file is run. This section is marked as executable.</li>
<li><strong>.data:</strong> This Section contains the global variables and other global data used by the PE file.</li>
<li><strong>.rsrc:</strong> This Section contains resources that are used by the PE file, for example, images, icons, etc.</li>
</ul>


<h2 class="relative group">Analyzing PE header using pecheck utility 
    <div id="analyzing-pe-header-using-pecheck-utility" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#analyzing-pe-header-using-pecheck-utility" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>We can use the pecheck utility present in the Remnux VM attached with the room to check the PE header.</p>
<p>Remnux</p>
<pre tabindex="0"><code>user@machine$ pecheck wannacryPE check for &#39;wannacry&#39;:
Entropy: 7.995471 (Min=0.0, Max=8.0)
MD5     hash: 84c82835a5d21bbcf75a61706d8ab549
SHA-1   hash: 5ff465afaabcbf0150d1a3ab2c2e74f3a4426467
SHA-256 hash: ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa
SHA-512 hash: 90723a50c20ba3643d625595fd6be8dcf88d70ff7f4b4719a88f055d5b3149a4231018ea30d375171507a147e59f73478c0c27948590794554d031e7d54b7244
.text entropy: 6.404235 (Min=0.0, Max=8.0)
.rdata entropy: 6.663571 (Min=0.0, Max=8.0)
.data entropy: 4.455750 (Min=0.0, Max=8.0)
.rsrc entropy: 7.999868 (Min=0.0, Max=8.0)
Dump Info:
----------DOS_HEADER----------

[IMAGE_DOS_HEADER]
0x0        0x0   e_magic:                       0x5A4D
0x2        0x2   e_cblp:                        0x90
0x4        0x4   e_cp:                          0x3
.
.
.
.
.
[IMAGE_IMPORT_DESCRIPTOR]
0xD5D0     0x0   OriginalFirstThunk:            0xD60C
0xD5D0     0x0   Characteristics:               0xD60C
0xD5D4     0x4   TimeDateStamp:                 0x0        [Thu Jan  1 00:00:00 1970 UTC]
0xD5D8     0x8   ForwarderChain:                0x0
0xD5DC     0xC   Name:                          0xDC84
0xD5E0     0x10  FirstThunk:                    0x8000

ADVAPI32.dll.CreateServiceA Hint[100]
ADVAPI32.dll.OpenServiceA Hint[431]
ADVAPI32.dll.StartServiceA Hint[585]
ADVAPI32.dll.CloseServiceHandle Hint[62]
ADVAPI32.dll.CryptReleaseContext Hint[160]
ADVAPI32.dll.RegCreateKeyW Hint[467]
ADVAPI32.dll.RegSetValueExA Hint[516]
ADVAPI32.dll.RegQueryValueExA Hint[503]
ADVAPI32.dll.RegCloseKey Hint[459]
ADVAPI32.dll.OpenSCManagerA Hint[429]
.
.
.
.
.
.
</code></pre><p>Here we can see information pecheck has extracted from the PE
header of the wannacry sample. We see that the sample has 4 sections,
.text, .rdata, .data and .rsrc and their respective entropy. Similarly,
it has also shown us the different hashes of the sample. Pecheck also
shows us the functions that a PE file imports. In the above terminal
window, we can see the IMAGE_IMPORT_DESCRIPTOR, which shows the
functions it imports from the ADVAPI32.dll Linked library. We will see
similar descriptors for all the other linked libraries whose functions
are imported by the sample.</p>
<p>We can see that pecheck shows
us a lot more information than what we discussed in this task; however,
discussing all that information is out of the scope of this room. We
will dive into further details in the upcoming malware analysis module.
We will take what we are looking for from the information we see,
namely, the section information and the imports of our samples.</p>
<p><strong>Basic Dynamic Analysis</strong></p>
<p>While basic static
analysis provides us with useful information about a sample, most times,
we need to perform additional analysis to move further in our analysis
procedure. One quick and dirty way to find more clues about a malware&rsquo;s
behavior is by performing basic dynamic analysis. Many of the properties
of a malware sample can be hidden when it&rsquo;s not running. However, when
we perform dynamic analysis, we can lay these properties bare and learn
more about the behavior of a malware sample.</p>


<h2 class="relative group">Caution! 
    <div id="caution-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#caution-1" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Dynamic
analysis requires running live malware samples that can be destructive.
It is highly recommended that you perform malware analysis in an
isolated Virtual Machine. You can create a clean snapshot of your
Virtual Machine before performing any malware analysis and revert it to
start from a clean state again after every analysis. Don&rsquo;t perform
malware analysis on a live machine not purpose-built for malware
analysis.</p>


<h2 class="relative group">Introduction to Sandboxes 
    <div id="introduction-to-sandboxes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#introduction-to-sandboxes" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/7c03de48312f00f8a4fa904f9666668e.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/7c03de48312f00f8a4fa904f9666668e.png" />
    
  </figure>
</p>
<p>Sandbox is a term borrowed from the military. A sandbox is a box of
sand, as the name suggests, modeling the terrain where an operation has
to take place, in which a military team dry runs their scenarios to
identify possible outcomes. In malware analysis, a sandbox is an
isolated environment mimicking the actual target environment of a
malware, where an analyst runs a sample to learn more about it. Malware
analysis sandboxes heavily rely on Virtual Machines, their ability to
take snapshots and revert to a clean state when required.</p>


<h2 class="relative group">Construction of a sandbox 
    <div id="construction-of-a-sandbox" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#construction-of-a-sandbox" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>For malware analysis using sandboxes, the following considerations make the malware analysis effective:</p>
<ul>
<li>Virtual Machine mimicking the actual target environment of the malware sample</li>
<li>Ability to take snapshots and revert to clean state</li>
<li>OS monitoring software, for example, Procmon, ProcExplorer or Regshot, etc.</li>
<li>Network monitoring software, for example, Wireshark, tcpdump, etc.</li>
<li>Control over the network through a dummy DNS server and webserver.</li>
<li>A mechanism to move analysis logs and malware samples in and out of the
Virtual Machine without compromising the host (Be careful with this one. If you have a shared directory with your malware analysis VM that remains accessible when running malware, you might risk malware affecting all files in your shared directory)</li>
</ul>


<h2 class="relative group">Open Source Sandboxes 
    <div id="open-source-sandboxes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#open-source-sandboxes" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Though it is good to understand what a good sandbox is made of,
building a sandbox from scratch is not always necessary. One can always
set up Open Source Sandboxes. These sandboxes provide the framework for
performing basic dynamic analysis and are also customizable to a
significant extent to help those with a more adventurous mindset.</p>


<h3 class="relative group">Cuckoo&rsquo;s Sandbox 
    <div id="cuckoos-sandbox" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#cuckoos-sandbox" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><a href="https://cuckoosandbox.org/" target="_blank">Cuckoo&rsquo;s sandbox</a>
is the most widely known sandbox in the malware analysis community. It
was developed as part of a Google Summer of Code project in 2010. It is
an open-source project that you will often see deployed in SOC
environments and with enthusiasts&rsquo; home labs. Advantages of Cuckoo&rsquo;s
sandbox include huge community support, easy-to-understand
documentation, and lots of customizations. You can deploy it on your
network and let the community signatures guide you into identifying
which files are malicious and which are benign because of the vast
corpus of community signatures that come with it.</p>
<p>Cuckoo&rsquo;s
sandbox has been archived, and an update is pending. It also doesn&rsquo;t
support Python 3, making it obsolete right now. However, all is not lost
because we have alternatives.</p>


<h3 class="relative group">CAPE Sandbox 
    <div id="cape-sandbox" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#cape-sandbox" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><a href="https://github.com/kevoreilly/CAPEv2" target="_blank">CAPE Sandbox</a>
is a little more advanced version of Cuckoo&rsquo;s sandbox. It supports
debugging and memory dumping to support the unpacking of packed malware
(We will learn more about packing and unpacking in the advanced malware
analysis module). Though beginners can use this sandbox, advanced
knowledge is required for making full use of it. A community version of
this sandbox is available online, which can be used to test run it
before installing. CAPE Sandbox is so far actively developed and
supports Python 3.</p>


<h2 class="relative group">Online Sandboxes: 
    <div id="online-sandboxes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#online-sandboxes" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Setting up and maintaining a sandbox can be
a time-consuming task. Keeping that in view, online sandboxes can be of
great help. Some of the most commonly used online sandboxes are as
follows:</p>
<ul>
<li><a href="https://cuckoo.cert.ee/" target="_blank">Online Cuckoo Sandbox</a></li>
<li><a href="https://www.capesandbox.com/" target="_blank">Online CAPE Sandbox</a></li>
<li><a href="https://any.run/" target="_blank">Any.run</a></li>
<li><a href="https://analyze.intezer.com/" target="_blank">Intezer</a></li>
<li><a href="https://hybrid-analysis.com/" target="_blank">Hybrid Analysis</a></li>
</ul>
<p>Though
online sandboxes provide a useful utility, it is best not to submit a
sample online unless you are sure of what you are doing. A better
approach is to search for the sample&rsquo;s hash on the service you are using
to see if someone has already submitted it. Let&rsquo;s look at Hybrid
Analysis to see what interesting analysis it provides for our sample.</p>


<h3 class="relative group">Analyzing samples using Hybrid Analysis 
    <div id="analyzing-samples-using-hybrid-analysis" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#analyzing-samples-using-hybrid-analysis" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>On its homepage, we are greeted with the following screen:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/947a74dd9d2ff42810c1a0c91079a1e8.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/947a74dd9d2ff42810c1a0c91079a1e8.png" />
    
  </figure>
</p>
<p>As
we mentioned, we will not be submitting a sample. Instead, we will
search for the hash of our sample. Therefore, we will search for the
md5sum of the wannacry sample from the attached VM. We will see that it is already submitted multiple times, and we can choose from the submitted results.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9d8e2a97315e6b458f583d211b4819ba.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9d8e2a97315e6b458f583d211b4819ba.png" />
    
  </figure>
</p>
<p>Let&rsquo;s open the one submitted on Windows 7 64 bit from among these.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/cb173e0611090adc2327e7f5770d89c1.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/cb173e0611090adc2327e7f5770d89c1.png" />
    
  </figure>
</p>
<p>We
will see the above interface when we click on the sample. We can see a
navigation pane on the right that highlights different parts of the
report. We can also see that the verdict is malicious, with a threat
score of 100/100 and AV
detection of 95%. Below that, we see the overview of the sample&rsquo;s
behavior. Below that, we will see the mapping to MITRE ATT&amp;CK
techniques. We will see the following mapping when we click <code>view all details</code>:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9e1a1a01fcf353c9a75c33ab0358a877.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/9e1a1a01fcf353c9a75c33ab0358a877.png" />
    
  </figure>
</p>
<p>Below
that, we will see some indicators and context information and some
static analysis information for the sample. The dynamic analysis part
comes below that:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/c817a7e0dcaa383e9d9f84bd19f527c1.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/c817a7e0dcaa383e9d9f84bd19f527c1.png" />
    
  </figure>
</p>
<p>This
part provides us with a lot of information about the behavior of the
sample when it was run in a sandbox. We can click each process to find
more detail about it. In the above screenshot, of particular interest
can be the executions of cmd.exe. We can see that the sample is running
script files and deleting backups and volume shadow copies, something
often done by ransomware operators to stop the victim from restoring
their files from these sources.</p>
<p>Below this section, we will see network analysis of the sample:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/77053f26e9374259ca622908bcb0fab0.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/77053f26e9374259ca622908bcb0fab0.png" />
    
  </figure>
</p>
<p>Extracted
strings and extracted files are also available in the report. These can
provide information about the batch scripts we saw in the processes
above.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/afe475fcc71679a4c07297bdcf60cd48.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61306d87a330ed00419e22e7/room-content/afe475fcc71679a4c07297bdcf60cd48.png" />
    
  </figure>
</p>
<p>And
there are comments from the community at the very end. As we might have
seen, we can find many pieces of the puzzle that a malware sample is,
using the discussed techniques. However, in some cases, these techniques
can prove insufficient to make a decision. Let&rsquo;s move to the next task
to determine what scenarios can make it challenging to analyze malware.</p>
<p><strong>Anti-analysis techniques</strong></p>
<p>While the security
researchers are devising techniques and tools to analyze malware, the
malware authors are working on rendering these tools and techniques
ineffective. We found a great deal of information in the previous tasks
about the malware we analyzed. However, there are ways malware authors
can make our life difficult. Below are some of the techniques used by
malware authors to do the same.</p>


<h2 class="relative group">Packing and Obfuscation: 
    <div id="packing-and-obfuscation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#packing-and-obfuscation" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Malware authors often use packing and obfuscation to make an
analyst&rsquo;s life difficult. A packer obfuscates, compresses, or encrypts
the contents of malware. These techniques make it difficult to analyze
malware statically. Specifically, a packed malware will not show
important information when running a string search against it. For
example, let&rsquo;s run a string search against the file named <code>zmsuz3pinwl</code> in the Samples folder in the attached VM.</p>
<p>Remnux</p>
<pre tabindex="0"><code>user@machine$ strings zmsuz3pinwl!This program cannot be run inDOS mode.
RichH
.rsrc
.data
.adata
dApB
Qtq5
wn;3b:TC,n
*tVlr
D6j[
^sZ&#34;4V
JIoL
j~AI
tYFu
7^V1
vYB09
&#34;PeHy
M4AF#
3134
%}W\+3A;a5
dLq&lt;
.
.
.
.
.
.
</code></pre><p>We will notice that this sample contains mainly garbage strings that
don&rsquo;t provide much value to us. Let&rsquo;s run pecheck on the sample to see
what else we get.</p>
<p>Remnux</p>
<pre tabindex="0"><code>user@machine$ pecheck zmsuz3pinwlPE check for &#39;zmsuz3pinwl&#39;:
Entropy: 7.978052 (Min=0.0, Max=8.0)
MD5     hash: 1ebb1e268a462d56a389e8e1d06b4945
SHA-1   hash: 1ecc0b9f380896373e81ed166c34a89bded873b5
SHA-256 hash: 98c6cf0b129438ec62a628e8431e790b114ba0d82b76e625885ceedef286d6f5
SHA-512 hash: 6921532b4b5ed9514660eb408dfa5d28998f52aa206013546f9eb66e26861565f852ec7f04c85ae9be89e7721c4f1a5c31d2fae49b0e7fdfd20451191146614a
 entropy: 7.999788 (Min=0.0, Max=8.0)
 entropy: 7.961048 (Min=0.0, Max=8.0)
 entropy: 7.554513 (Min=0.0, Max=8.0)
.rsrc entropy: 6.938747 (Min=0.0, Max=8.0)
 entropy: 0.000000 (Min=0.0, Max=8.0)
.data entropy: 7.866646 (Min=0.0, Max=8.0)
.adata entropy: 0.000000 (Min=0.0, Max=8.0)
Dump Info:
----------Parsing Warnings----------

Suspicious flags set for section 0. Both IMAGE_SCN_MEM_WRITE and IMAGE_SCN_MEM_EXECUTE are set. This might indicate a packed executable.

Suspicious flags set for section 1. Both IMAGE_SCN_MEM_WRITE and IMAGE_SCN_MEM_EXECUTE are set. This might indicate a packed executable.

Suspicious flags set for section 2. Both IMAGE_SCN_MEM_WRITE and IMAGE_SCN_MEM_EXECUTE are set. This might indicate a packed executable.

Suspicious flags set for section 3. Both IMAGE_SCN_MEM_WRITE and IMAGE_SCN_MEM_EXECUTE are set. This might indicate a packed executable.

Suspicious flags set for section 4. Both IMAGE_SCN_MEM_WRITE and IMAGE_SCN_MEM_EXECUTE are set. This might indicate a packed executable.

Suspicious flags set for section 5. Both IMAGE_SCN_MEM_WRITE and IMAGE_SCN_MEM_EXECUTE are set. This might indicate a packed executable.

Suspicious flags set for section 6. Both IMAGE_SCN_MEM_WRITE and IMAGE_SCN_MEM_EXECUTE are set. This might indicate a packed executable.

Imported symbols contain entries typical of packed executables.
.
.
.
.
.
.
.
</code></pre><p>As suspected, we see that the executable has characteristics typical
of a packed executable, as per pecheck. We will notice that there is no
.text section in the sample, and other sections have execute
permissions, which shows that these sections contain executable
instructions or will be populated with executable instructions during
execution. We will also see that this sample does not have many imports
that might show us its functionality, as we saw with the previous
sample.</p>
<p>For analysis of packed executables, the first step is
generally to unpack the sample. This is an advanced topic that will be
covered in the upcoming rooms.</p>


<h2 class="relative group">Sandbox evasion: 
    <div id="sandbox-evasion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#sandbox-evasion" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>As we have seen previously, we can always run a sample in a sandbox
to analyze it. In many cases, that might help us analyze samples that
evade our basic static analysis techniques. However, malware authors
have some tricks up their sleeves that hamper that effort. Some of these
techniques are as follows:</p>
<ul>
<li><strong>Long sleep calls:</strong> Malware
authors know that sandboxes run for a limited time. Therefore, they
program the malware not to perform any activity for a long time after
execution. This is often accomplished through long sleep calls. The
purpose of this technique is to time out the sandbox.</li>
<li><strong>User activity detection:</strong> Some malware samples will wait for user activity before performing malicious activity. The premise of this technique is that there will be no user
in a sandbox. Therefore there will be no mouse movement or typing on the keyboard. Advanced malware also detects patterns in mouse movements
that are often used in automated sandboxes. This technique is designed
to bypass automated sandbox detection.</li>
<li><strong>Footprinting user activity:</strong> Some malware checks for user files or activity, like if there are any files
in the MS Office history or internet browsing history. If no or little
activity is found, the malware will consider the machine as a sandbox
and quit.</li>
<li><strong>Detecting VMs:</strong> Sandboxes run on virtual
machines. Virtual machines leave artifacts that can be identified by
malware. For example, some drivers installed in VMs being run on VMWare or Virtualbox give away the fact that the machine
is a VM. Malware authors often associate VMs with sandboxes and would
terminate the malware if a VM is detected.</li>
</ul>
<p>The above
list is not exhaustive but gives us an idea of what to expect when
analyzing malware. In a future module dedicated to malware analysis, we
will discuss these techniques and ways to detect malware that employs
them.</p>

          
          
          
        </div>
        
        

        
        
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://localhost:1313/journal/posts/dfir/&amp;title=Digital%20Forensics%20and%20Incidence%20Response"
      title="Share on LinkedIn"
      aria-label="Share on LinkedIn"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://twitter.com/intent/tweet/?url=http://localhost:1313/journal/posts/dfir/&amp;text=Digital%20Forensics%20and%20Incidence%20Response"
      title="Tweet on Twitter"
      aria-label="Tweet on Twitter"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:1313/journal/posts/dfir/&amp;quote=Digital%20Forensics%20and%20Incidence%20Response"
      title="Share on Facebook"
      aria-label="Share on Facebook"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="mailto:?body=http://localhost:1313/journal/posts/dfir/&amp;subject=Digital%20Forensics%20and%20Incidence%20Response"
      title="Send via email"
      aria-label="Send via email"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://api.whatsapp.com/send?text=http://localhost:1313/journal/posts/dfir/&amp;resubmit=true&amp;title=Digital%20Forensics%20and%20Incidence%20Response"
      title="Share via WhatsApp"
      aria-label="Share via WhatsApp"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://t.me/share/url?url=http://localhost:1313/journal/posts/dfir/&amp;resubmit=true&amp;title=Digital%20Forensics%20and%20Incidence%20Response"
      title="Share via Telegram"
      aria-label="Share via Telegram"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z"/></svg>

  </span>


    </a>
      
    
  </section>


        


  
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\\DFIR\\index.md"
        var oid_likes = "likes_posts\\DFIR\\index.md"
      </script>
      
      
      <script type="text/javascript" src="/journal/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/journal/posts/elemets-of-security-operations/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Elements of Security Operation</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-05-12T00:00:00&#43;00:00">12 May 2023</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/journal/posts/fawn/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Fawn</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-09-12T00:00:00&#43;00:00">12 September 2024</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      © 2025 Board and Secretarial
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/journal/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/journal/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
