<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/journal/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=journal/livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Infrastructure as code &middot; Board and Secretarial</title>
  <meta name="title" content="Infrastructure as code &middot; Board and Secretarial" />
  
  <meta name="description" content="Credit to TryHackMe" />
  <meta name="keywords" content="Infrastructure as code, " />
  
  
  <link rel="canonical" href="http://localhost:1313/journal/posts/iac/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/journal/css/main.bundle.min.e96772c5cdc14f53dc8f2d49a7f91bd1dc21484251faa988567a4cb5313e24ea6befb15bbad2f816721b267c196c83c5c688647f3f59faf0e25b638d0e602880.css"
    integrity="sha512-6Wdyxc3BT1Pcjy1Jp/kb0dwhSEJR&#43;qmIVnpMtTE&#43;JOpr77FbutL4FnIbJnwZbIPFxohkfz9Z&#43;vDiW2ONDmAogA==" />
  
  
  <script type="text/javascript" src="/journal/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/journal/js/main.bundle.min.7577f5e7ec0b1de90dda8695656cc4a5d0b8572bf4f231fe41da838734363b6821779a2d4141ba0b53cfc2a543b76cdf375d53c8eb2b1d723b3ddaecff69d640.js"
    integrity="sha512-dXf15&#43;wLHekN2oaVZWzEpdC4Vyv08jH&#43;QdqDhzQ2O2ghd5otQUG6C1PPwqVDt2zfN11TyOsrHXI7Pdrs/2nWQA==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/journal/lib/zoom/zoom.min.fcbc7f7b3dcea96e3b5570cd322c5d7a12d5351c87f9889b1c31745a2cc711df58f6b70795a86d50e63813b236ade916668332c10a70a4ce26f7c0878f525fce.js" integrity="sha512-/Lx/ez3OqW47VXDNMixdehLVNRyH&#43;YibHDF0WizHEd9Y9rcHlahtUOY4E7I2rekWZoMywQpwpM4m98CHj1Jfzg=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/journal/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/journal/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/journal/favicon-16x16.png" />
  <link rel="manifest" href="/journal/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/journal/posts/iac/">
  <meta property="og:site_name" content="Board and Secretarial">
  <meta property="og:title" content="Infrastructure as code">
  <meta property="og:description" content="This is a blog on infrastructure built by code from scratch, this helps to deploy resources to the cloud without making mistakes.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-02T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-03-02T00:00:00+00:00">
    <meta property="article:tag" content="Infrastructure as Code">
    <meta property="og:image" content="http://localhost:1313/journal/posts/iac/featured.jpg">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/journal/posts/iac/featured.jpg">
  <meta name="twitter:title" content="Infrastructure as code">
  <meta name="twitter:description" content="This is a blog on infrastructure built by code from scratch, this helps to deploy resources to the cloud without making mistakes.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Infrastructure as code",
    "headline": "Infrastructure as code",
    "description": "This is a blog on infrastructure built by code from scratch, this helps to deploy resources to the cloud without making mistakes.",
    "abstract": "Credit to TryHackMe",
    "inLanguage": "en",
    "url" : "http:\/\/localhost:1313\/journal\/posts\/iac\/",
    "author" : {
      "@type": "Person",
      "name": "Board and Secretarial"
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-03-02T00:00:00\u002b00:00",
    "datePublished": "2024-03-02T00:00:00\u002b00:00",
    
    "dateModified": "2024-03-02T00:00:00\u002b00:00",
    
    "keywords": ["Infrastructure as code"],
    
    "mainEntityOfPage": "true",
    "wordCount": "21042"
  }]
  </script>


  
  
  <meta name="author" content="Board and Secretarial" />
  
  
  

<script src="/journal/lib/jquery/jquery.slim.min.03cb160e3cfdb2667a2e2c80d283bebcf63ff8bbc4b629c9ab2babf6fae1d0c07ad470edae783efa4fabda2ac01c58d60e63b98b3c336be8208460f08f4354f5.js" integrity="sha512-A8sWDjz9smZ6LiyA0oO&#43;vPY/&#43;LvEtinJqyur9vrh0MB61HDtrng&#43;&#43;k&#43;r2irAHFjWDmO5izwza&#43;gghGDwj0NU9Q=="></script>






















  
  



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3">
    
    
    
    <div>
        <a href="/journal/" class="flex">
            <span class="sr-only">Board and Secretarial</span>

            
            <img src="/journal/img/bnslogo.png" width="41" height="40"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="Board and Secretarial" />
            

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/journal/" class="text-base font-medium text-gray-500 hover:text-gray-900">Board and Secretarial</a>
            

        </nav>
        <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">

            
            
            
  <a href="/journal/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Posts">
        Articles
    </p>
</a>



            
            
  <a href="/journal/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Categories">
        Categories
    </p>
</a>



            
            
  <a href="https://boardandsecretarial.co.ke/about-us/"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Our Website
    </p>
</a>



            
            
  <a href="/journal/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Tags">
        Tags
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class=" flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/journal/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Posts">
            Articles
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/journal/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Categories">
            Categories
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="https://boardandsecretarial.co.ke/about-us/"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Our Website
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/journal/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Tags">
            Tags
        </p>
    </a>
</li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>




<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>


  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  


<div id="hero" class="h-[150px] md:h-[200px]"></div>



    
    <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(/journal/posts/iac/featured_hu7300562624331633540.jpg);">
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Infrastructure as code
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  



  



  



  





  



<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-03-02T00:00:00&#43;00:00">2 March 2024</time><span class="px-2 text-primary-500">&middot;</span><span>21042 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">99 mins</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts\IAC\index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="likes_posts\IAC\index.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="likes">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
    <button id="button_likes"
        class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
        onclick="process_article()">
        <span id="button_likes_heart" style="display:none" class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

 </span>
        <span id="button_likes_emtpty_heart" class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"/></svg>
  </span>

</span>
        <span id="button_likes_text">&nbsp;Like</span>
    </button>
</span><span class="px-2 text-primary-500">&middot;</span>


<script type="text/javascript" src="/journal/js/zen-mode.min.eea5245cf9244ecbdf2c150d1c8833226c1541cadf6e98f63a7c9192b1a3676df2c3ec603b14f4cfaaa53971fd9d8955640c0f405bf3de2b43ee7a5fb29ae721.js" integrity="sha512-7qUkXPkkTsvfLBUNHIgzImwVQcrfbpj2OnyRkrGjZ23yw&#43;xgOxT0z6qlOXH9nYlVZAwPQFvz3itD7npfsprnIQ=="></script>

<span class="mb-[2px]">
    <span id="zen-mode-button"
          class="text-lg hover:text-primary-500"
          title="Enable zen mode"
          data-title-i18n-disable="Enable zen mode"
          data-title-i18n-enable="Disable zen mode">
        <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50px" height="50px">
    <path fill="currentColor" d="M 12.980469 4 C 9.1204688 4 5.9804688 7.14 5.9804688 11 L 6 26 L 9.9804688 26 L 9.9804688 11 C 9.9804688 9.35 11.320469 8 12.980469 8 L 40.019531 8 C 41.679531 8 43.019531 9.35 43.019531 11 L 43.019531 39 C 43.019531 40.65 41.679531 42 40.019531 42 L 29 42 C 29 43.54 28.420938 44.94 27.460938 46 L 40.019531 46 C 43.879531 46 47.019531 42.86 47.019531 39 L 47.019531 11 C 47.019531 7.14 43.879531 4 40.019531 4 L 12.980469 4 z M 7 28 C 4.794 28 3 29.794 3 32 L 3 42 C 3 44.206 4.794 46 7 46 L 23 46 C 25.206 46 27 44.206 27 42 L 27 32 C 27 29.794 25.206 28 23 28 L 7 28 z M 7 32 L 23 32 L 23.001953 42 L 7 42 L 7 32 z"/>
</svg>
  </span>

</span>
    </span>
</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/categories/infras/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Infras
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/categories/tryhackme/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    TryHackMe
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/tags/infrastructure-as-code/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Infrastructure as Code
  </span>
</span>
  </span>
  
  
  
  
</div>




    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
    
    
      
    
    
      
        
      
      <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
      alt="Board and Secretarial" src="/journal/img/bnslogo_hu17121383633210364831.png" />
    
  
  <div class="place-self-center">
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      Board and Secretarial
    </div>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">Board and Secretarial Comprises of seasoned lawyers and corporate governance experts. The team boasts extensive expertise across legal, regulatory, ethical, and corporate governance domains.</div>
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
    

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          

<h1 class="relative group">Introductoin 
    <div id="introductoin" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#introductoin" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p><a href="https://tryhackme.com/signup?referrer=6325877cfcc474005111479e" target="_blank">TryHackMe</a> provides one of the best contents when it comes to cybersecurity, below is a snippet of the content one will acquire when subcribed to the premium learning path of TryHackMe Infrastructure as code.
They have summarised the content very well and clealry understood, for practical experience, subscribe to their platform to gain the skills.</p>


<h1 class="relative group">INFRASTRUCTURE AS CODE 
    <div id="infrastructure-as-code" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#infrastructure-as-code" aria-label="Anchor">#</a>
    </span>        
    
</h1>


<h2 class="relative group">INTRO 
    <div id="intro" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#intro" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p><strong>Infrastructure Before IaC</strong></p>
<p>Before defining IaC, it’s important to understand why we need it. In other words, what problems is it solving?</p>
<p>Let us consider what was required when infrastructure was configured and
managed in the days before IaC. Here are some tasks which would have
been the responsibility of various teams (depending on companies
structure), such as DevOps/DevSecOps, Platform, Infrastructure, Network
and Systems Administration:</p>
<ul>
<li>Manually provisioning servers (physically installing servers or manually deploying virtual machines)</li>
<li>Network configuration (setting up a network for the infrastructure, including
setting up IP addresses, subnets, routing tables and any network
components tat the infra needs like routers, switches or firewalls)</li>
<li>Installing an OS</li>
<li>Installation, configuration and updating of software (database, web server etc.)</li>
<li>Disaster recovery (DR) (this involves having a backup infrastructure on standby, making a detailed “failover” plan, and having clear procedures in place should the primary data centre go down).</li>
</ul>


<h1 class="relative group">Infrastructure as Code Explained 
    <div id="infrastructure-as-code-explained" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#infrastructure-as-code-explained" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Instead of provisioning and managing infrastructure manually, as discussed
above, infrastructure as code allows the automation of these tasks
through code. This code can be used to define a &ldquo;desired state&rdquo; for the
infrastructure, acting as a blueprint for IaC tools to provision the
infrastructure. For example, you may define some resources in your code,
such as network components, virtual machines, and a database. An IaC
tool will build this blueprint and ensure the infrastructure is always
in line with it. Should you want to make an infrastructure change, like
increasing the number of VMs,
only a simple change needs to be made to the code, which will be
reflected in your infrastructure once applied. Compare this to what was
previously required to add a VM, which would involve making a manual
request through a portal and waiting for that request to be actioned by a
systems administrator, and it becomes easy to see the utility of IaC.</p>


<h1 class="relative group">The Many Benefits of IaC 
    <div id="the-many-benefits-of-iac" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-many-benefits-of-iac" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Having infrastructure deployed from code also means it can be a collaborative
process and a shared responsibility. This means knowledge of
infrastructure and its configuration isn&rsquo;t siloed to a single team
member, avoiding knowledge dependencies whilst supporting continuous
integration (CI). Continuous deployment (CD) is also supported through the ability to
deploy consistent infrastructure across multiple environments. As well
as reducing the manual efforts and risk of error, an IaC approach can
make it possible to have a reliable infrastructure that
is scalable, versionable, and repeatable.</p>
<p><strong>Scalable</strong></p>
<p>This technology begins to make even more sense when you consider the
widespread adoption of cloud computing and its elastic nature, with
virtual machines and resources being scaled up and down based on demand
due to resources being billed per second/minute/hour. With IaC, you can
do this scaling with a single command or even automate the process,
whereas in the past, this would have involved weeks of work (e.g.,
logging tickets and manually provisioning and de-provisioning).</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/b6e2ee40f4e71121225f291804036b58.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/b6e2ee40f4e71121225f291804036b58.png" />
    
  </figure>
</p>
<p><strong>Versionable</strong></p>
<p>Infrastructure as code should be treated as any other code and versioned using a
version control system. Versioning an infrastructure means it&rsquo;s
self-documenting, allowing infrastructure changes to be tracked and
recorded. This benefits the many teams that work with infrastructure
with all sorts of tasks, from audits to troubleshooting infrastructure
issues. Speaking of infrastructure issues, versioning also means that
should your latest infrastructure start having problems, you can
redeploy your infrastructure to the last known working version, an
example of how IaC allows for reliable infrastructure. Versioning
infrastructure can also improve testing capabilities; for example, an
application can be tested using a historical infrastructure build.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/af0e4d32762b91bc2df2ade961373378.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/af0e4d32762b91bc2df2ade961373378.svg" />
    
  </figure>
</p>
<p><strong>Repeatable</strong></p>
<p>In the dev world, it is common to work between multiple environments.
Developers first build their code in a dev environment before testing it in a staging environment (which mirrors production) and finally
deploying the fully functional and tested code into the production
environment. In the past, these three environments would require the
manual provisioning and configuration of 3 respective infrastructures.
With IaC, you can use the same code/configuration to set up identical
infrastructures across multiple environments with the push of a button.
While saving massive amounts of time, this also ensures
consistency/reliability across environments, which is critical when
testing software and was very hard to achieve in the days of manual
provisioning.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/d82ac6ab32e5e5b1b3c5b49b61b35a5f.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/d82ac6ab32e5e5b1b3c5b49b61b35a5f.svg" />
    
  </figure>
</p>


<h1 class="relative group">IaC in Practice 
    <div id="iac-in-practice" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#iac-in-practice" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>IaC
is a powerful technology that can streamline and improve
business-critical processes if used correctly. To demonstrate this
utility, let us take one of the example responsibilities mentioned at
the beginning of the task, disaster recovery, and examine how IaC can
aid this process. As touched on above, disaster recovery is the process
of restoring infrastructure after a catastrophic/disruptive event; for
example, if you are working for a company that has a physical
on-premises infrastructure located in a data centre, a disaster can
range from a simple power outage to extreme examples such as natural
disasters like wildfires or hurricanes bringing this &ldquo;primary&rdquo; data
centre down. Failing over from this primary data centre to a secondary
backup data centre, when done manually, is a very time-consuming,
high-pressure situation which can lead to many issues. Here are a few
ways in which IaC can help with disaster recovery:</p>
<p><strong>Infrastructure Automation:</strong> Since
IaC allows the automation of the provisioning and configuration of an
infrastructure, reprovisioning and re-configuring an infrastructure in a
backup data centre is streamlined and less time-consuming.</p>
<p><strong>Data Backup and Recovery:</strong> Data
loss or corruption is one of the most significant risks associated with
disaster recovery and can be very costly to the affected company.
Infrastructure as code can be used to automate the backup and recovery
of data. Backup procedures can be defined in code, which will be
triggered in the event of a disaster to ensure data is restored.</p>
<p><strong>Failover Automation:</strong> During
a disaster, critical services can become unavailable as they will point
to the broken infrastructure. IaC can be used to automate the failover
process so critical services use the backup infrastructure, which
reduces downtime.</p>
<p><strong>Configuration Consistency:</strong> IaC
keeps infrastructure consistent and well-documented; this consistency
is vital during the disaster recovery process and helps avoid
misconfigurations (often caused by simple human error or lack of
documentation on the current configuration)  during the transition to a
backup environment.</p>
<p><strong>Scaling Resources:</strong> The
recovery process can be resource intensive, and IaC can be used to
scale resources to handle the increased workloads (and scale back down
afterwards).</p>
<p>These
are just some examples of how IaC can aid and streamline processes,
with a wide range of teams benefitting from infrastructure as code&rsquo;s
versionable, scalable, and repeatable nature - saving them time and
headaches.</p>


<h1 class="relative group">Summary 
    <div id="summary" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#summary" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>In conclusion, infrastructure as code is a fundamental concept in DevSecOps,
with the technology supporting key concepts like continuous integration
(allowing for infrastructure development to be a collaborative process
with versioning in place) and continuous deployment (allowing for the
automation of infrastructure deployment across multiple environments
consistently). IaC also improves efficiency by facilitating
infrastructure changes in code, allowing for changes to be made quickly
to adapt to developing infrastructure requirements and reduce manual
tasks in the process.</p>
<p>IaC - The Tools Part 1</p>
<p><strong>Get to Know Your Toolkit</strong></p>
<p>Now that we’ve established <em>what</em> IaC
is, we can start thinking about some of the tools used for
infrastructure as code. Many tools fall under the IaC umbrella,
including Terraform, AWS
CloudFormation, Google Cloud Deployment Manager, Ansible, Puppet, Chef,
SaltStack and Pulumi. It’s important to understand that some of these
tools have different use cases, each with its own benefits. Due to the
varied use cases of these IaC tools, having infrastructure provisioned,
configured and deployed end-to-end will require using a combination of
IaC tools rather than a single solution. To better understand these
tools, this task will cover some of the key characteristics which
distinguish these tools from each other so you know <em>what</em> tool to use and <em>when</em>.
Bear in mind that the behaviour of these tools can often depend on
exactly how they are used, often leading to debate over some of their
characteristics; with this in mind, we will define those characteristics
in question and how each tool is <em>generally</em> used.</p>
<p><strong>Declarative vs. Imperative</strong></p>
<p>First
off, let’s establish the difference between declarative and imperative
(also known as functional and procedural) IaC tools:</p>
<p><strong>Declarative</strong></p>
<p>This
involves declaring an explicit desired state for your infrastructure,
min/max resources, x components, etc.; the IaC tool will perform actions
based on what is defined. A state file is kept to ensure your
infrastructure’s current state matches the desired state. In other
words, it focuses on the <strong>what</strong> rather than the <strong>how</strong>. A
declarative IaC tool is usually idempotent, meaning the same result
will be achieved when run repeatedly. This is because that check is done
against the state file, and if the infrastructure is already
provisioned, it will make no changes if rerun. Examples of declarative
IaC tools are Terraform, AWS CloudFormation, Pulumi and Puppet (Ansible also supports declarative).</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/1fe8ba3fc1a6c19ff9a54e81d3d84580.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/1fe8ba3fc1a6c19ff9a54e81d3d84580.svg" />
    
  </figure>
</p>
<p><strong>Imperative</strong></p>
<p>This
approach involves defining specific commands to be run to achieve the
desired state; these commands need to be executed in a particular order.
Imperative IaC is usually not idempotent in that if you run these tools
multiple times, the same result won’t be replicated, or the tool may
run into some configuration issues. This is because these commands will
be run regardless of the state of your infrastructure, so running these
commands on an already provisioned infrastructure may cause additional
unwanted infrastructure to be added or may break the configuration of
some existing components (depending on the set-up of the infrastructure
and the commands being run). Examples of imperative IaC tools: Chef is
the best example of an imperative tool; however, SaltStack and Ansible
both support imperative programming as well.</p>
<p>Imagine
it like directions to an X on a map, where imperative will give you a
list of directions which will bring you to X if you are at the known
start point (e.g., an unconfigured server). However, if you are not at
this known start point (e.g., a partially configured server), you will
not arrive at X but somewhere slightly different. Declarative takes into
account where you are on the map and works out which directions need to
be taken to get to X from that point. Deciding which to use can depend
on what your infrastructure needs are. Declarative is considered a more
straightforward approach that is easier to manage, especially for
long-term infrastructure. In contrast, imperative IaC is more flexible,
giving the user more control and allowing them to specify exactly how
the infrastructure is provisioned/managed rather than the tool itself
taking care of it.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/2bd68304fbc939b4212c471a0868b202.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/2bd68304fbc939b4212c471a0868b202.png" />
    
  </figure>
</p>


<h1 class="relative group">Agent-based vs. Agentless 
    <div id="agent-based-vs-agentless" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#agent-based-vs-agentless" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Agent-based
vs Agentless is a term that extends beyond infrastructure as code and
is also used in the context of monitoring and security tools. In the
context of IaC:</p>
<p><strong>Agent-based</strong></p>
<p>An
“agent” will need to be installed on the server that is to be managed.
It runs in the background and acts as a communication channel between
the IaC tool and the resources that need managing. This agent is
responsible for executing and reporting on the state of the
infrastructure/managed resources. Note that this agent must be installed
on every target system/node that needs to be managed. An agent-based
IaC tool can perform tasks even when the system has limited connectivity
or is offline, making it a robust choice for automation; however, you
need to take care with maintenance when using these tools, monitoring
the agent software closely so it can be restarted in the event of a
crash.</p>
<p>Another
thing to consider with agent-based IaC tools is that some of these
tools will require opening ports on the server for inbound and outbound
traffic so that the agent can push/pull configuration information; from a
security perspective, more open ports are negative. Despite this, they
offer a level of granular control over managed resources and can collect
more detailed monitoring data. Because of this, they might be ideal if
control is an important factor in your setup. Some agent-based IaC
tools: Puppet, Chef, and Saltstack.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/20605c0c3f9cb08bddf3d3d1b1fb5d81.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/20605c0c3f9cb08bddf3d3d1b1fb5d81.png" />
    
  </figure>
</p>
<p><strong>Agentless</strong></p>
<p>Agentless
IaC tools, as you may have guessed, do not require agents to be
installed on target systems. Instead, these tools leverage existing
communication protocols like SSH,
WinRM or Cloud APIs to interact with and provision resources on the
target system. Agentless IaC tools benefit from being easier to use;
their simplicity during set-up can mean faster deployment time, and
their agentless nature can also mean the tool can be deployed across
multiple environments without custom agent changes needing to be made
based on each environment’s needs, making it a flexible choice. Also,
compared to agent-based IaC tools, there is less maintenance and no
risks surrounding the securing of an agent. However, agentless IaC tools
generally have less control over target systems than agent-based tools.
Agentless tools are useful in environments which have to adapt to
fluctuating workloads, with resources being created/destroyed to meet
these workloads. These newly created resources can be managed without
having to rely on pre-installed agents. Agentless IaC tools: Terraform,
AWS CloudFormation, Pulumi and Ansible.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/10e228ac974caf680f0fa21a854924c5.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/10e228ac974caf680f0fa21a854924c5.png" />
    
  </figure>
</p>
<p>Once
again, both options have their advantages and disadvantages.
Infrastructure provisioning and configuration can present developers
with a very particular set of problems, and choosing the correct tool
for the job, depending on what needs to be done, involves taking these
into account.</p>
<p>IaC - The Tools Part 2</p>
<p><strong>Immutable vs. Mutable</strong></p>
<p>Immutable
vs mutable infrastructure refers to whether or not changes can be made
to an infrastructure. To define both, let’s imagine we have a simple
infrastructure, a virtual machine with a web server and application. If
you want to change this infrastructure, for example, deploy some
application code to your web application, this code will mean your web
application will go from version 1 to version 2. How might that look for
each?</p>
<p>Mutable</p>
<p>Mutable
infrastructure means you can make changes to that infrastructure in
place. So, in our current example, we can upgrade the application on the
server it’s currently running on. The advantage here is that no
additional resources need to be provisioned for this update, with the
resources already being used just needing to be changed. Where mutable
infrastructure starts presenting issues is, imagine your web application
update contains three changes, and whilst these updates are being made,
one of the changes fails to apply. This is a common occurrence in
development and can occur for several reasons, such as application
misconfiguration or a network dropout. Now running on your server will
be a web application version with two of the three changes required to
be version 2. In other words, it’s no longer version 1 anymore but not
quite version 2 either. When an application is updated in a production
environment, it will have been tested first in development and staging
environments. What won’t have been tested is this halfway version,
leading to all kinds of potential issues. Imagine now that this update
was not just rolled out on a single server, but many, maybe some updates
succeeded, and some failed with errors in different changes. You can
see how this can become an issue very quickly with different versions of
the web application existing across many servers.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/48c0d1e0a1fdfa62bcdb829892462093.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/48c0d1e0a1fdfa62bcdb829892462093.png" />
    
  </figure>
</p>
<p>Immutable</p>
<p>Immutable
infrastructure means you cannot make changes to it. Once an
infrastructure has been provisioned, that’s how it will be until it’s
destroyed. Now, let’s apply that to our example. When this new version 2
of the web application is deployed, an entirely new infrastructure will
be deployed with this new version. Now, you have two infrastructures
stood up: one with version 1 of the web application and one with version
2. However, if all of the changes are implemented successfully (and
only if they ALL are; otherwise, if it fails, the infrastructure will be
torn down, and the process will be retried), the version 1
infrastructure can be torn down. This approach has some drawbacks, as
having multiple infrastructures stood up side by side or retrying on
failed attempts is more resource-intensive than simply updating in
place, but it allows for consistency across servers. You know with
certainty that x server is running version 2 of the web application.</p>
<p>Immutable IaC tools: Terraform, AWS
CloudFormation, Google Cloud Deployment Manager, Pulumi (some of these
tools can be configured to be used with a mutable infrastructure but
work better with an immutable approach)</p>
<p>In
the example given, it makes more sense to use an immutable
infrastructure. However, to demonstrate further that each can have its
own use case, imagine the server instead is a critical database system
that requires regular maintenance updates and patching. If you were to
use an immutable infrastructure for this, the critical database would
have to be rebuilt from scratch every time, which can be a risky process
when dealing with business-critical data. So, in this instance, it
might make sense to use a mutable infrastructure.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/97dcbf50ca109f1e26f2751c3d3fbf16.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/97dcbf50ca109f1e26f2751c3d3fbf16.png" />
    
  </figure>
</p>


<h1 class="relative group">Provisioning vs. Configuration Management 
    <div id="provisioning-vs-configuration-management" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#provisioning-vs-configuration-management" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>All
the characteristics discussed in this task so far are behavioural; in
other words, how does this tool work? This way or that way. Considering what a tool&rsquo;s purpose is and when it is used in the development of infrastructure will tell us whether it is a <em>provisioning</em> tool or a <em>configuration</em> <em>management</em> tool. You
might see these primary functions defined differently elsewhere, for
example, infrastructure as code vs. configuration as code, but to
determine which tool falls into which category, you simply need to ask,
&ldquo;What can it do?&rdquo;. If we think about four key tasks: Infrastructure
provisioning (the set-up of the infrastructure), infrastructure
management (changes made to infrastructure), software installation
(initial installation and configuration of software/applications), and
software management (updates made to software or config changes).</p>
<p>There
is no single tool that can perform all 4 of these tasks. Instead,
combining two tools, a provisioning tool and a configuration management
tool, is common practice to cover all these. There will be a practical
example of exactly what tools can cover which tasks in the static site
coming up. Some examples of each type of tool:</p>
<p>Provisioning tools: Terraform, AWS CloudFormation, Google Cloud Deployment Manager, Pulumi</p>
<p>Configuration management tools: Ansible, Chef, Puppet, Saltstack</p>
<p>Let’s
consider a real-life industry example of how these two types of tools
might be used. Say you work for a company which needs to set up a new
infrastructure for a web application. A similar one has been deployed
before and fell prey to some malicious activity, so this time, you will
install an agent to monitor for this activity. The infrastructure would
be defined and provisioned using a provisioning tool like Terraform, and
then a configuration management tool like Ansible would be used to
install an agent within the provisioned infrastructure to monitor for
malicious behaviour.</p>


<h1 class="relative group">Put That All Together 
    <div id="put-that-all-together" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#put-that-all-together" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Now,
you’ve been introduced to the world of infrastructure as code tools and
their various uses. Each has its characteristics which best suit
different use cases and scenarios. In that way, they are no different to
physical tools; you have to assess the problem and choose the best tool
to address it. Here&rsquo;s a little summary of what we&rsquo;ve discussed, as well
as a little bit more information about some of the tools mentioned:</p>
<p><strong>Terraform</strong>:
is a declarative, agentless infrastructure provisioning tool that works
with immutable infrastructure. Terraform is one of the most popular
infrastructure provisioning tools out there, allowing for the management
of infrastructure across multiple cloud providers like AWS, GCP and Azure.</p>
<p><strong>Ansible:</strong>
is a hybrid, typically agentless configuration management tool that
works with mutable infrastructure. Another example of a massively
popular tool in the DevSecOps
space. It&rsquo;s slightly harder to categorise than some of the other tools,
because of how this tool functions and what it does can depend on how
you employ it. For example, there is much discussion over whether
Ansible is an imperative or declarative tool. In reality, Ansible is
sort of a hybrid in a sense.</p>
<p><strong>Pulumi:</strong>
is a declarative, agentless infrastructure provisioning tool that works
with immutable infrastructure. Pulumi is similar in nature to Terraform
but has become increasingly popular in recent years due to its ability
to let users define their desired infrastructure using familiar
general-purpose languages like Python, JavaScript, Go, Java and markup
languages like YAML.</p>
<p><strong>Aws CloudFormation:</strong> is a declarative, agentless infrastructure provisioning tool which can be used to implement an immutable infrastructure on AWS. This is an AWS-managed service and provisions AWS cloud resources using JSON / YAML templates.</p>
<p><strong>Chef:</strong>
is an imperative, agent-based configuration management tool that works
with mutable infrastructure. Chef gets an infrastructure to a desired
state by running a series of instructions contained in a file referred
to as a &lsquo;Recipe&rsquo;; a collection of these files is referred to as a
&lsquo;Cookbook&rsquo;.</p>
<p><strong>Puppet:</strong> is
a declarative, agent-based configuration management tool that works
with mutable infrastructure. In Puppet, you define the desired
configuration state using their own domain-specific language (DSL),
&ldquo;Puppet Code&rdquo;; Puppet then automates this configuration through a Puppet
primary server and agent.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/63d2d4fc39187ca84cc6f9dc15197b01.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/63d2d4fc39187ca84cc6f9dc15197b01.png" />
    
  </figure>
</p>
<p>Infrastructure as Code Lifecycle</p>


<h1 class="relative group">The Lifecycle 
    <div id="the-lifecycle" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-lifecycle" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Now
that it has been established what IaC is and the tools we use to
implement it, it’s time to define the lifecycle. There is talk about an
IaC lifecycle across forms, blog posts, and academic papers. Still,
there is yet to be an agreed-upon and widely adopted lifecycle (as there
is for DevOps/DevSecOps). Because we think you, the reader, would
benefit from having an IaC lifecycle to use as an educational tool, we
have defined one, the infrastructure as code lifecycle (IaCLC). The
actions/tasks performed by developers and IaC tools can be broken down
into phases, which together make a lifecycle; this lifecycle helps us
understand that infrastructure as code has continual and repeatable
processes, which don&rsquo;t simply follow a linear sequence of provision and
management tasks. This task will outline the stages of the IaC
lifecycle, its phases and how they are connected.</p>
<p>The IaCLC is designed to give DevOps
Engineers (or anyone else assigned with the task) guidance on the tasks
associated with provisioning infrastructure and the continued support
of that infrastructure. Key DevOps practices such as continuous
integration and continuous deployment are also parts of best practices
throughout the lifecycle.</p>
<p>Due to IaC being a development process, some parallels can be drawn between the IaC lifecycle and the SDLC,
which also covers a solution&rsquo;s planning/designing, implementation,
testing, deployment and monitoring. While these parallels exist due to
these lifecycles being created on the same foundations (providing
developer guidance and improving output quality), they don&rsquo;t directly
fit into each other. Both lifecycles break down tasks into phases.
However, due to the frequently changing infrastructure needs, the IaCLC distinguishes between two different types of phases.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/248f6eebfa09c336733237216b1b4b8b.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/248f6eebfa09c336733237216b1b4b8b.svg" />
    
  </figure>
</p>
<p><strong>Breaking it Down</strong></p>
<p>As mentioned above, these phases are separated into two types. Let&rsquo;s break that down:</p>
<p><strong>Continual (Best Practice) Phases:</strong></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/5773fd17068a833784ff86ecaef4b97e.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/5773fd17068a833784ff86ecaef4b97e.svg" />
    
  </figure>
</p>
<p>These
phases are continually done to ensure best practices throughout the
various stages of infrastructure development and management. Continual
phases can trigger repeatable phases</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/821fd689bebc77ac57c22f309ee3caa9.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/821fd689bebc77ac57c22f309ee3caa9.svg" />
    
  </figure>
</p>
<p><strong>Repeatable(Infra Creation + Config) Phases:</strong></p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/f41d65ba204de1ab577d9e2cc981dfa8.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/f41d65ba204de1ab577d9e2cc981dfa8.svg" />
    
  </figure>
</p>
<p>These phases are done during the creation/configuration of an infrastructure and are
done one or many times at different points and with differing
variations depending on what needs to be done. Some examples are below:</p>
<p>Activity: Entirely new infra</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/b01d5b3df9751d5b35a6d23b724ecfc3.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/b01d5b3df9751d5b35a6d23b724ecfc3.svg" />
    
  </figure>
</p>
<p>Activity: Config change</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/feb147861ab6640feb45ea3494d08678.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/feb147861ab6640feb45ea3494d08678.svg" />
    
  </figure>
</p>
<p><strong>The Continual (Best Practice) Phases</strong></p>
<p>| Version Control | This
phase involves versioning code while defining your infrastructure and
making changes. This way, when it comes to the later rollback phase,
there are clearly defined versions to fall back on should a new change</p>
<table>
  <thead>
      <tr>
          <th>break something.</th>
          <th></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Collaboration</td>
          <td>When</td>
      </tr>
      <tr>
          <td>working as part of a team on infrastructure, it is crucial to</td>
          <td></td>
      </tr>
      <tr>
          <td>communicate and collaborate so everyone is on the same page. Otherwise,</td>
          <td></td>
      </tr>
      <tr>
          <td>this can lead to a disconnect between modular infrastructure components</td>
          <td></td>
      </tr>
      <tr>
          <td>or general confusion over infrastructure.</td>
          <td></td>
      </tr>
      <tr>
          <td>Monitoring/Maintenance</td>
          <td>Once</td>
      </tr>
      <tr>
          <td>an infrastructure has been provisioned/configured, it must be monitored</td>
          <td></td>
      </tr>
      <tr>
          <td>for poor performance, security events, failure events, warnings, etc.</td>
          <td></td>
      </tr>
      <tr>
          <td>Automated maintenance tasks (e.g. disk clean-up) can help avoid some of</td>
          <td></td>
      </tr>
      <tr>
          <td>these events. In certain events, this phase can trigger the rollback</td>
          <td></td>
      </tr>
      <tr>
          <td>phase.</td>
          <td></td>
      </tr>
      <tr>
          <td>Rollback</td>
          <td>In</td>
      </tr>
      <tr>
          <td>the event of a failure event post-deployment, the infrastructure will</td>
          <td></td>
      </tr>
      <tr>
          <td>need to be rolled back to the last known working version.</td>
          <td></td>
      </tr>
      <tr>
          <td>Review + Change</td>
          <td>Just</td>
      </tr>
      <tr>
          <td>because an infrastructure works doesn’t mean it’s as efficient as it</td>
          <td></td>
      </tr>
      <tr>
          <td>could be. Perhaps a new security vulnerability has been discovered, or</td>
          <td></td>
      </tr>
      <tr>
          <td>maybe there’s a new business requirement that would benefit from an</td>
          <td></td>
      </tr>
      <tr>
          <td>infrastructure change. Infrastructure should routinely be reviewed to</td>
          <td></td>
      </tr>
      <tr>
          <td>determine if this is the case, and changed if so.</td>
          <td></td>
      </tr>
  </tbody>
</table>
<p><strong>The Repeatable (Infra Creation + Config) Phases</strong></p>
<p>| Design | The
infrastructure needs to be designed based on needs, taking security
into account throughout the whole process (for example, poor scaling
policy design can lead to availability issues, which is a huge security</p>
<table>
  <thead>
      <tr>
          <th>concern).</th>
          <th></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Define</td>
          <td>Use the design to define the infrastructure that needs to be provisioned in code.</td>
      </tr>
      <tr>
          <td>Test</td>
          <td>Using</td>
      </tr>
      <tr>
          <td>a linter, validate the code for syntax errors or logical issues. Before</td>
          <td></td>
      </tr>
      <tr>
          <td>provisioning is done in production, test the infrastructure in a</td>
          <td></td>
      </tr>
      <tr>
          <td>replica environment (staging).</td>
          <td></td>
      </tr>
      <tr>
          <td>Provision</td>
          <td>Provision the infrastructure that has been defined in the production environment using a provisioning tool, e.g. Terraform.</td>
      </tr>
      <tr>
          <td>Configure</td>
          <td>Configure the provisioned environment using a configuration management tool, e.g. Ansible.</td>
      </tr>
  </tbody>
</table>
<p>On-Prem IaC vs. Cloud-Based IaC</p>
<p>Infrastructure as code has two use cases. On-premises IaC and cloud-based IaC.
Going forward, this module will go in-depth and give practical examples
of both of these. Let’s first establish the key differences between the
two. Here, we outline key differences between on-prem IaC and cloud-based IaC across five categories: Location, Tech, Resources, Scalability and Cost.</p>


<h1 class="relative group">Comparison 
    <div id="comparison" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#comparison" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/ec6e26a0a171e8f0177a0626903bb581.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/ec6e26a0a171e8f0177a0626903bb581.png" />
    
  </figure>
</p>
<p><strong>On-prem:</strong>
As the name implies, if your infrastructure is on-prem, then the code
written will configure servers, network devices, storage and software
located on your premises. This can mean physical infrastructure in a
premises owned by an organisation or rented in a data centre.</p>
<p><strong>Cloud-based:</strong> This
means provisioning and configuring infrastructure resources in a cloud
environment using cloud resources. This is done using a cloud service
provider (CSP) such as AWS, Microsoft Azure, GCP, etc.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/299069e9a2214ef21b905a52b39b0e60.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/299069e9a2214ef21b905a52b39b0e60.png" />
    
  </figure>
</p>
<p><strong>On-prem:</strong>
Typically, when working with an on-premises infrastructure, IaC tools
like Ansible, Chef and Puppet would be used (although others can be
configured to do so) to manage and provision infrastructure on physical
servers or virtual machines in an on-prem data centre.</p>
<p><strong>Cloud-based:</strong>
There are many tools available to provision and manage cloud
infrastructure designed to leverage the elastic nature of cloud
computing, with some cloud service providers having their own IaC
tool/service. Some examples of tools that can be used for cloud-based
IaC are Terraform, AWS CloudFormation, Azure Resource Manager (ARM) templates and Google Cloud Deployment Manager.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/470fd2be85001e01882c12235ac8d787.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/470fd2be85001e01882c12235ac8d787.png" />
    
  </figure>
</p>
<p><strong>On-prem:</strong>
When using on-prem IaC, you’ll likely be dealing with physical
hardware, which comes with the caveats of hardware compatibility,
physical upkeep and limited physical resources. This will mean setting
up and configuring those physical resources (physical servers, storage
devices, network equipment, etc.). On-prem IaC may be used by companies
who rely on their on-premises infrastructure due to legacy systems and
require assistance in the efficient management of this infrastructure.</p>
<p><strong>Cloud-based:</strong> In the cloud, you interact with virtual resources provided by the cloud service provider (AWS,
GCP, Azure, etc.). These resources can be provisioned/managed by
cloud-based IaC tools. The underlying infrastructure is handled by the
CSP and not the user. Cloud-based IaC would be perfect for companies
that offer video streaming services. Due to the nature of this service,
it can lead to a fluctuating demand on computing resources, which can
peak. Cloud-based IaC makes it easy to gain access to additional
cloud-based virtual machines or storage depending on resource
consumption to ensure consistent performance during these peaks.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/9b34ecfc02cb1c877a80306d889f6ab2.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/9b34ecfc02cb1c877a80306d889f6ab2.png" />
    
  </figure>
</p>
<p><strong>On-prem:</strong>
Scaling resources using on-prem IaC can be a slow and cumbersome
process. This can involve manual/physical changes and procurement.
Because scalability is such a slow process, consideration is required,
and hardware limitations must be enough to handle peak load. This can
prove challenging in situations where an on-premises infrastructure
starts receiving increased traffic (think enrolment or exam season at a
university/college).</p>
<p><strong>Cloud-based:</strong>
Due to the cloud’s elastic nature, scaling resources is far more
flexible than on-premises. Cloud-based IaC tools can define scaling
policies so resources can be scaled up or down based on demand and
resource consumption, leveraging auto-scaling features. This ensures
that only the resources needed are paid for. Cloud-based IaC can
streamline the process of scaling infrastructure to meet demands during
peak seasons. Imagine an infrastructure that supports an online game.
This infrastructure would see increased traffic when the game releases a
new update, or an event is underway.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/59742076f49a1fa228dfd972a330ec7f.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/59742076f49a1fa228dfd972a330ec7f.png" />
    
  </figure>
</p>
<p><strong>On-prem:</strong>
On-premises infrastructure expenses mean having to pay for physical
hardware (or leasing a server from a third-party data centre - depending
on the use case); this also comes with the costs of physical upkeep
(fault repairs/part replacements, etc.), operational costs and expenses
involved in upgrading the infrastructure. An on-premises infrastructure
and the use of on-prem IaC doesn&rsquo;t boast any cost benefits per se. If
choosing on-prem, it would likely be due to a combination of other
factors rather than cost.</p>
<p><strong>Cloud-based:</strong>
When using cloud-based IaC, you’ll deal with infrastructure that cloud
service providers bill for on a pay-as-you-go basis. This means you only
need to pay for what you use (which can be made more cost-effective by
the efficient use of auto-scaling). Cloud-based IaC tools are an ideal
and cost-effective solution for scenarios where infrastructure needs to
be automatically scaled up and down on demand. For example, if an online
retailer is expecting an increase in traffic over Black Friday weekend
or over the holiday period, they may want to scale up their resources
but not have to pay for those resources when traffic returns to an
average rate.</p>
<p>When
comparing cloud-based infrastructure as code with on-premises
infrastructure as code, it primarily comes down to the location of the
infrastructure and what tools are used in their management and
provisioning. Cloud-based IaC uses virtual elastic resources, which are
charged on a pay-as-you-go basis and provided by a CSP, whereas on-prem IaC deals with physical hardware.</p>
<p><strong>Benefits</strong></p>
<p>Let’s
examine how the above-mentioned differences translate into benefits
depending on specific use cases. Here are some of the benefits of each
to give you an idea of when you might use on-prem IaC and Cloud based
IaC:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/b85b36e8d1cc6a9e0a38c0e8ad908124.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/b85b36e8d1cc6a9e0a38c0e8ad908124.png" />
    
  </figure>
</p>
<p><strong>On-prem IaC:</strong> The
main advantage of on-premises infrastructure as code is that it allows
complete control. This complete control is sometimes required due to
regulations/security and compliance requirements. This is common in
bigger banking corporations or businesses that deal with
customer-sensitive or government data. These regulations can call for
data sovereignty (meaning the data has to be stored and processed within
the country). Whilst cloud providers offer specialised government cloud
environments for some of these cases (e.g. us gov cloud in AWS),
these offerings are only available in certain regions; for regions like
Africa, there is no dedicated government cloud, meaning on-premises
infrastructure as code would need to be used to adhere to strict
security/compliance requirements.</p>
<p><strong>Cloud-based IaC:</strong> It
has many advantages for fast-paced and growing businesses. The
scalability allows infrastructure to be rapidly scaled up or down to
meet fluctuating demand without the constraints of physical on-premises
infrastructure. Cloud-based infrastructure also allows infrastructure to
be deployed globally across different regions, reducing user latency,
which can be essential for businesses that need to provide a service to
customers worldwide with little to no latency, like online gaming. With
cloud providers billing on a pay-as-you-go basis, this can mean that
companies can pay only for the infrastructure that they need/use,
meaning investment doesn’t need to be made into physical hardware and
the maintenance of that hardware.</p>


<h2 class="relative group">KURBENETES 
    <div id="kurbenetes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#kurbenetes" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Kubernetes 101</p>


<h1 class="relative group">A New Dawn 
    <div id="a-new-dawn" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#a-new-dawn" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>To
better understand Kubernetes, let us first consider the context of its
emergence. In other words, why was it needed in the first place? Back in
the day, it was more common for companies to have a monolithic
architecture. That is, an application is built as a single unit, a
single code base, and usually, a single executable deployed as a single
component. This worked and still works for a lot of companies; however,
some companies started to switch to a microservices architecture, so
instead of having one monolithic application, it would be broken down
into different components, each of these components usually having
different business functions, meaning high demand business functions can
be scaled without having to scale the entire application. One
high-profile example of this happened in 2009 (before microservices even
had a name) when Netflix had issues meeting their increased demands
with their monolithic architecture, and so began the adoption of
microservices architecture.</p>
<p>Microservices
architecture is now an increasingly popular approach, and the reason why
this is so important for today&rsquo;s lesson is that container technologies
offer the perfect host for these microservices. With microservices
architecture often comprising hundreds or even thousands of these
containers, there was a need for a technology to help manage and
organise them - no prizes for guessing what technology came to the
rescue.</p>


<h1 class="relative group">Enter Kubernetes 
    <div id="enter-kubernetes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#enter-kubernetes" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Let&rsquo;s
start with the big question, shall we? What is Kubernetes? In the
previous rooms in this module, we discussed containers and Docker, so
let&rsquo;s use that as our jumping-off point. Imagine you have a Docker
container that is running an app that can be accessed externally.
Suddenly, this application starts receiving a lot of traffic, so a new
container with this application needs to be spun up so the traffic can
be distributed between the two. This is where Kubernetes comes in as a
container orchestration system. The term &ldquo;orchestration&rdquo; conjures up
images of a literal orchestra. This metaphor does have some traction,
with the containers being like instruments and Kubernetes being the
conductor in control of the flow. It would just be a very strange
orchestra where the conductor tells the players to leave when they&rsquo;re no
longer needed for the song and brings new ones on when they are.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/3afbfcf74be2eb28be74009467758d5f.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/3afbfcf74be2eb28be74009467758d5f.png" />
    
  </figure>
</p>


<h1 class="relative group">The Many Benefits of Kubernetes 
    <div id="the-many-benefits-of-kubernetes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-many-benefits-of-kubernetes" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Now
that we&rsquo;ve established what Kubernetes is and why it’s needed, let&rsquo;s
look at how this technology can benefit the DevSecOps space.</p>
<ul>
<li>Kubernetes makes an application <strong>highly available and scalable</strong>. It does this by, for example, duplicating an application (and its db
component) and load balancing external requests to this application to
an available resource, therefore removing a single point of failure from the architecture and removing bottlenecks, which can slow down
application response times. As mentioned earlier, scalability is a big
concern for many companies; Kubernetes allows workloads to be scaled up
or down to match demand.</li>
<li>Kubernetes is also <strong>highly portable</strong> in that it can be run anywhere with nearly any type of infrastructure and
can be used with a single or multi-cloud set, making it a very flexible
tool.</li>
<li>Another benefit of Kubernetes is its popularity; because of this, many
technologies are compatible with it and can be used to make each tool
more powerful.</li>
</ul>
<p>These are just a few ways Kubernetes benefits the DevSecOps space, and it explains why that word is thrown around so much!</p>
<p>Kubernetes Architecture</p>


<h1 class="relative group">Cluster Architecture 
    <div id="cluster-architecture" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#cluster-architecture" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Okay,
so we&rsquo;ve learned what Kubernetes is, why it&rsquo;s needed and how it can
benefit us in DevSecOps. Now, it&rsquo;s time to deepen our understanding by
looking under the hood and analysing how it can do what it does. That&rsquo;s
right! It&rsquo;s architecture time! We will go through each key component
that makes up Kubernetes architecture, one by one, before putting it all
together at the end and showing how all these components connect. Let&rsquo;s
get into it!</p>
<p><strong>Kubernetes Pod</strong></p>
<p>Pods
are the smallest deployable unit of computing you can create and manage
in Kubernetes. When you work in DevSecOps with Kubernetes, you&rsquo;ll hear a
lot of this word. You can think of a pod as a group of one or more
containers. These containers share storage and network resources.
Because of this, containers on the same pod can communicate easily as if
they were on the same machine whilst maintaining a degree of isolation.
Pods are treated as a unit of replication in Kubernetes; if a workload
needs to be scaled up, you will increase the number of pods running.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/98b54b6b8427fae556be0cdd516b9e36.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/98b54b6b8427fae556be0cdd516b9e36.svg" />
    
  </figure>
</p>
<p>Kubernetes Nodes</p>
<p>Kubernetes
workloads (applications) are run inside containers, which are placed in
a pod. These pods run on nodes. When talking about node architecture,
there are two types to consider. The <strong>control plane</strong> (also known as &ldquo;master node&rdquo;) and <strong>worker nodes</strong>.
Both of these have their own architecture/components, so let&rsquo;s take a
look at them. Nodes can either be a virtual or physical machine. Think
of it this way: if applications run in containers which are placed in a
pod, nodes contain all the services necessary to run pods.</p>
<p><strong>Kubernetes Cluster</strong></p>
<p>At the highest level, we have our Kubernetes Cluster; put simply, a Cluster is just a set of nodes.</p>


<h1 class="relative group">The Kubernetes Control Plane 
    <div id="the-kubernetes-control-plane" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-kubernetes-control-plane" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The
control plane manages the worker nodes and pods in the cluster. It does
this with the use of various components. Take a look at each of the
components and what they are responsible for. Then see them all put
together in a control plane architecture diagram.</p>
<p><strong>Kube-apiserver</strong></p>
<p>The
API server is the front end of the control plane and is responsible for
exposing the Kubernetes API. The kube-apiserver component is scalable,
meaning multiple instances can be created so traffic can be
load-balanced.</p>
<p><strong>Etcd</strong></p>
<p>Etcd
is a key/value store containing cluster data / the current state of the
cluster. It is highly available and consistent. If a change is made in
the cluster, for example, another pod is spun up, this will be reflected
in the key/value store, etcd. The other control plane components rely
on etcd as an information store and query it for information such as
available resources.</p>
<p><strong>Kube-scheduler</strong></p>
<p>The
kube-scheduler component actively monitors the cluster. Its job is to
catch any newly created pods that have yet to be assigned to a node and
make sure it gets assigned to one. It makes this decision based on
specific criteria, such as the resources used by the running application
or available resources on all worker nodes.</p>
<p><strong>Kube-controller-manager</strong></p>
<p>This
component is responsible for running the controller processes. There
are many different types of controller processes, but one example of a
controller process is the <strong>node controller</strong> process, which is
responsible for noticing when nodes go down. The controller manager
would then talk to the scheduler component to schedule a new node to
come up.</p>
<p>Cloud-controller-manager</p>
<p>This
component enables communication between a Kubernetes cluster and a
cloud provider API. The purpose of this component is to allow the
separation of components that communicate internally within the cluster
and those that communicate externally by interacting with a cloud
provider. This also allows cloud providers to release features at their
own pace.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/84f898f84e80373f4a4a34e1f658d914.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/84f898f84e80373f4a4a34e1f658d914.svg" />
    
  </figure>
</p>


<h1 class="relative group">Kubernetes Worker Node 
    <div id="kubernetes-worker-node" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#kubernetes-worker-node" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Worker
nodes are responsible for maintaining running pods. Let&rsquo;s take a look
at the components, which are present on every worker node, and what they
are responsible for:</p>
<p><strong>Kubelet</strong></p>
<p>Kubelet
is an agent that runs on every node in the cluster and is responsible
for ensuring containers are running in a pod. Kubelet is provided with
pod specifications and ensures the containers detailed in this pod
specification are running and healthy! It executes actions given to it
by the controller manager, for example, starting the pod with a
container inside.</p>
<p><strong>Kube-proxy</strong></p>
<p>Kube-proxy
is responsible for network communication within the cluster. It makes
networking rules so traffic can flow and be directed to a pod (from
inside or outside of the cluster). Traffic won&rsquo;t hit a pod directly but
instead hit something called a Service (which would be associated with a
group of pods), and then gets directed to one of the associated pods.
More on services in the next task!</p>
<p><strong>Container runtime</strong></p>
<p>Pods
have containers running inside of them. A container runtime must be
installed on each node for this to happen. So far, we have covered one
example of this in this module, which is probably the most popular
choice, Docker. However, some alternatives can be used, such as rkt or
runC.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/1bf22d1f65ab408e71d15d5049d11129.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/1bf22d1f65ab408e71d15d5049d11129.svg" />
    
  </figure>
</p>


<h1 class="relative group">Communication Between Components 
    <div id="communication-between-components" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#communication-between-components" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Okay,
so we&rsquo;ve covered a lot there. Let&rsquo;s take a step and look at how all
those individual components we&rsquo;ve just covered work together to make up
Kubernetes architecture. A Kubernetes cluster contains nodes and
Kubernetes runs a workload by placing containers into pods that run on
these nodes. Take a look at the graphic below to see how all these
components come together.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/1eba5a686238be009bc802dd419a09c8.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/1eba5a686238be009bc802dd419a09c8.svg" />
    
  </figure>
</p>
<p>Kubernetes Landscape</p>


<h1 class="relative group">The Lay of the Land 
    <div id="the-lay-of-the-land" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-lay-of-the-land" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>So
we&rsquo;ve just looked at Kubernetes architecture and how things work and
are set up behind the scenes! Now it&rsquo;s time to show you the lay of the
land. In other words, what, as a DevSecOps engineer, would you be
interacting with daily? We will go through some of the most common
concepts in Kubernetes and break down what they are.</p>
<p><strong>Namespaces</strong></p>
<p>In
Kubernetes, namespaces are used to isolate groups of resources in a
single cluster. For example, say you want to group resources associated
with a particular component, or if you are using a cluster to host
multiple tenants, to group resources by tenant. Resources must be
uniquely named within a namespace, but the same resource name can be
used across various namespaces.</p>
<p><strong>ReplicaSet</strong></p>
<p>As
the name suggests, a ReplicaSet in Kubernetes maintains a set of
replica pods and can guarantee the availability of x number of identical
pods (identical pods are helpful when a workload needs to be
distributed between multiple pods). ReplicaSets usually aren&rsquo;t defined
directly (neither are pods, for that matter) but are instead managed by a
deployment, which brings us to our next concept.</p>
<p><strong>Deployments</strong></p>
<p>Deployments
in Kubernetes are used to define a desired state. Once this desired
state is defined, the deployment controller (one of the controller
processes) changes the actual state to the desired state. Deployments
provide declarative updates for pods and replica sets. In other words,
as a user, you can define a deployment, let&rsquo;s say, for example,
&ldquo;test-nginx-deployment&rdquo;. In the definition, you can note that you want
this deployment to have a ReplicaSet comprising three nginx pods. Once
this deployment is defined, the ReplicaSet will create the pods in the
background.</p>
<p><strong>StatefulSets</strong></p>
<p>To
understand what Kubernetes Statefulsets are, you must first understand
the difference between stateful and stateless apps. Stateful apps store
and record user data, allowing them to return to a particular state. For
example, suppose you have an open session using an email application
and read 3 emails, but your session is interrupted. In that case, you
can reload this application, and the state will have saved, ensuring
these 3 emails are still read. Stateless applications, however, have no
knowledge of any previous user interactions as it does not store user
session data. For example, think of using a search engine to ask a
question. If that session were to be interrupted, you would start the
process again by searching the question, not relying on any previous
session data.</p>
<p>For these stateless applications
(search engine example), deployments can be used to define and manage
pod replicas. Because of the application&rsquo;s stateless nature, replicas
can be created with random pod names, and when removed, a pod can be
deleted at random.</p>
<p>However, this is not the
case for stateful applications (email example), because stateful
applications need to access and update the current state of the user
session. Imagine this current state is being stored in a database
running across 3 pods (meaning the database is replicated 3 times). Now,
what happens when one of the databases is updated? This would leave 2
of the databases out of sync. This is where StatefulSets come in and is
why you would use that instead of a deployment to manage stateful
applications in Kubernetes.</p>
<p>Statefulsets
enable stateful applications to run on Kubernetes, but unlike pods in a
deployment, they cannot be created in any order and will have a unique
ID (which is persistent, meaning if a pod fails, it will be brought back
up and keep this ID) associated with each pod. In other words, these
pods are created from the same specification but are not
interchangeable. StatefulSets will have one pod that can read/write to
the database (because there would be absolute carnage and all sorts of
data inconsistency if the other pods could), referred to as the master
pod. The other pods, referred to as slave pods, can only read and have
their own replication of the storage, which is continuously synchronised
to ensure any changes made by the master node are reflected.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/3c0a1d5471d84bd4b86ae3e5a9fefa1f.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/3c0a1d5471d84bd4b86ae3e5a9fefa1f.svg" />
    
  </figure>
</p>
<p><strong>Services</strong></p>
<p>To
best understand services in Kubernetes, it&rsquo;s important to understand
the problem they are solving. Kubernetes pods are ephemeral, meaning
they have a short lifespan and are spun up and destroyed regularly.
Imagine now a connection needs to be made to these pods. This could be
from within the cluster; maybe a back-end application is running in
these pods, and a front-end application needs to access them, or perhaps
the request is coming from a browser, and these pods are running a web
application. For this connection to happen, an IP address is required.
If IP addresses were tied to pods, then these IP addresses would change
frequently, causing all kinds of issues; services are used so that a
single static IP address can be associated with a pod and its replicas.
In other words, a service is placed in front of these pods and exposes
them, acting as an access point. Having this single access point allows
for requests to be load-balanced between the pod replicas. There are
different types of services you can define: ClusterIP, LoadBalancer,
NodePort and ExternalName. To learn more about these types and services
in general, check out <a href="https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types" target="_blank">here</a>.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/263deb8228845aed0db78319097bd63b.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/263deb8228845aed0db78319097bd63b.svg" />
    
  </figure>
</p>
<p><strong>Ingress</strong></p>
<p>In
the above section on Kubernetes services, we mentioned an example of an
application which can be made accessible by using a service to expose
the pods running this application (let&rsquo;s call this service A). Imagine
now that this web application has a new feature. This new feature
requires its own application and so has its own set of pods, which are
being exposed by a separate service (let&rsquo;s call this service B). Now,
let&rsquo;s say a user requests to access this new feature of the web
application; there will need to be some kind of traffic routing in place
to ensure this request gets directed to service B. That is where
ingress comes in. Ingress acts as a single access point to the cluster
and means that all routing rules are in a single resource.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/1b0ab1f0b6ee779c1ee6f2a3f4d4924c.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/1b0ab1f0b6ee779c1ee6f2a3f4d4924c.svg" />
    
  </figure>
</p>


<h1 class="relative group">DevOps vs. DevSecOps in K8s 
    <div id="devops-vs-devsecops-in-k8s" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#devops-vs-devsecops-in-k8s" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>This
task has shown you some of the Kubernetes resources that work together
to make a cluster. Next up, we&rsquo;re going to discuss how we interact with
this cluster to create these components, but before we do that, this
would be a good moment to discuss the division of labour in the world of
K8s. It&rsquo;s important to understand, especially when learning for a
certain career path, the difference between DevOps and DevSecOps
responsibilities. At a very high level, you can think of DevOps tasks as
those associated with building a cluster and DevSecOps tasks as those
associated with securing a cluster. There will, of course, be some
overlap depending on company architecture or corporate set-up, but
generally, these tasks can be defined as one or the other. As this room
serves as an introduction, it begins by showing you the building blocks
of a Kubernetes cluster and how to interact with these resources (DevOps
tasks). As this knowledge is foundational, understanding these concepts
will help you in the later tasks when we discuss securing the cluster
(DevSecOps tasks). That being said, as mentioned, the distinction is
important, especially for those pursuing a specific career path, so keep
this in mind going forward!</p>
<p>Kubernetes Configuration</p>


<h1 class="relative group">Time to Configure 
    <div id="time-to-configure" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#time-to-configure" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Now
that we&rsquo;ve covered some of the key components used in Kubernetes, let&rsquo;s
combine some of them and walk you through how this would be configured!
The example we will use is a deployment which controls a ReplicaSet,
which manages pods exposed by a service.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/a0872c63c555b82e63ce1ea3dbed6c42.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/a0872c63c555b82e63ce1ea3dbed6c42.svg" />
    
  </figure>
</p>
<p>To
configure this setup, we would require two configuration files, one for
the deployment and one for the service. Before giving you an example of
how each of these files works, let&rsquo;s go over some of the basics of
configuration in Kubernetes that will be consistent across these two
files (and all configuration files, for that matter).</p>
<p>First,
let&rsquo;s discuss the file format. Kubernetes config files are typically
written in YAML. They can also be made interchangeably using the JSON
format, but as per the Kubernetes documentation, it is generally
considered best practice to use YAML given its easy, human-readable
nature (just gotta keep an eye on that indentation!).</p>
<p><strong>Required Fields</strong></p>
<p>Next,
let&rsquo;s discuss the four fields which must be present in each of the YAML
files, breaking down what will need to be included in each one:</p>
<p><strong>apiVersion:</strong>
The version of the Kubernetes API you are going to use to create this
object. The API version you use will depend on the object being defined.
A cheatsheet for what API version to use for which object can be found <a href="https://matthewpalmer.net/kubernetes-app-developer/articles/kubernetes-apiversion-definition-guide.html" target="_blank">here</a>.</p>
<p><strong>kind:</strong> What kind of object you are going to create (e.g. Deployment, Service, StatefulSet).</p>
<p><strong>metadata:</strong> This will contain data that can be used to uniquely identify the object (including name and an optional namespace).</p>
<p><strong>spec:</strong> The desired state of the object (for deployment, this might be 3 nginx pods).</p>
<p><strong>Configuring Resources</strong></p>
<p>Those
are the very basics of Kubernetes YAML configuration files. Let&rsquo;s
consider those and look now at the two files mentioned above. We&rsquo;re
going to take a look at the service config file first, as when defining a
deployment and service, it is generally best practice to first define
the service before the back-end deployment/replicaset that it points to
(this is because when Kubernetes starts a container, it creates an env
variable for each service that was running when a container started).
Here is what our example-service.yaml file looks like:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apiVersion: v1
</span></span><span class="line"><span class="cl">kind: Service
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  name: example-nginx-service
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  selector:
</span></span><span class="line"><span class="cl">    app: nginx
</span></span><span class="line"><span class="cl">  ports:
</span></span><span class="line"><span class="cl">    - protocol: TCP
</span></span><span class="line"><span class="cl">      port: <span class="m">8080</span>
</span></span><span class="line"><span class="cl">      targetPort: <span class="m">80</span>
</span></span><span class="line"><span class="cl">  type: ClusterIP
</span></span></code></pre></div><p>Let&rsquo;s break that down: <strong>apiVersion</strong> is set to v1 (the version of the Kubernetes API best used for this simple service example), and <strong>kind</strong> is set to service. For the <strong>metadata</strong>, we just called this service &ldquo;example-nginx-service&rdquo;. The <strong>spec</strong>
is where it gets more interesting, under &lsquo;selector&rsquo;, we have &lsquo;app:
nginx&rsquo;. This is going to be important going forward when we define our
deployment configuration, as is the <strong>ports</strong> information, as we are
essentially saying here: &ldquo;This service will look for apps with the nginx
label and will target port 80. An important distinction to make here is
between the &lsquo;port&rsquo; and &rsquo;targetPort&rsquo; fields. The &rsquo;targetPort&rsquo; is the
port to which the service will send requests, i.e., the port the pods
will be listening on. The &lsquo;port&rsquo; is the port the service is exposed on.
Finally, the &rsquo;type&rsquo; is defined as ClusterIP (earlier, we discussed that
there were multiple types of services, and this is one of them), which
is the default service type. Now let&rsquo;s take a look at the Deployment
YAML and define the back end which this service will point to:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apiVersion: apps/v1
</span></span><span class="line"><span class="cl">kind: Deployment
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  name: example-nginx-deployment
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  replicas: <span class="m">3</span>
</span></span><span class="line"><span class="cl">  selector:
</span></span><span class="line"><span class="cl">    matchLabels:
</span></span><span class="line"><span class="cl">      app: nginx
</span></span><span class="line"><span class="cl">  template:
</span></span><span class="line"><span class="cl">    metadata:
</span></span><span class="line"><span class="cl">      labels:
</span></span><span class="line"><span class="cl">        app: nginx
</span></span><span class="line"><span class="cl">    spec:
</span></span><span class="line"><span class="cl">      containers:
</span></span><span class="line"><span class="cl">      - name: nginx
</span></span><span class="line"><span class="cl">        image: nginx:latest
</span></span><span class="line"><span class="cl">        ports:
</span></span><span class="line"><span class="cl">        - containerPort: <span class="m">80</span>
</span></span></code></pre></div><p>The first thing you might notice is that inside the &lsquo;spec&rsquo; field,
there is a nested field called &rsquo;template&rsquo;, which itself contains a
&lsquo;metadata&rsquo; and &lsquo;spec&rsquo; field. To understand this, remember the image at
the start of this task. We are defining a deployment which controls a
ReplicaSet; here, in the outer &lsquo;spec&rsquo; field, we tell Kubernetes we want 3
replicas (identical pods) in this ReplicaSet. This template field is
the template that Kubernetes will use to create those pods and so
requires its own metadata field (so the pod can be identified) and spec
field (so Kubernetes knows what image to run and which port to listen
on). Note that the port defined here is the same as the one in the
service YAML. This is because the service&rsquo;s target port is 80 and needs
to match. As well as this, in the outer &lsquo;spec&rsquo; field, you can see we
have also set the &lsquo;selector&rsquo; field to have a &lsquo;matchLabels&rsquo;, which
matches what we defined in the &lsquo;selector&rsquo; field for the service YAML.
This is so the service is mapped to the correct pods. With these two
config YAML files, we have defined a deployment that controls a
ReplicaSet that manages 3 pods, all of which are exposed to a service.
It&rsquo;s all coming together!</p>
<p>These config files
are used to define the desired state of Kubernetes components;
Kubernetes will constantly be checking this desired state against the
current state of the cluster. Using the etcd (one of the control plane
processes mentioned in an earlier task), Kubernetes populates these
configuration files with the current state and does this comparison. For
example, if we have told Kubernetes we want 3 nginx pods running, and
it detects in the status that there are only 2 running pods, it will
begin the actions to correct this.</p>
<p>Kubectl</p>


<h1 class="relative group">Kubectl to the Rescue 
    <div id="kubectl-to-the-rescue" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#kubectl-to-the-rescue" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>We&rsquo;ve
just covered how to define the desired state of your cluster using YAML
config files, but currently, those exist only as files. To take these
from configurations to running processes, we need to interact with the
cluster. We can do this by interacting with the apiserver component of
the control plane using different methods: UI if using the Kubernetes
dashboard, API if using some sort of script or command line using a tool
called kubectl. This task focuses on the last of these. Simply put,
kubectl is a command line tool provided by Kubernetes that allows us to
communicate with a Kubernetes cluster&rsquo;s control plane and is a great
addition to your DevSecOps arsenal. This task will show you how to take
the config files outlined in the previous task and apply them, as well
as give you some boot camp training for this tool, teaching you some of
the basic commands so you can navigate a Kubernetes cluster like it&rsquo;s
your back garden!</p>
<p><strong>Kubectl apply</strong></p>
<p>Once
you have defined your deployment and service configurations in the YAML
file, the next step would be to apply them so Kubernetes can take the
desired configuration and turn it into a running process(s). This is
done using the aptly named apply command. For example, if applying the
service YAML mentioned in the previous task, that would look like this:</p>
<pre tabindex="0"><code>kubectl apply -f example-deployment.yaml
</code></pre><p><strong>Kubectl get</strong></p>
<p>Once
both configurations have been applied, you&rsquo;ll want to check the status
of both to ensure things are running as expected. This would be done
using the Kubectl get command. This is a very versatile command, and you
will be using it a lot in your time with Kubernetes. The get command
can be used to check the state of resources. The resource type will
follow &lsquo;get&rsquo;, then <code>-n</code> or <code>--namespace</code>
followed by the namespace (unless you are checking a cluster-level
resource like a node). For example, to check the state of a deployment,
you would use:</p>
<pre tabindex="0"><code>kubectl get pods -n example-namespace
</code></pre><p>The output for this command would look something like this:</p>
<p>Terminal</p>
<pre tabindex="0"><code>user@tryhackme$ kubectl get pods -n example-namespaceNAME          READY   STATUS              RESTARTS   AGE
example-pod   1/1     Running             0          2m18s
</code></pre><p>As mentioned, this command can be used to check on a variety of resources such as deployments, services, pods, and ReplicaSets.</p>
<p><strong>Kubectl describe</strong></p>
<p>This
command can be used to show the details of a resource (or a group of
resources). These details can help in troubleshooting or analysis
situations. For example, say one of the pods in your cluster has started
erroring out, and you want to get more information about the pod to try
to determine why it has crashed. You would run the following command:</p>
<pre tabindex="0"><code>kubectl describe pod example-pod -n example-namespace
</code></pre><p>This would give you back some details about the erroring pod. For example:</p>
<p>Terminal</p>
<pre tabindex="0"><code>user@tryhackme$ kubectl describe pod example-pod -n example-namespaceName:             example-pod
Namespace:        example-namespace
Priority:         0
Service Account:  default
Node:             minikube/192.168.49.2
Start Time:       Mon, 22 Jan 2024 14:01:14 +0000
Labels:           &lt;none&gt;
Annotations:      &lt;none&gt;
Status:           Running
IP:               10.244.0.21
...
...
</code></pre><p>You can see here that the describe command details
contain some &ldquo;events&rdquo;. These events can help shine a light on what the
issue is. For more details surrounding this event, Kubernetes captures
logs from each container in a running pod. These logs can be viewed
using our next command.</p>
<p><strong>Kubectl logs</strong></p>
<p>Say
you want to view the application logs of the erroring pods. Maybe you
want to view the logs surrounding the event error. For this, we would
use the kubectl logs command. Here is an example of how this would be
used:</p>
<pre tabindex="0"><code>kubectl logs example-pod -n example-namespace
</code></pre><p>These logs can provide valuable insight not just for troubleshooting but for security analysis as well.</p>
<p><strong>Kubectl exec</strong></p>
<p>Now,
let&rsquo;s say the log information was helpful, but there are still some
unanswered questions, and you want to dig deeper and access the
container&rsquo;s shell. The kubectl exec command will allow you to get inside
a container and do this! If a pod has more than one container, you can
specify a container using the <code>-c</code> or <code>--container</code> flag. The command for this is (the <code>-it</code> flag runs the command in interactive mode, everything after <code>--</code> will be run inside the container):</p>
<pre tabindex="0"><code>kubectl exec -it example-pod -n example-namespace -- sh
</code></pre><p>From here, you can run any command you want from
within the container itself. Maybe you want to snoop around for your
security analysis or run a command to test connectivity from the
container.</p>
<p><strong>Kubectl port-forward</strong></p>
<p>Another
handy command is kubectl port-forward. This command allows you to
create a secure tunnel between your local machine and a running pod in
your cluster. An example of when this might be useful is when testing an
application. Let&rsquo;s imagine we have an nginx web application running
across 3 pods which are exposed by a web application service. If you
remember, a service makes a pod externally accessible. We take the port
that is used to expose these pods and map it to one of our local ports.
For example, matching the target port (the port the service is exposed
on, which in our configuration example was 8080) to local port 8090
would make this web application accessible on our local machine at <code>http://localhost:8090</code>. The resources specified are <code>resource-type/resource-name</code>. This would be done using the kubectl port-forward command with the following syntax :</p>
<pre tabindex="0"><code>kubectl port-forward service/example-service 8090:8080
</code></pre><p>There
are, of course, plenty more kubectl commands that can be used to
navigate and interact with a Kubernetes cluster, but the ones covered
give you a solid foundation, and you can perform some day-to-day
DevSecOps tasks using only these. You will get a chance to demo these
commands in this room&rsquo;s practical exercise in Task 8.</p>
<p>Now complete these questions: What command would follow &lsquo;kubectl&rsquo; if you wanted to&hellip;.</p>
<p>Kubernetes &amp; DevSecOps</p>
<p>Okay, by now, you&rsquo;re
getting pretty familiar with Kubernetes; it&rsquo;s becoming less of an
acquaintance and more of a friend. You&rsquo;ve learned the ins and outs of
the tool and will soon get a chance to have a hands-on demo of it, but
before any of that, let&rsquo;s look at exactly how YOU would use this tool as
a DevSecOps engineer. After all, that&rsquo;s very likely why you&rsquo;re here!</p>


<h1 class="relative group">Kubernetes and Security 
    <div id="kubernetes-and-security" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#kubernetes-and-security" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Before
we dive into what a DevSecOps engineer would be responsible for in a
Kubernetes cluster, let&rsquo;s consider Kubernetes from a security
perspective to give some context. Kubernetes is, relatively speaking,
new on the block. That is to say, it is an emerging technology. It&rsquo;s
emerging but very popular, with many companies adopting Kubernetes,
especially young tech and start-up companies.</p>
<p>Introducing
any tool into a system is considered an increased security risk as a
new tool means a new potential way into that system. These risks are
amplified when dealing with a tool like Kubernetes, where you have a
network of pods that can communicate with each other. The default
setting allows any pod to communicate with another. This implies all
kinds of security considerations. As a DevSecOps engineer, it is your
responsibility to ensure these channels are secure.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/3d57119b77c26780bd73a7d282bee799.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/3d57119b77c26780bd73a7d282bee799.png" />
    
  </figure>
</p>


<h1 class="relative group">Kubernetes Hardening 
    <div id="kubernetes-hardening" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#kubernetes-hardening" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Container
hardening is one way in which DevSecOps engineers can secure these
channels, and we will dive into that later in this module with the <a href="https://tryhackme.com/room/containerhardening" target="_blank">Container Hardening</a>
room. It is the process of using container scanning tools to detect
CVEs present in a cluster and remediate them to ensure minimal security
breach risk.</p>
<p>Kubernetes hardening is precisely
that, ensuring these channels are secure by fortifying your cluster
following best container security practices that you would perform as a
DevSecOps engineer. Various companies and government agencies have
defined these best practices; let&rsquo;s go over each area in which we can
strengthen our container security and how this can be done.</p>
<p><strong>Secure your Pods!</strong></p>
<p>Let&rsquo;s begin with a few ways to secure the pods themselves. Some best practices for pod security include:</p>
<ul>
<li>Containers that run applications should not have root privileges</li>
<li>Containers should have an immutable filesystem, meaning they cannot be altered or
added to (depending on the purpose of the container, this may not be
possible)</li>
<li>Container images should be frequently scanned for vulnerabilities or misconfigurations</li>
<li>Privileged containers should be prevented</li>
<li><a href="https://kubernetes.io/docs/concepts/security/pod-security-standards/" target="_blank">Pod Security Standards</a> and <a href="https://kubernetes.io/docs/concepts/security/pod-security-admission/" target="_blank">Pod Security Admission</a></li>
</ul>
<p><strong>Hardening and Separation of your Network!</strong></p>
<p>In
the introduction to this task, one thing especially was flagged as a
big security risk: communication. That communication happens over a
network, and it&rsquo;s your job as a DevSecOps engineer to ensure this
communication is secure. This can be done using the following best
practices:</p>
<ul>
<li>Access to the control plane node should be restricted using a firewall and role-based access control in an isolated network</li>
<li>Control plane components should communicate using Transport Layer Security (TLS) certificates</li>
<li>An explicit deny policy should be created</li>
<li>Credentials and sensitive information should not be stored as plain text in
configuration files. Instead, they should be encrypted and in Kubernetes secrets</li>
</ul>
<p><strong>Using Authentication and Authorisation Optimally</strong></p>
<p>It
wouldn&rsquo;t be a security lesson if we didn&rsquo;t talk about authentication
and authorisation, of course! Kubernetes is no different. Here are some
best practices which can help make sure you are making efficient use of
Kubernetes authentication and authorisation features:</p>
<ul>
<li>Anonymous access should be disabled</li>
<li>Strong user authentication should be used</li>
<li>RBAC policies should be created for the various teams using the cluster and the service accounts utilised</li>
</ul>
<p><strong>Keeping an Eye Out</strong></p>
<p>You
can&rsquo;t rest easy knowing your Kubernetes cluster is secure if you don&rsquo;t
know what&rsquo;s going on in your Kubernetes cluster. Here are some logging
best practices to ensure you know exactly what is going on in your
cluster and can detect threats when they appear:</p>
<ul>
<li>Audit logging should be enabled</li>
<li>A log monitoring and alerting system should be implemented</li>
</ul>
<p><strong>Security Never Sleeps</strong></p>
<p>This
is in no way an endorsement of a sleepless lifestyle; DevSecOps
engineers do, in fact, need to sleep! Being secure is one thing, staying
secure is another. Here are some best practices to ensure your cluster
stays a safe haven:</p>
<ul>
<li>Security patches and updates should be applied quickly</li>
<li>Vulnerability scans and penetration tests should be done semi-regularly</li>
<li>Any obsolete components in the cluster should be removed</li>
</ul>


<h1 class="relative group">Kubernetes Security Best Practices in Action 
    <div id="kubernetes-security-best-practices-in-action" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#kubernetes-security-best-practices-in-action" aria-label="Anchor">#</a>
    </span>        
    
</h1>


<h1 class="relative group"> 
    <div id="heading" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#heading" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/6269219b0a19bf47cf26f89bee511374.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/6269219b0a19bf47cf26f89bee511374.png" />
    
  </figure>
</p>
<p>The above information tells us there are <strong>a lot</strong>
of ways to harden a Kubernetes infrastructure. There are so many, in
fact, that breaking down each practice would turn this room into a
self-published e-book. With the opportunity to get your hands on
Kubernetes just a task away, let&rsquo;s finish this one by breaking down just
three of them.</p>
<p><strong>RBAC</strong></p>
<p>RBAC
(Role-Based Access Control) in Kubernetes regulates access to a
Kubernetes cluster and its resources based on defined roles and
permissions. These permissions (permission to create/delete x resource,
etc.) are assigned to users, groups or service accounts. RBAC is a good
way to ensure the resources in your cluster can only be accessed by
those who <strong>need</strong> to access it. RBAC can be configured using a YAML
file (same as defining a resource) where specific rules can be defined
by declaring the resource type and verbs. Verbs are the actions being
restricted, such as &lsquo;create&rsquo; and &lsquo;get&rsquo;.</p>
<p><strong>Secrets Management</strong></p>
<p>A Kubernetes secret is an object used to store sensitive information (like credentials, OAuth tokens or SSH keys). Secrets are a good
way to ensure that sensitive data isn&rsquo;t leaked and allow for more
control over how this information is used. Secrets are stored as a
base64 encoded string, unencrypted by default. For security, it is best
to configure encryption at rest. Another way to promote secure secrets
management in your Kubernetes cluster is to configure the least
privilege access to secrets using RBAC.</p>
<p><strong>PSA (Pod Security Admission) and PSS (Pod Security Standards)</strong></p>
<p>Pod
Security Standards are used to define security policies at 3 levels
(privileged, baseline and restricted) at a namespace or cluster-wide
level. What these levels mean:</p>
<ul>
<li>Privileged: This is a near unrestricted policy (allows for known privilege escalations)</li>
<li>Baseline: This is a minimally restricted policy and will prevent known privilege
escalations (allows deployment of pods with default configuration)</li>
<li>Restricted: This heavily restricted policy follows the current pod hardening best practices</li>
</ul>
<p>Pod
Security Admission (using a Pod Security Admission controller) enforces
these Pod Security Standards by intercepting API server requests and
applying these policies.</p>
<p><strong>Note:</strong>
Previously, the roles of PSA and PSS were fulfilled using PSPs (Pod
Security Policies); however, as of Kubernetes v1.25, these have been
removed. Just to save any confusion if you stumble across PSPs doing
some extracurricular Kubernetes security study!</p>
<p>As
you can see, a lot goes into fortifying a Kubernetes cluster and plenty
to keep a DevSecOps engineer busy. These are some of the best practices
involved in Kubernetes hardening. DevSecOps engineers, while following
these practices and utilising techniques such as automated security
checks, can ensure their Kubernetes environment is safeguarded against
cyber threats.</p>
<p>Hands-on with Kubernetes</p>


<h1 class="relative group">Getting Started 
    <div id="getting-started" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#getting-started" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Press the green <strong>Start</strong> <strong>Machine</strong>
button located at the top-right of this task. The machine will start in
split-view. In case it is not showing up, you can press the blue <strong>Show Split View</strong> button at the top-right of the page.</p>


<h1 class="relative group">Phase One: Explore 
    <div id="phase-one-explore" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#phase-one-explore" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/4de91b9b61095d466cc8c7ae3155f9f7.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/4de91b9b61095d466cc8c7ae3155f9f7.png" />
    
  </figure>
</p>
<p>Okay,
let&rsquo;s get going, shall we? The first thing we want to do is start our
Minikube cluster. You can do this by running the following command in
the terminal (the cluster will take a couple of minutes to start up):</p>
<pre tabindex="0"><code>minikube start
</code></pre><p>Once
the cluster has started up, you&rsquo;re ready to go! This guided walkthrough
will take you through this cluster, reinforcing knowledge taught in the
room. That being said, you have a Kubernetes cluster at your disposal,
so feel free to explore the cluster and experiment with the different
commands you have learned so far!</p>
<p>Let&rsquo;s see what&rsquo;s running already, shall we? We can do this using the following command (<code>-A</code> for all namespaces)</p>
<pre tabindex="0"><code>kubectl get pods -A
</code></pre><p>After running this, you should see a few pods running. These are the
default pods present when you first start a Kubernetes cluster (you may
recognise some of these names as they represent some of the control
plane and worker node processes). Exciting stuff! But how about we make
it more exciting by adding a deployment and service into the mix? On the
VM you will be able to find some config YAML files located here:</p>
<pre tabindex="0"><code>~/Desktop/configuration
</code></pre><p>There are two config YAMLs here of interest to us:</p>
<p><strong>nginx-deployment.yaml</strong></p>
<p>and</p>
<p><strong>nginx-service.yaml</strong></p>
<p>. Check these configuration files out using the cat command:</p>
<pre tabindex="0"><code>cat filename
</code></pre><p>Let&rsquo;s break down what we see in each of these files:</p>
<p><strong>nginx-deployment.yaml</strong></p>
<p>This is a relatively simple deployment; we can see the desired state has
been defined as a single replica pod, inside of which will be a
container running an nginx image. From the other lines, we can determine
that this pod will be used to run some kind of web app.</p>
<p><strong>nginx-service.yaml</strong></p>
<p>This, again, is a straightforward nginx NodePort service being defined
here. The eagle-eyed among you may have noticed that the &lsquo;selector:
-&gt; app: &rsquo; field matches the app label defined in the deployment, as
well as the &rsquo;targetPort&rsquo; matching the &lsquo;containerPort&rsquo; outlined in the
deployment. This service exposes the web application running in the pod,
which the deployment controls. To apply the configuration outlined in
these YAML files, we use the kubectl apply command. Remember to apply
the service file first! Like so:</p>
<pre tabindex="0"><code>kubectl apply -f nginx-service.yaml
</code></pre><pre tabindex="0"><code>kubectl apply -f nginx-deployment.yaml
</code></pre><p>Verify the replica pod is running by using the following command (not
providing any namespace flag will get all the pods in the default
namespace, which is where our pod should be):</p>
<pre tabindex="0"><code>kubectl get pods -A
</code></pre><p>You should now see a pod with &rsquo;nginx-deployment&rsquo; in its name! Our deployment has been started!</p>


<h1 class="relative group">Phase Two: Interact 
    <div id="phase-two-interact" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#phase-two-interact" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/df2a998cdc78ae2bfb98eb80650c5241.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/df2a998cdc78ae2bfb98eb80650c5241.png" />
    
  </figure>
</p>
<p>Okay,
now we have a web application running in a pod, which is being exposed
by a service. If you recall the nginx-service.yaml, the service connects
to the web application using the target port of port 80 (the port where
the container is exposed). However, the service&rsquo;s port itself is set to
8080. We want to access this service. We will do this by using the
kubectl port-forward command, which allows us to forward a port on our
localhost to the Kubernetes service port (8080). Here is the full
command to do so:</p>
<pre tabindex="0"><code>kubectl port-forward service/nginx-service 8090:8080
</code></pre><p>After running this command, open a web browser (Firefox) and access the web application at the following address:</p>
<pre tabindex="0"><code>http://localhost:8090/
</code></pre><p>Looks like a simple login terminal, but it needs credentials. Why don&rsquo;t
we see if there are any Kubernetes secrets on the cluster that can help
us log in to the terminal? Open another terminal window (so the previous
window continues to port-forward) and run the following command to see
if there are any secrets (in the default namespace):</p>
<pre tabindex="0"><code>kubectl get secrets
</code></pre><p>Ahh, there is! &ldquo;terminal-creds&rdquo; sounds like we are onto a winner! Using
the kubectl describe command, we can get more details on this secret to
see what is being stored here:</p>
<pre tabindex="0"><code>kubectl describe secret terminal-creds
</code></pre><p>In the description, we can see that two pieces of &ldquo;Data&rdquo; are being stored: a username and a password. While Kubernetes secrets</p>
<p><strong>are</strong></p>
<p>stored in plaintext and not encrypted by default, they are base64
encoded, so we pipe this command and base64 decode the output to get it
in plain text. To access this data, we can use the following command:</p>
<p>To get the username, run:</p>
<pre tabindex="0"><code>kubectl get secret terminal-creds -o jsonpath=&#39;{.data.username}&#39;| base64 --decode
</code></pre><p>To get the password, run:</p>
<pre tabindex="0"><code>kubectl get secret terminal-creds -o jsonpath=&#39;{.data.password}&#39;| base64 --decode
</code></pre><p>Use these credentials to access the login terminal. That&rsquo;s a bingo! We&rsquo;re in, and you have retrieved the flag!</p>
<p><strong>Bonus Task:</strong> For
those curious enough, you can use an alternate method to get this flag.
It will require some Kubernetes investigation on your part, but the
first breadcrumb lies in the nginx-deployment.yaml!</p>


<h1 class="relative group">Phase Three: Secure 
    <div id="phase-three-secure" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#phase-three-secure" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/8f63bc5d74b38ac585541f04b59acf9c.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/8f63bc5d74b38ac585541f04b59acf9c.png" />
    
  </figure>
</p>
<p>It&rsquo;s
great that we could access the terminal using the credentials stored in
the Kubernetes secret, but as a DevSecOps engineer, this is where our
alarm bells should be going off. Time for us to get to work with some
Kubernetes secret management. With these credentials being sensitive
information, we want to restrict access to the Kubernetes secret they
are stored in. We can do this by configuring RBAC (Role-Based Access
Control).</p>
<p>First things first, let&rsquo;s decide who it is we want to be
able to access this secret. Your DevSecOps manager has suggested that
you restrict access to a service account, which is essentially an
identity a pod can assume to interact with the Kubernetes API/cluster.
By doing this, we can maybe even set it up so that in the future, our
daily terminal tasks can be run by an application in a pod. Let&rsquo;s use
the kubectl create serviceaccount (can be abbreviated to &lsquo;sa&rsquo;) command
to make two service accounts, the &rsquo;terminal-user&rsquo; for non-admin terminal
activities (should not have access to secret) and the &rsquo;terminal-admin&rsquo;
for admin terminal activities (should have access to secret). Run these
two commands to make those service accounts:</p>
<pre tabindex="0"><code>kubectl create sa terminal-user
</code></pre><pre tabindex="0"><code>kubectl create sa terminal-admin
</code></pre><p>With those service accounts created, it&rsquo;s time to restrict access to the
&rsquo;terminal-creds&rsquo; secret so that only the &rsquo;terminal-admin&rsquo; service
account can access it. We are going to do this by defining and applying
two configurations. First of all, a Role YAML that defines the role and
what it can do (get the &rsquo;terminal-creds&rsquo; secret). Then, a Role Binding
YAML that binds the role we have defined to the &rsquo;terminal admin&rsquo; service
account. Navigate to the following directory and cat the two YAMLs to
examine how these are defined:</p>
<pre tabindex="0"><code>~/Desktop/configuration/rbac
</code></pre><p><strong>role.yaml</strong></p>
<p>Here, you can see we define a role named &ldquo;secret-admin&rdquo;. In the rules
section, we define what it is this role can do. We define the resource
(secrets), what verbs are being restricted (we are restricting the &lsquo;get&rsquo;
verb, but you could restrict others) and finally, the name of our
secret (terminal-creds).</p>
<p><strong>role-binding.yaml</strong></p>
<p>In this YAML, we bind the &rsquo;terminal-admin&rsquo; service account (in the
&lsquo;subjects&rsquo; section) with the &lsquo;secret-admin&rsquo; role defined above (in the
roleRef section).</p>
<p>Lets now apply these configurations the same way we applied the deployment and service (using kubectl apply):</p>
<pre tabindex="0"><code>kubectl apply -f role.yaml
</code></pre><pre tabindex="0"><code>kubectl apply -f role-binding.yaml
</code></pre><p>You have now configured RBAC for this Kubernetes secret! The
only thing left to do is test whether our RBAC is working. We can do
this using the kubectl auth command, which tells us if a service account
has sufficient permission to perform a specific action. Let us first
verify that the regular &rsquo;terminal-user&rsquo; service account CAN NOT access
the secret:</p>
<pre tabindex="0"><code>kubectl auth can-i get secret/terminal-creds --as=system:serviceaccount:default:terminal-user
</code></pre><p>It looks like we expected. This &ldquo;no&rdquo; response confirms that this service
account can no longer access the terminal-creds secret. Now, finally,
let us verify that our &rsquo;terminal-admin&rsquo; service account CAN access it:</p>
<pre tabindex="0"><code>kubectl auth can-i get secret/terminal-creds --as=system:serviceaccount:default:terminal-admin
</code></pre><p>With this &ldquo;yes&rdquo; output, you have confirmed RBAC is in place and
fulfilled your duty as a DevSecOps engineer, fortifying the cluster and
taking a good first step into hardening this cluster. Hope you&rsquo;ve
enjoyed taking a little tour around this Kubernetes cluster and getting
to know the basics. Until next time!</p>


<h2 class="relative group">ON-PREMISES IAC 
    <div id="on-premises-iac" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#on-premises-iac" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Why On-Premises</p>
<p>On-premises IaC refers
to using infrastructure as code to deploy systems and services on an
internal network. In essence, all the infrastructure that will host the
systems and services can be found locally in the organisation&rsquo;s data
centre.</p>


<h1 class="relative group">Reasons for On-Prem IaC 
    <div id="reasons-for-on-prem-iac" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#reasons-for-on-prem-iac" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>In the modern world, where we have several cloud providers, using
on-prem IaC may seem counter-intuitive. However, there are some cases
where on-prem IaC will suit your needs much better. The biggest benefit
is that it allows you much better control of your entire IaC pipeline.
Let&rsquo;s use another popular example, GitHub vs self-hosted GitLab, as a
case study.</p>
<p>GitHub
and GitLab are two popular source code management platforms, backed by
the popular versioning software Git, that are used by organisations.
However, deciding between the two often becomes a question of control.
If you self-host the solution using GitLab, you fully control the entire
stack. You are ultimately not only responsible for the management of
the GitLab platform, but also the underlying infrastructure. While this
is a lot more work, it also allows you to lock down access
significantly. For example, you could only allow access to your GitLab
instance via VPN, meaning it is not exposed to the internet for
everyone.</p>
<p>Conversely, using GitHub means you are shifting some of that
security responsibility. It is important to remember that GitHub is a
Software-as-a-Service (SaaS)
solution. That means that if you use GitHub, you have no control over
the infrastructure hosting your source code. Instead, you are
transferring the security responsibility of infrastructure management to
GitHub, which becomes a third party of your organisation. While these
organisations take security measures seriously, their security is not
without flaws, which can leave your organisation&rsquo;s source code <a href="https://thehackernews.com/2023/01/github-breach-hackers-stole-code.html" target="_blank">exposed</a>. This is a risk that you have to accept whenever you use a third party.</p>
<p>Extrapolating from this case study, you should see why some
organisations still prefer on-prem IaC, especially in heavily regulated
sectors, such as the financial or governmental sectors. While on-prem
IaC is definitely more effort, it provides an organisation with full
control and customisation of their IaC pipeline.</p>


<h1 class="relative group">Benefits and Drawbacks 
    <div id="benefits-and-drawbacks" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#benefits-and-drawbacks" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>To summarise why one would use on-prem IaC and determine if it is the
correct solution for your specific problem, let&rsquo;s look at the benefits
and drawbacks.</p>
<p><strong>On-prem IaC has the following benefits:</strong></p>
<ul>
<li>Allows full control of the IaC pipeline</li>
<li>The IaC pipeline can be fully customised for your exact needs</li>
<li>Data protection and regulation is easier to perform as the IaC pipeline does not host resources on third-party systems</li>
<li>While the initial investment cost of the infrastructure is high, there are no monthly fees for hosting the IaC pipeline</li>
<li>It is often easier to do small deployments</li>
</ul>
<p><strong>On-prem IaC has the following drawbacks:</strong></p>
<ul>
<li>As you are hosting your own IaC pipeline, you are fully responsible for its security and configuration</li>
<li>Scalability of deployments is not as flexible as cloud-based IaC,
which can lead to either not having sufficient resources for the
deployment or an over-investment in resources</li>
<li>The initial investment for on-prem IaC is significantly higher than cloud-based IaC</li>
</ul>
<p>Now that you understand why on-prem IaC can be used, let&rsquo;s dive into
some of the tooling that can be used to create your very own on-prem
IaC. While there are many different tools and software that can be used,
for this room, we will focus on Vagrant and Ansible as examples.</p>
<p>Vagrant Basics</p>
<p>In our on-prem IaC journey, we will start with <a href="https://developer.hashicorp.com/vagrant" target="_blank">Vagrant</a>.
Vagrant is a software solution that can be used for building and
maintaining portable virtual software development environments. In
essence, Vagrant can be used to create resources from an IaC pipeline.
You can think of Vagrant as the big brother of Docker. In the context of
Vagrant, Docker would be seen as a provider, meaning that Vagrant could
be used to not only deploy Docker instances but also the actual servers
that would host them.</p>


<h1 class="relative group">Terminology 
    <div id="terminology" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#terminology" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Before diving into using Vagrant, let&rsquo;s brush up on some terminology first.</p>
<table>
  <thead>
      <tr>
          <th>Term</th>
          <th>Definition</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Provider</td>
          <td>A Vagrant provider is the virtualisation technology that will</td>
      </tr>
      <tr>
          <td>be used to provision the IaC deployment. Vagrant can use different</td>
          <td></td>
      </tr>
      <tr>
          <td>providers such as Docker, VirtualBox, VMware, and even AWS for cloud-based deployments.</td>
          <td></td>
      </tr>
      <tr>
          <td>Provision</td>
          <td>Provision is the term used to perform an action using Vagrant. This</td>
      </tr>
      <tr>
          <td>can be actions such as adding new files or running a script to configure</td>
          <td></td>
      </tr>
      <tr>
          <td>the host created with Vagrant.</td>
          <td></td>
      </tr>
      <tr>
          <td>Configure</td>
          <td>Configure is used to perform configuration changes using Vagrant.</td>
      </tr>
      <tr>
          <td>This can be changed by adding a network interface to a host or changing</td>
          <td></td>
      </tr>
      <tr>
          <td>its hostname.</td>
          <td></td>
      </tr>
      <tr>
          <td>Variable</td>
          <td>A variable stores some value that will be used in the Vagrant deployment script.</td>
      </tr>
      <tr>
          <td>Box</td>
          <td>The Box refers to the image that will be provisioned by Vagrant.</td>
      </tr>
      <tr>
          <td>Vagrantfile</td>
          <td>The Vagrantfile is the provisioning file that will be read and executed by Vagrant.</td>
      </tr>
  </tbody>
</table>


<h1 class="relative group">Vagrant Example 
    <div id="vagrant-example" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#vagrant-example" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Let&rsquo;s take a look at a simple Vagrant provisioning script. In our example here, we have the following folder structure:</p>
<pre tabindex="0"><code>.
├── provision
│   ├── files.zip
│   └── script.sh
└── Vagrantfile
</code></pre><p>The Vagrantfile script has the following code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">Vagrant</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="s">&#34;2&#34;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">cfg</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="n">cfg</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">define</span> <span class="s">&#34;server&#34;</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">box</span> <span class="o">=</span> <span class="s">&#34;ubuntu/bionic64&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="s">&#34;testserver&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="nl">provider</span> <span class="p">:</span><span class="n">virtualbox</span> <span class="k">do</span> <span class="o">|</span><span class="n">v</span><span class="p">,</span> <span class="n">override</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">       <span class="n">v</span><span class="p">.</span><span class="n">gui</span> <span class="o">=</span> <span class="nb">false</span>
</span></span><span class="line"><span class="cl">       <span class="n">v</span><span class="p">.</span><span class="n">cpus</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">       <span class="n">v</span><span class="p">.</span><span class="n">memory</span> <span class="o">=</span> <span class="mi">4096</span>
</span></span><span class="line"><span class="cl">    <span class="n">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="nl">network</span> <span class="p">:</span><span class="n">private_network</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="o">:</span><span class="n">ip</span> <span class="o">=&gt;</span> <span class="mf">172.16.2.101</span>
</span></span><span class="line"><span class="cl">    <span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="nl">network</span> <span class="p">:</span><span class="n">private_network</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="o">:</span><span class="n">ip</span> <span class="o">=&gt;</span> <span class="mf">10.10.10.101</span>
</span></span><span class="line"><span class="cl">  <span class="n">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">cfg</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">define</span> <span class="s">&#34;server2&#34;</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">box</span> <span class="o">=</span> <span class="s">&#34;ubuntu/bionic64&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="s">&#34;testserver2&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="nl">provider</span> <span class="p">:</span><span class="n">virtualbox</span> <span class="k">do</span> <span class="o">|</span><span class="n">v</span><span class="p">,</span> <span class="n">override</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">       <span class="n">v</span><span class="p">.</span><span class="n">gui</span> <span class="o">=</span> <span class="nb">false</span>
</span></span><span class="line"><span class="cl">       <span class="n">v</span><span class="p">.</span><span class="n">cpus</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">       <span class="n">v</span><span class="p">.</span><span class="n">memory</span> <span class="o">=</span> <span class="mi">4096</span>
</span></span><span class="line"><span class="cl">    <span class="n">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cp">#Upload resources
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>    <span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">provision</span> <span class="s">&#34;file&#34;</span><span class="p">,</span> <span class="nl">source</span><span class="p">:</span> <span class="s">&#34;provision/files.zip&#34;</span><span class="p">,</span>    <span class="nl">destination</span><span class="p">:</span> <span class="s">&#34;/tmp/files.zip&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cp">#Run script
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>    <span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">provision</span> <span class="s">&#34;shell&#34;</span><span class="p">,</span> <span class="nl">path</span><span class="p">:</span> <span class="s">&#34;provision/script.sh&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">end</span>
</span></span><span class="line"><span class="cl"><span class="n">end</span>
</span></span></code></pre></div><p>In
this example, we are going to provision two servers. Both of these
servers will start with the base Ubuntu Bionic x64 image. Like Docker,
these images will be pulled from a public image repo. We could, however,
tell Vagrant where to find these images, meaning they can be pulled
from a private repo of images as well. You can see that both servers are
configured with a hostname and how many CPUs (1) and RAM
(4GB) each host will have. The first server will also have two network
interfaces with static IPs attached. The second server will have a file
called <code>files.zip</code> uploaded, and a script called <code>script.sh</code> will be executed on the host.</p>
<p>If we want to provision the entire script, we would use the command <code>vagrant up</code>.
This would provision both servers in the order specified in the
Vagrantfile. We could also decide to only provision one of the servers
by using the server name. For example, <code>testserver</code> could be provisioned using <code>vagrant up server</code>.</p>
<p>If you want to play around with VirtualBox provisioning using Vagrant, look at this <a href="https://github.com/MWR-CyberSec/tabletop-lab-creation" target="_blank">repo</a>. Using VirtualBox and Vagrant, this repo will allow you to create your very own Active Directory (AD)
network with two domain controllers, a server, and a workstation. Give
the Vagrantfile a read to see what provisioning will be performed on
each host.</p>
<p>Ansible Basics</p>
<p>The next IaC tool to learn about is <a href="https://www.ansible.com/" target="_blank">Ansible</a>.
Like Vagrant, Ansible is another suite of software tools that allows
you to perform IaC. Ansible is also open-source, making it a popular
choice for IaC pipelines and deployments. One main difference between
Ansible and Vagrant is that Ansible performs version control on the
steps executed. This means that Ansible is similar to Docker, in that it
will only perform updates on steps that require updates, instead of
requiring a full reprovision.</p>


<h1 class="relative group">Terminology 
    <div id="terminology-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#terminology-1" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Before diving into using Ansible, let&rsquo;s brush up on some terminology first.</p>
<table>
  <thead>
      <tr>
          <th>Term</th>
          <th>Definition</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Playbook</td>
          <td>An Ansible playbook is a YAML file with a series of steps that will be executed.</td>
      </tr>
      <tr>
          <td>Template</td>
          <td>Ansible allows for the creation of template files. These act as your</td>
      </tr>
      <tr>
          <td>base files, like a configuration file, with placeholders for Ansible</td>
          <td></td>
      </tr>
      <tr>
          <td>variables, which will then be injected into at runtime to create a final</td>
          <td></td>
      </tr>
      <tr>
          <td>file that can be deployed to the host. Using Ansible variables means</td>
          <td></td>
      </tr>
      <tr>
          <td>that you can change the value of the variable in a single location and</td>
          <td></td>
      </tr>
      <tr>
          <td>it will then propagate through to all placeholders in your</td>
          <td></td>
      </tr>
      <tr>
          <td>configuration.</td>
          <td></td>
      </tr>
      <tr>
          <td>Role</td>
          <td>Ansible allows for the creation of a collection of templates and</td>
      </tr>
      <tr>
          <td>instructions that are then called roles. A host that will be provisioned</td>
          <td></td>
      </tr>
      <tr>
          <td>can then be assigned one or more of these roles, executing the entire</td>
          <td></td>
      </tr>
      <tr>
          <td>template for the host. This allows you to reuse the role definition with</td>
          <td></td>
      </tr>
      <tr>
          <td>a single line of configuration where you specify that the role must be</td>
          <td></td>
      </tr>
      <tr>
          <td>provisioned on a host.</td>
          <td></td>
      </tr>
      <tr>
          <td>Variable</td>
          <td>A variable stores some value that will be used in the Ansible</td>
      </tr>
      <tr>
          <td>deployment script. Ansible can take this a step further by having</td>
          <td></td>
      </tr>
      <tr>
          <td>variable files where each file has different values for the same</td>
          <td></td>
      </tr>
      <tr>
          <td>variables, and the decision is then made at runtime for which variable</td>
          <td></td>
      </tr>
      <tr>
          <td>file will be used.</td>
          <td></td>
      </tr>
  </tbody>
</table>


<h1 class="relative group">Ansible Example 
    <div id="ansible-example" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#ansible-example" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Ansible makes use of a specific folder and file structure. The most important part of the structure is the playbook, a YAML
file that ultimately dictates what commands will be executed for
provisioning. Let&rsquo;s take a look at the typical folder structure:</p>
<pre tabindex="0"><code>.
├── playbook.yml
├── roles
│   ├── common
│   │   ├── defaults
│   │   │   └── main.yml
│   │   ├── tasks
│   │   │   ├── apt.yml
│   │   │   ├── main.yml
│   │   │   ├── task1.yml
│   │   │   ├── task2.yml
│   │   │   └── yum.yml
│   │   ├── templates
│   │   │   ├── template1
│   │   │   └── template2
│   │   └── vars
│   │       ├── Debian.yml
│   │       └── RedHat.yml
│   ├── role2
│   ├── role3
│   └── role4
└── variables
    └── var.yml
</code></pre><p>The folder structure was only expanded for the <code>common</code> role. However, this same structure would apply for roles 2 to 3.</p>
<p>Let&rsquo;s dive a little bit into what each of these files would do. Let&rsquo;s start with the playbook.yml file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">Configure</span> <span class="n">the</span> <span class="n">server</span>
</span></span><span class="line"><span class="cl">  <span class="nl">hosts</span><span class="p">:</span> <span class="n">all</span>
</span></span><span class="line"><span class="cl">  <span class="nl">become</span><span class="p">:</span> <span class="n">yes</span>
</span></span><span class="line"><span class="cl">  <span class="nl">roles</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="n">common</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="n">role3</span>
</span></span><span class="line"><span class="cl">  <span class="nl">vars_files</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="n">variables</span><span class="o">/</span><span class="n">var</span><span class="p">.</span><span class="n">yml</span>
</span></span></code></pre></div><p>As we can see, the playbook specifies that the <code>common</code> and <code>role3</code> roles should be applied for all hosts where this Ansible playbook will be executed. It will also use the <code>var.yml</code>
file to overwrite any default variables within the roles. This allows
us to only change the default variables where needed, as the defaults
will then still be applied to all other variables.</p>
<p>To execute the <code>common</code> role, Ansible will load variables from the <code>defaults/main.yml</code> file and overwrite these variables with any new values found in the <code>var.yml</code> file. It will then read and execute the <code>tasks/main.yml</code> file. This file would look something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">includeOS</span> <span class="n">specific</span> <span class="n">variables</span>
</span></span><span class="line"><span class="cl">  <span class="nl">include_vars</span><span class="p">:</span> <span class="s">&#34;{{ item }}&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nl">with_first_found</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="s">&#34;{{ ansible_distribution }}.yml&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="s">&#34;{{ ansible_os_family }}.yml&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">set</span> <span class="n">root</span> <span class="n">password</span>
</span></span><span class="line"><span class="cl">  <span class="nl">user</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nl">name</span><span class="p">:</span> <span class="n">root</span>
</span></span><span class="line"><span class="cl">    <span class="nl">password</span><span class="p">:</span> <span class="s">&#34;{{ root_password }}&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nl">when</span><span class="p">:</span> <span class="n">root_password</span> <span class="n">is</span> <span class="n">defined</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">include</span><span class="p">:</span> <span class="n">apt</span><span class="p">.</span><span class="n">yml</span>
</span></span><span class="line"><span class="cl">  <span class="nl">when</span><span class="p">:</span> <span class="n">ansible_os_family</span> <span class="o">==</span> <span class="s">&#34;Debian&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">include</span><span class="p">:</span> <span class="n">yum</span><span class="p">.</span><span class="n">yml</span>
</span></span><span class="line"><span class="cl">  <span class="nl">when</span><span class="p">:</span> <span class="n">ansible_os_family</span> <span class="o">==</span> <span class="s">&#34;RedHat&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">include</span><span class="p">:</span> <span class="n">task1</span><span class="p">.</span><span class="n">yml</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">include</span><span class="p">:</span> <span class="n">task2</span><span class="p">.</span><span class="n">yml</span>
</span></span></code></pre></div><p>The first section of the Ansible file will determine the OS
distribution of the host. It will then use this information to include
OS-specific provisioning steps. As you can see from our folder
structure, we have specific provisioning steps based on whether the
distribution is Debian or RedHat. The second section of the playbook
will set the root user&rsquo;s password. In the third section, we update the
host and install some packages. However, we only execute the installing
step matching the OS distribution. If the host is Debian, we will
execute the commands specified in the <code>apt.yml</code> file. If the host is RedHat, we will execute the commands specified in the <code>yum.yml</code> file. This allows our Ansible role to be OS distribution agnostic. Lastly, we will execute the commands contained within the <code>task1.yml</code> and <code>task2.yml</code> files. These can be any commands, such as adding files to the host or making configuration changes.</p>
<p>This is quite a lot of information to take in, but as you start using
these tools and follow along with what scripts get executed when, it
makes a lot more sense.</p>


<h1 class="relative group">Combining Vagrant and Ansible 
    <div id="combining-vagrant-and-ansible" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#combining-vagrant-and-ansible" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>While you could stick to one IaC tool for your entire pipeline, it
can often be beneficial to combine toolings. For example, Vagrant could
be used for the main deployment of hosts, and Ansible can then be used
for host-specific configuration. This way, you only use Vagrant when you
want to recreate the entire network from scratch but can still use
Ansible to make host-specific configuration changes until a full rebuild
is required. Ansible would then run locally on each host to perform
these configuration changes, while Vagrant will be executed from the
hypervisor itself. In order to do this, you could add the following to
your Vagrantfile to tell Vagrant to provision an Ansible playbook:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">provision</span> <span class="s">&#34;ansible_local&#34;</span> <span class="k">do</span> <span class="o">|</span><span class="n">ansible</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="n">ansible</span><span class="p">.</span><span class="n">playbook</span> <span class="o">=</span> <span class="s">&#34;provision/playbook.yml&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ansible</span><span class="p">.</span><span class="n">become</span> <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="n">end</span>
</span></span></code></pre></div><p>It
is also worth noting some of the differences between Vagrant and
Ansible, if you are looking to only stick to a single IaC solution:</p>
<table>
  <thead>
      <tr>
          <th><strong>Feature/Aspect</strong></th>
          <th><strong>Vagrant</strong></th>
          <th><strong>Ansible</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Configuration Language</strong></td>
          <td>Ruby (for Vagrantfiles).</td>
          <td>YAML (for Playbooks).</td>
      </tr>
      <tr>
          <td><strong>Integration with Other Tools</strong></td>
          <td>Often used with provisioning tools like Chef, Puppet, or Ansible.</td>
          <td>Can be used standalone or integrated with other CI/CD tools.</td>
      </tr>
      <tr>
          <td><strong>Complexity</strong></td>
          <td>Relatively straightforward for setting up development environments.</td>
          <td>Higher complexity for larger infrastructures and advanced configurations.</td>
      </tr>
      <tr>
          <td><strong>Scalability</strong></td>
          <td>More suited for smaller-scale, individual development environments.</td>
          <td>Highly scalable, suitable for managing complex, multi-tier applications.</td>
      </tr>
      <tr>
          <td><strong>Execution Model</strong></td>
          <td>Procedural style with sequential execution steps.</td>
          <td>Declarative model, describing the desired state of the system.</td>
      </tr>
  </tbody>
</table>
<p>Building an On-Prem IaC Workflow</p>


<h1 class="relative group">Creating an IaC Pipeline 
    <div id="creating-an-iac-pipeline" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#creating-an-iac-pipeline" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Now that we have learned the basics about on-prem IaC, it is time to
put our knowledge to the test! Start the machine attached to this task
by pressing the green <strong>Start Machine</strong> button. The machine will start in split-view. In case it&rsquo;s not showing up, you can press the blue <strong>Show Split View</strong> button at the top-right of the page.</p>
<p>Once the machine has started, you can navigate to the <code>/home/ubuntu/iac/</code> directory. All of the scripts that we will be using today can be found in this directory.</p>


<h1 class="relative group">Vagrantfile 
    <div id="vagrantfile" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#vagrantfile" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Let&rsquo;s start by taking a look at the Vagrantfile:</p>
<p>Vagrantfile</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&#34;2&#34;</span><span class="p">)</span> <span class="n">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># DB server will be the backend for our website</span>
</span></span><span class="line"><span class="cl">  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">define</span> <span class="s2">&#34;dbserver&#34;</span>  <span class="n">do</span> <span class="o">|</span><span class="n">cfg</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Configure the local network for the server</span>
</span></span><span class="line"><span class="cl">    <span class="n">cfg</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">private_network</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="s2">&#34;dhcp&#34;</span><span class="p">,</span> <span class="n">docker_network__internal</span><span class="p">:</span> <span class="n">true</span>
</span></span><span class="line"><span class="cl">    <span class="n">cfg</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">private_network</span><span class="p">,</span> <span class="n">ip</span><span class="p">:</span> <span class="s2">&#34;172.20.128.3&#34;</span><span class="p">,</span> <span class="n">netmask</span><span class="p">:</span> <span class="s2">&#34;24&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Boot the Docker container and run Ansible</span>
</span></span><span class="line"><span class="cl">    <span class="n">cfg</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="s2">&#34;docker&#34;</span> <span class="n">do</span> <span class="o">|</span><span class="n">d</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">d</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="s2">&#34;mysql&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="n">d</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;MYSQL_ROOT_PASSWORD&#34;</span> <span class="o">=&gt;</span> <span class="s2">&#34;mysecretpasswd&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">end</span>
</span></span><span class="line"><span class="cl">  <span class="n">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Webserver will be used to host our website</span>
</span></span><span class="line"><span class="cl">  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">define</span> <span class="s2">&#34;webserver&#34;</span>  <span class="n">do</span> <span class="o">|</span><span class="n">cfg</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Configure the local network for the server</span>
</span></span><span class="line"><span class="cl">    <span class="n">cfg</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">private_network</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="s2">&#34;dhcp&#34;</span><span class="p">,</span> <span class="n">docker_network__internal</span><span class="p">:</span> <span class="n">true</span>
</span></span><span class="line"><span class="cl">    <span class="n">cfg</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">private_network</span><span class="p">,</span> <span class="n">ip</span><span class="p">:</span> <span class="s2">&#34;172.20.128.2&#34;</span><span class="p">,</span> <span class="n">netmask</span><span class="p">:</span> <span class="s2">&#34;24&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Link the shared folder with the hypervisor to allow data passthrough.</span>
</span></span><span class="line"><span class="cl">    <span class="n">cfg</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">synced_folder</span> <span class="s2">&#34;./provision&#34;</span><span class="p">,</span> <span class="s2">&#34;/tmp/provision&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Boot the Docker container and run Ansible</span>
</span></span><span class="line"><span class="cl">    <span class="n">cfg</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="s2">&#34;docker&#34;</span> <span class="n">do</span> <span class="o">|</span><span class="n">d</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">d</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="s2">&#34;ansible2&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="n">d</span><span class="o">.</span><span class="n">has_ssh</span> <span class="o">=</span> <span class="n">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1"># Command will keep the container active</span>
</span></span><span class="line"><span class="cl">      <span class="n">d</span><span class="o">.</span><span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;/usr/sbin/sshd&#34;</span><span class="p">,</span> <span class="s2">&#34;-D&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">#We will connect usingSSH so override the defaults here</span>
</span></span><span class="line"><span class="cl">    <span class="n">cfg</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cfg</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">private_key_path</span> <span class="o">=</span> <span class="s2">&#34;/home/ubuntu/iac/keys/id_rsa&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">#Provision this machine using Ansible</span>
</span></span><span class="line"><span class="cl">    <span class="n">cfg</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span> <span class="s2">&#34;shell&#34;</span><span class="p">,</span> <span class="n">inline</span><span class="p">:</span> <span class="s2">&#34;ansible-playbook /tmp/provision/web-playbook.yml&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">end</span>
</span></span><span class="line"><span class="cl"><span class="n">end</span>
</span></span></code></pre></div><p>In this Vagrantfile, we can see that two machines will be provisioned.</p>
<p><strong>DB Server</strong></p>
<p>The first machine that will be provisioned is the <code>dbserver</code>. Working through the lines of code, we can see that the machine will be added to a local network and receive the IP of <code>172.20.128.3</code>. We can also see that the provision directory will be mounted as a share. Lastly, using Docker as the provider, the <code>mysql</code> image will be booted and the mysql password will be configured to be <code>mysecretpasswd</code>.</p>
<p><strong>Web Server</strong></p>
<p>The second machine that will be provisioned is the <code>webserver</code>. Similar to the <code>dbserver</code>
machine, it will be connected to the network and use Docker as its
provider. However, there are some slight differences.</p>
<p>Firstly, the webserver will expose SSH. Since we are using Docker, we
have to alter some of the default Vagrant configurations to allow
Vagrant to connect via SSH. This includes changing the username and the
private key that will be used for the connection.</p>
<p>Secondly, we can see that an Ansible playbook will be executed on the
container by looking at the following line:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">cfg</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">provision</span> <span class="s">&#34;shell&#34;</span><span class="p">,</span> <span class="kr">inline</span><span class="o">:</span> <span class="s">&#34;ansible-playbook /vagrant/provision/web-playbook.yml&#34;</span>
</span></span></code></pre></div><p>Let&rsquo;s take a look and see what this Ansible playbook will do.</p>


<h1 class="relative group">Ansible Playbook 
    <div id="ansible-playbook" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#ansible-playbook" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Let&rsquo;s start by reviewing the <code>web-playbook.yml</code> file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">hosts</span><span class="p">:</span> <span class="n">localhost</span>
</span></span><span class="line"><span class="cl">  <span class="nl">connection</span><span class="p">:</span> <span class="n">all</span>
</span></span><span class="line"><span class="cl">  <span class="nl">roles</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span> <span class="n">webapp</span>
</span></span></code></pre></div><p>This is a simple Ansible script that indicates that the webapp role will be provisioned on the host.</p>
<p>To better understand what the webapp role will entail, we can start by reviewing the <code>~/iac/provision/roles/webapp/tasks/main.yaml</code> file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">include_tasks</span><span class="p">:</span> <span class="s">&#34;db-setup.yml&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">include_tasks</span><span class="p">:</span> <span class="s">&#34;app-setup.yml&#34;</span>
</span></span></code></pre></div><p>This shows us that there will be two main portions to the Ansible
provisioning. At this point, it is worth taking a look as well at the
default values in the <code>~/iac/provision/roles/webapp/defaults/main.yml</code> file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nl">db_name</span><span class="p">:</span> <span class="n">BucketList</span>
</span></span><span class="line"><span class="cl"><span class="nl">db_user</span><span class="p">:</span> <span class="n">root</span>
</span></span><span class="line"><span class="cl"><span class="nl">db_password</span><span class="p">:</span> <span class="n">mysecretpasswd</span>
</span></span><span class="line"><span class="cl"><span class="nl">db_host</span><span class="p">:</span> <span class="mf">172.20.128.3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">api_key</span><span class="p">:</span> <span class="n">superapikey</span>
</span></span></code></pre></div><p>We will get back to these variables in a bit, but keep them in mind.</p>
<p><strong>DB Setup</strong></p>
<p>Let&rsquo;s take a look at the <code>db-setup.yml</code> file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">Create</span> <span class="n">temp</span> <span class="n">folder</span> <span class="n">forSQL</span> <span class="n">scripts</span>
</span></span><span class="line"><span class="cl">  <span class="n">ansible</span><span class="p">.</span><span class="n">builtin</span><span class="p">.</span><span class="nl">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nl">path</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">sql</span> <span class="nl">state</span><span class="p">:</span> <span class="n">directory</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">Time</span> <span class="n">delay</span> <span class="n">to</span> <span class="n">allowSQL</span> <span class="n">server</span> <span class="n">to</span> <span class="n">boot</span>
</span></span><span class="line"><span class="cl">    <span class="nl">shell</span><span class="p">:</span> <span class="n">sleep</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">Copy</span> <span class="n">DB</span> <span class="n">creation</span> <span class="n">script</span> <span class="n">with</span> <span class="n">injected</span> <span class="n">variables</span>
</span></span><span class="line"><span class="cl">    <span class="nl">template</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="nl">src</span><span class="p">:</span> <span class="n">templates</span><span class="o">/</span><span class="n">createdb</span><span class="p">.</span><span class="n">sql</span>
</span></span><span class="line"><span class="cl">      <span class="nl">dest</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">sql</span><span class="o">/</span><span class="n">createdb</span><span class="p">.</span><span class="n">sql</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">Copy</span> <span class="n">DB</span> <span class="n">SP</span> <span class="n">script</span> <span class="n">with</span> <span class="n">injected</span> <span class="n">variables</span>
</span></span><span class="line"><span class="cl">    <span class="nl">template</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="nl">src</span><span class="p">:</span> <span class="n">templates</span><span class="o">/</span><span class="n">createsp</span><span class="p">.</span><span class="n">sql</span>
</span></span><span class="line"><span class="cl">      <span class="nl">dest</span><span class="p">:</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">sql</span><span class="o">/</span><span class="n">createsp</span><span class="p">.</span><span class="n">sql</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">Create</span> <span class="n">DB</span>
</span></span><span class="line"><span class="cl">    <span class="nl">shell</span><span class="p">:</span> <span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="p">{{</span> <span class="n">db_user</span> <span class="p">}}</span> <span class="o">-</span><span class="n">p</span><span class="p">{{</span> <span class="n">db_password</span> <span class="p">}}</span> <span class="o">-</span><span class="n">h</span> <span class="p">{{</span> <span class="n">db_host</span> <span class="p">}}</span> <span class="o">&lt;</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">sql</span><span class="o">/</span><span class="n">createdb</span><span class="p">.</span><span class="n">sql</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">Create</span> <span class="n">Stored</span> <span class="n">Procedures</span>
</span></span><span class="line"><span class="cl">    <span class="nl">shell</span><span class="p">:</span> <span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="p">{{</span> <span class="n">db_user</span> <span class="p">}}</span> <span class="o">-</span><span class="n">p</span><span class="p">{{</span> <span class="n">db_password</span> <span class="p">}}</span> <span class="o">-</span><span class="n">h</span> <span class="p">{{</span> <span class="n">db_host</span> <span class="p">}}</span> <span class="o">&lt;</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">sql</span><span class="o">/</span><span class="n">createsp</span><span class="p">.</span><span class="n">sql</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">Cleanup</span> <span class="n">Scripts</span>
</span></span><span class="line"><span class="cl">    <span class="nl">shell</span><span class="p">:</span> <span class="n">rm</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">sql</span>
</span></span></code></pre></div><p>From
the script, we can see that 7 tasks will be performed. Reading through
these tasks, we can see that a temporary folder will be created where SQL scripts will be pushed to and then executed against the database host.</p>
<p>Let&rsquo;s take a look at how Ansible would inject those variables from before. Take a look at the <code>Create DB</code> task&rsquo;s shell command:</p>
<pre tabindex="0"><code>shell: mysql -u {{ db_user }} -p{{ db_password }} -h {{ db_host }} &lt; /tmp/sql/createdb.sql
</code></pre><p>As you can see, the three variables of <code>db_user</code>, <code>db_password</code>, and <code>db_host</code> will be injected using either the values for the default file, or the overwritten values, if they exist.</p>
<p>Ansible allows us to take this a step further. Let&rsquo;s take a look at the actual <code>createdb.sql</code> file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">drop</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">db_name</span><span class="w"> </span><span class="err">}}</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">db_name</span><span class="w"> </span><span class="err">}}</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">USE</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">db_name</span><span class="w"> </span><span class="err">}}</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">drop</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="s1">&#39;tbl_user&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="err">{{</span><span class="w"> </span><span class="n">db_name</span><span class="w"> </span><span class="err">}}</span><span class="p">.</span><span class="n">tbl_user</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="s1">&#39;user_id&#39;</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="s1">&#39;user_name&#39;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="s1">&#39;user_username&#39;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="s1">&#39;user_password&#39;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">162</span><span class="p">)</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">));</span><span class="w">
</span></span></span></code></pre></div><p>As
we can see, these variables are even injected into the file templates
that will be used. This allows us to control the variables that will be
used from a single, centralised location. When we change the user or
password that will be used to connect to the database, we can change
this in a single location, and it will propagate throughout all
provisioning steps for the role.</p>
<p><strong>Web Setup</strong></p>
<p>Lastly, let&rsquo;s take a look at the <code>app-setup.yml</code> file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">Copy</span> <span class="n">web</span> <span class="n">application</span> <span class="n">files</span>
</span></span><span class="line"><span class="cl">  <span class="nl">shell</span><span class="p">:</span> <span class="n">cp</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="n">provision</span><span class="o">/</span><span class="n">roles</span><span class="o">/</span><span class="n">webapp</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">app</span> <span class="o">/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="nl">name</span><span class="p">:</span> <span class="n">Copy</span> <span class="n">Flask</span> <span class="n">app</span> <span class="n">script</span> <span class="n">with</span> <span class="n">injected</span> <span class="n">variables</span>
</span></span><span class="line"><span class="cl">  <span class="nl">template</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nl">src</span><span class="p">:</span> <span class="n">templates</span><span class="o">/</span><span class="n">app</span><span class="p">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl">    <span class="nl">dest</span><span class="p">:</span> <span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">app</span><span class="p">.</span><span class="n">py</span>
</span></span></code></pre></div><p>This
file only has two tasks. The first copies the artefacts required for
the web application and the second copies the web application file as a
template. A template copy is performed to ensure that the variables,
such as the database connection string, are injected into the script as
well.</p>
<p>We will not do a deep dive into the rest of the files that will be
used for provisioning, however, it is recommended that you take a look
at these files to gain a better understanding on what exactly we are
provisioning.</p>


<h1 class="relative group">Running the IaC Pipeline 
    <div id="running-the-iac-pipeline" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#running-the-iac-pipeline" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Now that we have an understanding of our pipeline, it is time to start it! Let&rsquo;s start our pipeline and the provisioning using <code>vagrant up</code> from the <code>iac</code> directory. The pipeline will take a while to boot, but pay attention to what is happening.</p>
<p><strong>Note:
While you may see some red on the terminal when the Ansible
provisioning step is running, as long as these lines only indicate
warnings and not an error, the provisioning will complete as expected.</strong></p>
<p>Once our pipeline has provisioned the machines, we can verify that they are running using the <code>docker ps</code> command:</p>
<p>Terminal</p>
<pre tabindex="0"><code>ubuntu@tryhackme:~$ docker ps
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                    NAMES
04fc30613dd6   mysql     &#34;docker-entrypoint.s…&#34;   18 minutes ago   Up 18 minutes   3306/tcp, 33060/tcp      iac_dbserver_1706019401
5529f04a2509   ansible   &#34;/usr/sbin/sshd -D&#34;      18 minutes ago   Up 18 minutes   127.0.0.1:2222-&gt;22/tcp   iac_webserver_1706019400
</code></pre><p>If this is running, we can start our web application using the following command:</p>
<p><code>vagrant docker-exec -it webserver -- python3 /app/app.py</code></p>
<p>Once loaded, you can navigate to the web application using the target machines&rsquo;s browser (<a href="http://172.20.128.2/" target="_blank">http://172.20.128.2/</a>):</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6093e17fa004d20049b6933e/room-content/39e697edab7cba60952ccdb28ece98c9.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6093e17fa004d20049b6933e/room-content/39e697edab7cba60952ccdb28ece98c9.png" />
    
  </figure>
</p>
<p>Congratulations! You have executed your very first IaC pipeline!</p>
<p>Security Concerns in On-Prem IaC</p>
<p>When using IaC,
regardless of whether the deployment is on-prem or cloud-based, there
are several things to consider for security. If you are looking for
security best practices, cheat sheets such as <a href="https://cheatsheetseries.owasp.org/cheatsheets/Infrastructure_as_Code_Security_Cheat_Sheet.html" target="_blank">these from OWASP</a> are a good place to start. Even frameworks such as <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-204C.pdf" target="_blank">NIST</a> provide information on how to secure IaC.</p>
<p>However, in this room, we will focus more on the practical security
of IaC and common mistakes that are seen in the real world. This is not a
comprehensive list of things to take into consideration, but it is a
great start either protecting your IaC pipeline against real-world
attacks or what to look for if you are attacking an IaC pipeline on a
red team engagement. In total, there are four main elements to consider.</p>


<h1 class="relative group">Dependencies 
    <div id="dependencies" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#dependencies" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/room-icons/317702e9ed406144f96699d72b09ef9c.png" alt="https://tryhackme-images.s3.amazonaws.com/room-icons/317702e9ed406144f96699d72b09ef9c.png" />
    
  </figure>
</p>
<p>The first element of IaC pipelines where security has to be
considered is the dependencies. Similar to a software pipeline, our IaC
pipeline will have dependencies. In IaC pipelines, the biggest
dependencies are the base images that are pulled and used to build the
infrastructure. If these dependencies have any security issues, these
issues will propagate through the pipeline.</p>
<p>A common example would be a vulnerability in the OS
version of the image. If the image itself is not updated, the deployed
hosts would have this vulnerability. As such, it is important to ensure
adequate dependency management for resources used in the IaC pipeline.
Anytime you are making use of third-party software or systems, it can
introduce a dependency risk. For more information on dependency
management and the potential vulnerabilities, have a look at the <a href="https://tryhackme.com/room/dependencymanagement" target="_blank">Dependency Management</a> room.</p>


<h1 class="relative group">Defaults 
    <div id="defaults" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#defaults" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>A common security flaw in IaC pipelines is not altering defaults.
When hosts and services are initially provisioned through an IaC
pipeline, it is extremely common for these systems to be provisioned
using default credentials or connection strings. Ultimately, this is
intended as these default credentials are used by the tools in the
pipeline to provision the hosts. The security misconfiguration is
therefore not the default credentials, but not removing or altering them
as the final step in the IaC deployment.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6093e17fa004d20049b6933e/room-content/b2355b480888d1f06134521274217192.png" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6093e17fa004d20049b6933e/room-content/b2355b480888d1f06134521274217192.png" />
    
  </figure>
</p>
<p>An example of default credentials is the credentials used by Vagrant
to provision Windows hosts. Windows images provisioned by Vagrant often
have a built-in default account of <code>vagrant</code> that has the password of <code>vagrant</code>.
This is to allow the Vagrant script running on the hypervisor to
connect to the host for file transfer and script execution. If, at the
end of the deployment, this default user is not removed, a threat actor
could use this to connect to and take full control of all hosts deployed
through the IaC pipeline.</p>
<p>Another issue with defaults is in
the services deployed on the hosts. Let&rsquo;s say, for instance, that our
IaC pipeline is used to deploy a CI/CD pipeline and would therefore
install the Jenkins
role on one of the hosts. It would be common for this role to be
installed with the default credentials of Jenkins, which would be <code>jenkins:jenkins</code>.
In this case, we cannot really alter these credentials in the last
stages of the IaC deployment but expect the software engineers that will
use the CI/CD infrastructure to alter the credentials. In some cases,
this is not performed, which then leads to insecure infrastructure in
the deployment. In other cases, even if the software would require the
user to change their password with the first logon event, as the
software is never used, the default credential remains, allowing a
threat actor to compromise the service and potentially its underlying
infrastructure.</p>
<p>As such, when building an IaC pipeline, it is important to make note
of cases where defaults are used and where they may be a risk if not
altered. The alteration of these defaults should then either be embedded
as the final steps in the IaC pipeline or, where required, be performed
manually once the deployment is complete.</p>


<h1 class="relative group">Insufficient Hardening 
    <div id="insufficient-hardening" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#insufficient-hardening" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/room-icons/c37f3bd6e21e89c0a8de1607bf56fbab.svg" alt="https://tryhackme-images.s3.amazonaws.com/room-icons/c37f3bd6e21e89c0a8de1607bf56fbab.svg" />
    
  </figure>
</p>
<p>The third element that commonly goes wrong in IaC pipelines is
insufficient hardening. The primary goal of IaC is to rapidly deploy
infrastructure. This often means that the infrastructure that is being
deployed has not yet been fully hardened. Hardening is not something
that just happens automatically; it has to be planned for. As such, it
is important to ensure that hardening steps are either embedded in the
IaC pipeline or performed manually post-deployment.</p>
<p>A common example of insufficient hardening is the services used by
the IaC pipeline for deployment. For example, when Vagrant does
provisioning of a Windows host, it does this via a WinRM connection. It
just so happens that WinRM is a service commonly used by threat actors
for lateral movement. As such, it is important that if the service is no
longer required for normal operation post-deployment, it should be
disabled. When planning your IaC pipeline, it is important to include
not only general hardening steps but also those that would close down
the services used by the pipeline itself.</p>


<h1 class="relative group">Remote Code Execution as a Feature 
    <div id="remote-code-execution-as-a-feature" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#remote-code-execution-as-a-feature" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>The last element to consider is to remember that, ultimately, IaC
pipelines are nothing more than remote code execution as a feature. In
essence, the pipeline is effectively executing code that allows for new
infrastructure to be created and integrated into existing networks.
While this is incredibly powerful in the right hands, it could also be
extremely detrimental.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/room-icons/23854ddd89de7b9574e1d71b7609ce43.png" alt="https://tryhackme-images.s3.amazonaws.com/room-icons/23854ddd89de7b9574e1d71b7609ce43.png" />
    
  </figure>
</p>
<p>Taking this into consideration, it is important to apply security to
the IaC pipeline to prevent unauthorised access. This can be done
through two main security efforts, namely secret management and
following the principle of least privilege.</p>
<p>With secret management, we can ensure that sensitive information,
such as final credentials or keys, is securely stored and cannot simply
be read from the IaC source code to compromise the deployment.</p>
<p>Following
the principle of least privilege ensures that access to the IaC
pipeline is only provided to users and services that require it. This
includes implementing the same security controls that should be in any
pipeline as taught in the <a href="https://tryhackme.com/room/cicdandbuildsecurity" target="_blank">CI/CD and Build Security</a>
room. If a threat actor can compromise the pipeline, they would often
have the ability to also compromise the deployed infrastructure.</p>
<p>These are some of the key security considerations that are required to secure your IaC pipeline against real-world threats.</p>


<h2 class="relative group">CLOUD-BASED IAC 
    <div id="cloud-based-iac" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#cloud-based-iac" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Terraform 101</p>


<h1 class="relative group">Terraform Overview 
    <div id="terraform-overview" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#terraform-overview" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Terraform
is an infrastructure as code tool used for provisioning that allows the
user to define both cloud and on-prem resources in a human-readable
configuration file that can be versioned, reused and distributed across
teams. Terraform uses a consistent workflow to make the management of
your infrastructure an easy and reliable process. Both this
configuration and the workflow Terraform follows will be covered by
subsequent tasks in this room. For now, let&rsquo;s define some terms which
are key to understanding how Terraform provisions and manages
infrastructure:</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/7cdb769ecb4e5b5a0bb23f30d999454a.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/7cdb769ecb4e5b5a0bb23f30d999454a.svg" />
    
  </figure>
</p>


<h1 class="relative group">Terraform&rsquo;s Architecture 
    <div id="terraforms-architecture" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#terraforms-architecture" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Now we know what Terraform does. Let&rsquo;s examine how it is done. We will examine Terraform&rsquo;s architecture:</p>
<p><strong>Terraform Core</strong>:
As the name suggests, Terraform Core is responsible for the core
functionalities that allow users to provision and manage their
infrastructure using Terraform. As mentioned in the <a href="https://tryhackme.com/room/introtoiac" target="_blank">Intro to IaC</a> room,
Terraform is a declarative tool (reminder: this means that a desired
state is defined, and the tool is responsible for ensuring the
infrastructure meets that desired state, rather than the user declaring
each step required to achieve the desired state), to ensure the user
infrastructure is in the desired state, Terraform Core takes its input
from two sources:</p>
<ul>
<li><strong>Terraform Config files</strong>: The user defines the desired state of their infrastructure in these
config files, in other words, what resources make up their desired
infrastructure.</li>
<li><strong>State</strong>: Terraform has a state file that keeps track of the current state of
provisioned infrastructure. The core component checks this state file
against the desired state defined in the config files, and, if there are resources that are defined but not provisioned (or the other way
around), makes a plan of how to take the infrastructure from its current state to the desired state. By default, this state file is called
terraform.tfstate and is stored in the same directory where Terraform
runs.</li>
</ul>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/b25923ed88b91dc85d24605c3b97f03d.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/b25923ed88b91dc85d24605c3b97f03d.svg" />
    
  </figure>
</p>
<p><strong>We
can see in the graphic above that the Terraform Core takes its input
from two places: the user-defined configuration files and tfstate.
Should there be any difference between the desired state (configuration
files) and the current state (tfstate), the required actions will be
executed using a provider.</strong></p>
<p><strong>Providers</strong>:
The plan mentioned above is executed using different providers
depending on the resources defined. Providers are used to interact with
cloud providers, SaaS
providers and other APIs. For example, if an AWS resource like an EC2
instance is defined, the AWS provider would be used; if a Kubernetes
cluster is defined, the Kubernetes provider would be required.</p>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/b6fdcfc9fbc25735baba5ad9376f073e.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/b6fdcfc9fbc25735baba5ad9376f073e.svg" />
    
  </figure>
</p>
<p>This tool and its architecture boasts many benefits of this IaC tool for DevSecOps
engineers. What probably sets Terraform apart the most from other IaC
tools is the ability to use these providers to provision and manage
resources across multiple cloud providers. This means if you&rsquo;re working
with an infrastructure that has infrastructure resources with AWS and
Azure, Terraform can be used as a single solution for multi-cloud
environments. This also prevents vendor lock-in and means infrastructure
can be much more flexible. Another benefit of Terraform is the
declarative configuration language, which is used to define resources in
config files; it&rsquo;s easy to understand, and the human-readable format
makes the definition process simple and streamlined. On top of all this,
the declarative nature of the tool supports versioning and
change-tracking practices, allowing team members to collaborate during
the declaration and development of infrastructure and roll back to
previous infrastructure iterations. The next task will go into further
detail on how these resources are defined.</p>
<p>Terraform Configuration</p>
<p><strong>Configuration &amp; Terraform</strong></p>
<p>Now
that we know what Terraform is and how it works, let&rsquo;s take a look at
how we would define the desired state using Terraform config files.
Terraform config files are written in a declarative language called HCL
(HashiCorp Configuration Language), which, as discussed, is easy to
understand and human-readable. The primary purpose of this language is
to declare resources; these resources represent infrastructure objects.
The combined definition of these resources makes up the desired
infrastructure state.</p>
<p>To give you an example of how, as a DevSecOps
engineer, Terraform configuration files might be used, let us consider
an example where we want to define a simple VPC (virtual private cloud)
using the AWS provider. That would look like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">provider <span class="s2">&#34;aws&#34;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="nv">region</span> <span class="o">=</span> <span class="s2">&#34;eu-west-2&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create aVPC</span>
</span></span><span class="line"><span class="cl">resource <span class="s2">&#34;aws_vpc&#34;</span> <span class="s2">&#34;flynet_vpc&#34;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="nv">cidr_block</span> <span class="o">=</span> <span class="s2">&#34;10.0.0.0/16&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="nv">tags</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">Name</span> <span class="o">=</span> <span class="s2">&#34;flynet-vpc&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p><strong>What does the code do?</strong> After defining our provider (which in this case is AWS),
this resource block is used to define a VPC. We first define the
resource by stating the resource type, which in this case is an
&ldquo;aws_vpc&rdquo;, and then what we will call this resource. This example is
&ldquo;flynet_vpc&rdquo;. Then begins our <em>resource block,</em> where
we define our resource arguments. The arguments given will depend on
what type of resource is being defined. For example, an aws_vpc will
need a CIDR block (method for allocating IP addresses). We also define
tags which can be used in AWS to help with the automation of resources, billing, access control, etc.</p>
<p><strong>Resource Relationships</strong></p>
<p>Sometimes,
resources can depend on other resources. When defining a resource with
dependencies, the resources it depends on will be referenced. For
example, if you were assigned a task to define an AWS
security group ingress rule, allowing SSH access from any source within
the VPC, you would add the following code block to your configuration
file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">resource <span class="s2">&#34;aws_security_group&#34;</span> <span class="s2">&#34;example_security_group&#34;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="nv">name</span> <span class="o">=</span> <span class="s2">&#34;example-security-group&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="nv">description</span> <span class="o">=</span> <span class="s2">&#34;Example Security Group&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="nv">vpc_id</span> <span class="o">=</span> aws_vpc.flynet_vpc.id <span class="c1">#Reference to theVPC created above (format: resource_type.resource_name.id)# Ingress rule allowingSSH access from any source within the VPC</span>
</span></span><span class="line"><span class="cl"> ingress <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#Since we are allowingSSH traffic , from port and to port should be set to port 22</span>
</span></span><span class="line"><span class="cl">  <span class="nv">from_port</span> <span class="o">=</span> <span class="m">22</span>
</span></span><span class="line"><span class="cl">  <span class="nv">to_port</span> <span class="o">=</span> <span class="m">22</span>
</span></span><span class="line"><span class="cl">  <span class="nv">protocol</span> <span class="o">=</span> <span class="s2">&#34;tcp&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">cidr_blocks</span> <span class="o">=</span> <span class="o">[</span>aws_vpc.flynet_vpc.cidr_block<span class="o">]</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p><strong>What does the code do?</strong> Here, you can see we have a resource block that defines an AWS
security group (helps secure AWS environments by controlling how
traffic is allowed into EC2 machines), which allows SSH access from any
source within the VPC. You can see in the commented lines how this is
configured and how resources can be referenced from within another
resource block.</p>


<h1 class="relative group">Infrastructure Modularisation 
    <div id="infrastructuremodularisation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#infrastructuremodularisation" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>As a DevSecOps
engineer, you will likely work with a large, complex infrastructure.
Another benefit of Terraform is that it allows for the modularisation of
an infrastructure, that is, for the infrastructure to be broken down
and defined as modular components rather than in a single place. This is
common practice in larger organisations as it simplifies the management
of complex infrastructure configurations. Let&rsquo;s take a look at what the
above example configuration would look like. Below is a representation
of a directory <code>/tfconfig</code> and the files within it, with a brief comment explaining the purpose of each file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">tfconfig/
</span></span><span class="line"><span class="cl"> -flynet_vpc_security.tf <span class="c1">#Like mentioned, instead of having all resources defined in one file, resources can be paired up and defined in separate modular files</span>
</span></span><span class="line"><span class="cl"> -other_module.tf
</span></span><span class="line"><span class="cl"> -variables.tf <span class="c1">#some values will be used across two or many infrastructure modules, so instead of declaring these repeatedly in each .tf file it makes sense to paramaterise them in a file called variables.tf. These variables can then be directly referenced in the .tf file.</span>
</span></span><span class="line"><span class="cl"> -main.tf <span class="c1">#main.tf acts as the central configuration file where the defined modules are all referenced in one place</span>
</span></span></code></pre></div><p>If we consider the example given above, if we were to define a vpc using this structure, it could be configured like so:</p>
<p>variables.tf</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">variable &#34;vpc_cidr_block&#34; {</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">description = &#34;CIDR block for the VPC&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">type = string</span><span class="w"> </span><span class="c">#Set the type of variable (string,number,bool etc)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">default = &#34;10.0.0.0/16&#34;</span><span class="w"> </span><span class="c"># Can be changed as needed</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>}<span class="w">
</span></span></span></code></pre></div><p>We are defining a VPC the same way as we did at the beginning of this task, except now we are storing it in a <code>variables.tf</code>
file. We are doing this so we can reuse/reference it. This could be
referenced in any module.tf file, for example, below, we have a code
block for a module named <code>flynet_vpc_security</code>:</p>
<p>flynet_vpc_security.tf</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">cidr_block = var.vpc_cidr_block</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#Variable can be referenced using var. followed by variable name</span><span class="w">
</span></span></span></code></pre></div><pre tabindex="0"><code>Finally, this module (and all other module tf files) would be collected and referenced in the main.tf file like so:
</code></pre><p>main.tf</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">module &#34;flynet_vpc_security&#34; {</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">source = &#34;./flynet_vpc_security.tf&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="c">#where module is defined (relative to current file)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">module &#34;other_module&#34; {</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="l">source = &#34;./Other_module.tf&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>}<span class="w">
</span></span></span></code></pre></div><p>This level of organisation would be
extreme, given how primitive the infrastructure setup is in our example.
However, this was to show you how an infrastructure at scale might be
configured in a larger organisation/company.</p>
<p>Terraform Workflow</p>
<p><strong>Understanding the Terraform Workflow</strong></p>
<p>The
Terraform workflow generally follows four steps: Write, Initialise,
Plan and Apply. To better understand this workflow and how it can
benefit DevSecOps
engineers while provisioning of infrastructure, let&rsquo;s consider an
infrastructure at different points in development. When dealing with
infrastructure provisioning, you tend to have different problems at
different stages. To illustrate this, let&rsquo;s consider the Terraform
workflow at three points in time:</p>
<ul>
<li>Day 1 (the infrastructure does not exist yet and needs to be provisioned from scratch)</li>
<li>Day 2+ (The infrastructure exists, but some changes need to be made)</li>
<li>Day N (an undefined point in time when you no longer need this infrastructure)</li>
</ul>


<h1 class="relative group">Day 1 
    <div id="day-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#day-1" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Let&rsquo;s
take a look at what the Terraform workflow would look like on Day 1 of
infrastructure provisioning. You have an empty environment with no
infrastructure set up and need to define and provision this
infrastructure. Using Terraform, you would follow this workflow:</p>
<ul>
<li><strong>Write:</strong> In this part of the workflow you would define the desired state of your infrastructure in a Terraform configuration file. As discussed in the
previous task, these configuration files are used to define the desired
components, and these components can reference each other if they have a relation.</li>
<li><strong>Initialise:</strong> The next part of
the workflow is to initialise. The init command prepares your workspace
(the working directory where your Terraform configuration files are) so Terraform can apply your changes. This preparation includes things like downloading dependencies, for example, if your configuration file
defines &lsquo;aws&rsquo; as the provider, during the initialisation, Terraform will download the aws provider plug-in. This is done using the following
command: <code>terraform init</code></li>
<li><strong>Plan:</strong> After initialising your workspace, you should now plan your changes.
The planning stage considers what infrastructure is present currently
(with it being Day 1, there will be no infrastructure present) vs the
desired state and prepares a plan of actions which, if applied, will
make it so the infrastructure matches the desired state. It produces
this execution plan and will tell the user what components will be
added/destroyed in the process. This is done using the following
command: <code>terraform plan</code></li>
<li><strong>Apply:</strong> Apply actions the steps (detailed in the plan) required to take the
infrastructure from the current state to the desired state. Terraform
works out which order these infrastructure resources should be created.
In our example from the previous task, we defined two resources: a VPC and a security group. Since the security group references the VPC and
is therefore dependent on it, Terraform would create the VPC first. This is done using the following command: &lt;<code>terraform apply</code></li>
</ul>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/8f2325af86bb7978f2106f733caac33b.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/8f2325af86bb7978f2106f733caac33b.svg" />
    
  </figure>
</p>


<h1 class="relative group">Day 2+ 
    <div id="day-2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#day-2" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Day
2+ means any day after the infrastructure has been provisioned; what
will the workflow look like when making changes to an existing
infrastructure? Say, for instance, you wanted to add a component to your
infrastructure.</p>
<ul>
<li><strong>Initialise</strong>: <code>terraform init</code> should be the first command run after making any changes to an
infrastructure configuration. It will initialise the workspace just like when creating the infra from scratch.</li>
<li><strong>Plan</strong>: Terraform plan is not required but is best practice, especially in an
already existing infrastructure. The execution plan generated by the
plan command will show you exactly what is being removed or added to the infrastructure. This can catch any misconfigurations before they are
applied and break anything. The plan will assess the existing
infrastructure in this case and note that the existing components match
the desired state, so no changes need to be made, but the additional
component has not been created yet and will need to be created to match
the desired state, so will be listed as a resource that needs to be
added.</li>
<li><strong>Apply</strong>: Again, Terraform
will provision the infrastructure changes defined using the execution
plan made during the Plan phase (note that if you skip the planning
phase, Terraform will automatically create an execution plan as if you
had and will ask you to approve the plan before execution). The state
file will then be updated to reflect that the current state now matches
the desired state as the additional component has been
added/provisioned.</li>
</ul>


<h1 class="relative group">Day N 
    <div id="day-n" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#day-n" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Day
N denotes a day in the future when the infrastructure is no longer
needed. Maybe it was just a test environment, or the application it
supports has been shelved. Now that this infrastructure is no longer
needed, all that is required is to destroy it.</p>
<ul>
<li><strong>Destroy</strong>: Running the <code>terraform destroy</code> command will take care of this. Functionally, the destroy command is
quite similar to the apply command in that it takes a plan (a destroy
plan which Terraform makes on running this command) and compares it to
what infrastructure currently exists and actions that plan instead of
provisioning/de-provisioning resources changes, it tears down all
resources.</li>
</ul>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/667e6e2b9cbac61df9d17ac8e0aabae9.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/667e6e2b9cbac61df9d17ac8e0aabae9.svg" />
    
  </figure>
</p>
<p>Cloudformation 101</p>
<p>﻿**
﻿
CloudFormation Overview**</p>
<p>CloudFormation is an Amazon Web Services (AWS)
IaC tool for automated provision and resource management. Instead of
manually configuring resources through the AWS Management Console or
using the AWS Command Line Interface (CLI), you can use CloudFormation
templates to describe your infrastructure in a &ldquo;declarative&rdquo; manner.</p>
<p>Declarative Infrastructure as Code</p>
<p>With CloudFormation, you express the desired state of your infrastructure using a JSON
or YAML template. This template defines the resources, their
configurations, and the relationships between them. CloudFormation
provides and manages these resources, making managing and replicating
your infrastructure easier.</p>


<h1 class="relative group">Templates and Stacks 
    <div id="templates-and-stacks" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#templates-and-stacks" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>A
CloudFormation template is a text file that serves as a blueprint for
your infrastructure. It contains sections that describe various AWS
resources like EC2 instances, S3 buckets, and more. When you use a
template to create resources, it forms a CloudFormation stack. Stacks
are the fundamental units of CloudFormation, and they represent a
collection of AWS resources that are created, updated, and deleted
together.</p>
<p>Example</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># CloudFormation Template</span>
</span></span><span class="line"><span class="cl">AWSTemplateFormatVersion: <span class="s1">&#39;2010-09-09&#39;</span>  <span class="c1"># Version of the CloudFormation template syntax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Description: <span class="s1">&#39;A simple CloudFormation template&#39;</span>  <span class="c1"># Description of the template</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Resources:  <span class="c1"># Section whereAWS resources are defined</span>
</span></span><span class="line"><span class="cl">  MyEC2Instance:  <span class="c1"># Logical name of the resource</span>
</span></span><span class="line"><span class="cl">    Type: <span class="s1">&#39;AWS::EC2::Instance&#39;</span>  <span class="c1"># Type ofAWS resource being created</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Properties:  <span class="c1"># Properties specific to the resource type</span>
</span></span><span class="line"><span class="cl">      ImageId: <span class="s1">&#39;ami-12345678&#39;</span>  <span class="c1"># ID of the Amazon Machine Image (AMI) for theEC2 instance</span>
</span></span><span class="line"><span class="cl">      InstanceType: <span class="s1">&#39;t2.micro&#39;</span>  <span class="c1"># Type ofEC2 instance</span>
</span></span><span class="line"><span class="cl">      KeyName: <span class="s1">&#39;my-key-pair&#39;</span>  <span class="c1">#SSH key pair for accessing the instance</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  MyS3Bucket:  <span class="c1"># Another resource example</span>
</span></span><span class="line"><span class="cl">    Type: <span class="s1">&#39;AWS::S3::Bucket&#39;</span>
</span></span><span class="line"><span class="cl">    Properties:
</span></span><span class="line"><span class="cl">      BucketName: <span class="s1">&#39;my-s3-bucket&#39;</span>  <span class="c1"># Name of theS3 bucket</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Outputs:  <span class="c1"># Section to define outputs for the template</span>
</span></span><span class="line"><span class="cl">  EC2InstanceId:  <span class="c1"># Logical name for the output</span>
</span></span><span class="line"><span class="cl">    Description: <span class="s1">&#39;ID of theEC2 instance&#39;</span>  <span class="c1"># Description of the output</span>
</span></span><span class="line"><span class="cl">    Value: !Ref MyEC2Instance  <span class="c1"># Reference to theEC2 instance resource</span>
</span></span></code></pre></div><ul>
<li><strong>AWSTemplateFormatVersion:</strong> This specifies the CloudFormation template version.</li>
<li><strong>Description:</strong> Provides a brief description of the template.</li>
<li><strong>Resources:</strong> This section defines the AWS resources to be created, such as EC2 instances or S3 buckets. Each resource has a logical name (MyEC2Instance, MyS3Bucket). Type indicates the AWS resource type. Properties hold configuration settings for the resource.</li>
<li><strong>Outputs:</strong> This section defines the output values displayed after creating the stack. Logical name, description, and a reference to a resource using <code>!Ref</code>.</li>
</ul>
<p><strong>Notes:</strong> CloudFormation Designer is a service for visually creating/validating these templates. Read more <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer-overview.html" target="_blank">here</a>.</p>


<h1 class="relative group">CloudFormation Architecture 
    <div id="cloudformation-architecture" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#cloudformation-architecture" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Similar
to Terraform, CloudFormation follows a workflow for provision and
management. To better understand the workflow, we need to understand the
inner workings of CloudFormation and its Architecture.</p>
<p>Main and Worker Architecture</p>
<p>CloudFormation employs a main-worker architecture. The main, typically a CloudFormation service running in AWS,
interprets and processes the CloudFormation template. It manages the
overall stack creation, update, or deletion orchestration. The worker
nodes, distributed across AWS regions, are responsible for carrying out
the actual provisioning of resources.</p>


<h1 class="relative group">Template Processing Flow 
    <div id="template-processing-flow" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#template-processing-flow" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/61a7523c029d1c004fac97b3/room-content/10cd2efae7292cd42ba523ba3625c3c8.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/61a7523c029d1c004fac97b3/room-content/10cd2efae7292cd42ba523ba3625c3c8.svg" />
    
  </figure>
</p>
<ul>
<li><strong>Template Submission:</strong> users submit a CloudFormation template, written in JSON or YAML, to the CloudFormation service. The template specifies the
desired AWS resources and their configurations. This can be stored in an <a href="https://aws.amazon.com/s3/" target="_blank">S3</a> bucket, for example.</li>
<li><strong>Template Validation:</strong> the CloudFormation service validates the submitted template to ensure its syntax is correct and it follows AWS resource specifications.</li>
<li><strong>Processing by the Main Node:</strong> the main node processes the template, creating a set of instructions
for resource provisioning. It determines the order in which resources
should be created based on dependencies.</li>
<li><strong>Resource Provisioning:</strong> the main node communicates with worker nodes distributed across different AWS regions. Worker nodes carry out the actual provisioning of resources stated by the instructions provided by the main.</li>
<li><strong>Stack Creation/Update:</strong> the resources are created or updated in the specified order, forming a
stack. The stack represents the complete set of provisioned resources.</li>
</ul>
<p>Event-Driven Model</p>
<p>CloudFormation
operates on an event-driven model. Events are generated during stack
creation, update, or deletion processes, and CloudFormation logs these
events. Users can monitor these events to track the progress of stack
operations or identify any issues.</p>
<p>Rollback and Rollback Triggers</p>
<p>If an error occurs during the stack creation or update process, CloudFormation can automatically trigger a <a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/instance-refresh-rollback.html" target="_blank">rollback</a>,
reverting the stack to its previous state. Rollback triggers can be
defined in the template to specify conditions under which a rollback
should occur.</p>
<p>Cross-Stack References</p>
<p>CloudFormation
supports cross-stack references, allowing resources from one stack to
refer to resources in another. This is useful for managing complex
applications and dependencies that span multiple stacks.</p>
<p>Understanding
the architecture of CloudFormation provides insights into how the
service efficiently manages the orchestration and provisioning of AWS resources, ensuring a reliable and consistent infrastructure deployment process.</p>
<p>CloudFormation Configuration &amp; Use Cases</p>


<h1 class="relative group">Configuration and Concepts 
    <div id="configuration-and-concepts" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#configuration-and-concepts" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Template Structure</p>
<p>CloudFormation templates consist of key sections:</p>
<ul>
<li><strong>AWSTemplateFormatVersion:</strong> Specifies the AWS CloudFormation template version.</li>
<li><strong>Description:</strong> Describes the template.</li>
<li><strong>Parameters:</strong> You can input custom values when creating or updating a stack.</li>
<li><strong>Resources:</strong> Defines the AWS resources to be created or managed.</li>
<li><strong>Outputs:</strong> Describes the values that can be queried once the stack is created or updated.</li>
</ul>
<p>Intrinsic Functions</p>
<p>CloudFormation
templates support &ldquo;intrinsic functions&rdquo;, which help you perform
operations. Examples of intrinsic functions are referencing resources,
performing calculations, and conditionally including resources:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Resources:
</span></span><span class="line"><span class="cl">  MyInstance:
</span></span><span class="line"><span class="cl">    Type: AWS::EC2::Instance
</span></span><span class="line"><span class="cl">    Properties:
</span></span><span class="line"><span class="cl">      ImageId: ami-12345678
</span></span><span class="line"><span class="cl">      InstanceType: t2.micro
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Outputs:
</span></span><span class="line"><span class="cl">  InstanceId:
</span></span><span class="line"><span class="cl">    Value: !Ref MyInstance
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  PublicDnsName:
</span></span><span class="line"><span class="cl">    Value: !GetAtt MyInstance.PublicDnsName
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  SubstitutedString:
</span></span><span class="line"><span class="cl">    Value: !Sub <span class="s2">&#34;Hello, </span><span class="si">${</span><span class="nv">MyInstance</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div><ul>
<li><strong>Fn::Ref :</strong> References the value of the specified resource.</li>
<li><strong>Fn::GetAtt :</strong> Gets the value of an attribute from a resource in the template.</li>
<li><strong>Fn::Sub :</strong> Performs string substitution.</li>
</ul>
<p>Resource Dependencies</p>
<p>Resources in CloudFormation can have dependencies on each other. For example, an EC2
instance might depend on a VPC being created first. CloudFormation
automatically handles the order of resource creation and updates based
on these dependencies.</p>
<p>Change Sets</p>
<p>Before
making changes to a stack, CloudFormation lets you preview the changes
using a Change Sets feature. This helps in understanding the impact of
modifications before they are applied.</p>


<h1 class="relative group">Use Cases 
    <div id="use-cases" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#use-cases" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>There are many use cases for resource provisioning and management in AWS. Here are some examples:</p>
<p>Infrastructure Provisioning and Management</p>
<p>CloudFormation simplifies the process of creating and managing AWS resources. It ensures consistency and repeatability in infrastructure deployments, reducing the risk of configuration errors.</p>
<p>Application Lifecycle Management</p>
<p>CloudFormation
is commonly used to manage the entire lifecycle of applications. This
includes provisioning resources, deploying application code, and
handling updates or rollbacks.</p>
<p>Multi-Environment Deployments</p>
<p>Deploying
the same infrastructure across multiple environments (dev, test,
production) is often necessary. CloudFormation allows you to use the
same template with different parameter values for each environment.</p>
<p>Resource Scaling</p>
<p>As
your application or workload grows, CloudFormation enables you to
quickly scale your infrastructure by modifying the template or using <a href="https://aws.amazon.com/autoscaling/" target="_blank">auto-scaling</a> capabilities.</p>
<p>CloudFormation provides a robust and scalable way to manage AWS
resources through code, offering benefits in terms of automation,
consistency, and collaboration in the cloud infrastructure setup and
maintenance.</p>
<p>Terraform vs CloudFormation</p>


<h1 class="relative group">Terraform vs. CloudFormation 
    <div id="terraform-vs-cloudformation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#terraform-vs-cloudformation" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>
  <figure>
    <img class="my-0 rounded-md" loading="lazy" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/46b69b1f213ad744229dd1a273835633.svg" alt="https://tryhackme-images.s3.amazonaws.com/user-uploads/6228f0d4ca8e57005149c3e3/room-content/46b69b1f213ad744229dd1a273835633.svg" />
    
  </figure>
</p>
<p>CloudFormation</p>
<ul>
<li><strong>Vendor Lock-In:</strong> AWS CloudFormation is tightly integrated with AWS services, making it the natural choice for AWS-centric environments.</li>
<li><strong>Native Integration:</strong> Seamlessly integrates with other AWS services, providing direct resource references and a unified management experience.</li>
<li><strong>Service Coverage:</strong> Provides comprehensive coverage of AWS services, often including support for new services shortly after release.</li>
<li><strong>Learning Curve:</strong> Learning CloudFormation may be easier for those familiar with AWS services.</li>
</ul>
<p>Terraform</p>
<ul>
<li><strong>Cloud-Agnostic:</strong> Terraform is cloud-agnostic, supporting multiple cloud providers, including AWS, Azure, Google Cloud, and more. This makes it a versatile choice for hybrid or multi-cloud deployments.</li>
<li><strong>Community and Modules:</strong> This has a large and active community, and using modules allows for reusable and shareable code.</li>
<li><strong>State Management:</strong> Terraform uses a state file to track the current state of infrastructure, providing a clear view of the deployed resources.</li>
<li><strong>Language Flexibility:</strong> The HashiCorp Configuration Language (HCL) used by Terraform is designed for readability and is more flexible than JSON or YAML.</li>
</ul>


<h1 class="relative group">Use Cases 
    <div id="use-cases-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#use-cases-1" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>Terraform Use Cases</p>
<p><strong>1. Multi-Cloud Environments</strong></p>
<p><strong><em>Scenario</em>:</strong> A company utilises its infrastructure with multiple cloud providers such as AWS, Azure, and GCP.</p>
<p>Reason for Terraform:</p>
<ul>
<li>Terraform has providers for various cloud platforms, making it easier to manage multi-cloud environments.</li>
<li>A single Terraform configuration can span different cloud providers,
allowing consistent infrastructure as code (IaC) across the entire
infrastructure landscape.</li>
</ul>
<p><strong>2. Community Modules and Providers:</strong></p>
<p><strong><em>Scenario</em>:</strong> An organisation heavily relies on community-contributed modules and providers to enhance infrastructure provisioning.</p>
<p>Reason for Terraform:</p>
<ul>
<li>Terraform has a vibrant community that contributes reusable modules and providers for a wide range of services and platforms.</li>
<li>Leveraging community-driven content can significantly speed up the development
process and provide best practices adopted by a broader audience.</li>
</ul>
<p>AWS CloudFormation Use Cases</p>
<p><strong>1. Deep AWS Integration</strong></p>
<p><strong><em>Scenario</em>:</strong>
An enterprise&rsquo;s infrastructure is predominantly AWS-centric, and the
team is deeply invested in AWS-specific services and features.</p>
<p>Reason for CloudFormation:</p>
<ul>
<li>AWS CloudFormation provides native integration with AWS services, making it well-suited for managing AWS-specific resources.</li>
<li>Features like CloudFormation StackSets and Change Sets enhance the management of AWS-specific resources and deployments.</li>
</ul>
<p><strong>2. Managed Service Integration:</strong></p>
<p><strong><em>Scenario</em>:</strong> An organisation heavily utilises AWS-managed services, such as AWS Elastic Beanstalk or AWS OpsWorks.</p>
<p>Reason for CloudFormation:</p>
<ul>
<li>AWS CloudFormation integrates seamlessly with AWS-managed services,
offering simplified provisioning and management of these services.</li>
<li>CloudFormation provides specific resource types for many AWS-managed services,
allowing for a higher level of abstraction in the templates.</li>
</ul>
<p>Secure IaC</p>
<p><strong>Secure Cloud IaC Best Practices</strong></p>
<p>For Both CloudFormation and Terraform</p>
<ul>
<li><strong>Version Control:</strong> store IaC code in version control systems like Git to track changes, facilitate collaboration, and maintain a version history.</li>
<li><strong>Least Privilege Principle:</strong> always assign the least permissions and scope for credentials and IaC
tools. Only grant the needed permissions for the actions to be
performed.</li>
<li><strong>Parameterise Sensitive Data:</strong> Use parameterisation to handle credentials or API keys and avoid hardcoding secrets directly into the IaC code.</li>
<li><strong>Secure Credential Management:</strong> leverage the cloud platform&rsquo;s secure credential management solutions or services to securely handle and store sensitive information, e.g., vaults for
secret management.</li>
<li><strong>Audit Trails:</strong> enable logging and
monitoring features to maintain an audit trail of changes made through
IaC tools. Use these logs to conduct reviews periodically.</li>
<li><strong>Code Reviews:</strong> implement code reviews to ensure IaC code adheres to best security
practices. Collaborative review processes can catch potential security
issues early.</li>
</ul>
<p>Check out the <a href="https://tryhackme.com/room/sourcecodesecurity" target="_blank">Source Code Security</a> room to learn more about this area.</p>
<p>For AWS CloudFormation</p>
<ul>
<li><strong>Use IAM Roles:</strong> Assign <a href="https://aws.amazon.com/iam/?gclid=Cj0KCQiAm4WsBhCiARIsAEJIEzXouhhd93RvbhqE9xDx8UN65Y44Gq19qsHQf_D5yk9QkScSLgQwvDgaAtOWEALw_wcB&amp;trk=35b38fd8-ca20-4fe2-b46d-16f845a47e34&amp;sc_channel=ps&amp;ef_id=Cj0KCQiAm4WsBhCiARIsAEJIEzXouhhd93RvbhqE9xDx8UN65Y44Gq19qsHQf_D5yk9QkScSLgQwvDgaAtOWEALw_wcB:G:s&amp;s_kwcid=AL!4422!3!651612449969!e!!g!!amazon%20iam!19836376240!155574317508" target="_blank">Identity and Access Management</a> (IAM) roles with the minimum required permissions to CloudFormation stacks. Avoid using long-term access keys when possible.</li>
<li><strong>Secure Template Storage:</strong> store CloudFormation templates in an encrypted <a href="https://aws.amazon.com/s3/" target="_blank">S3 bucket</a> and restrict access to only authorised users or roles.</li>
<li><strong>Stack Policies:</strong> implement stack policies to control updates to stack resources and enforce specific conditions during updates.</li>
</ul>
<p>For Terraform</p>
<ul>
<li><strong>Backend State Encryption:</strong> enable backend state encryption to protect sensitive information stored in the Terraform state file.</li>
<li><strong>Use Remote Backends:</strong> store the Terraform state remotely using backends like Amazon S3 or Azure Storage. This enhances collaboration and provides better security.</li>
<li><strong>Variable Encryption:</strong> consider encrypting sensitive values using tools like HashiCorp Vault
or other secure key management solutions when using variables.</li>
<li><strong>Provider Configuration:</strong> Securely configure provider credentials using environment variables, variable files, or other secure methods.</li>
</ul>

          
          
          
        </div>
        
        

        
        
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://localhost:1313/journal/posts/iac/&amp;title=Infrastructure%20as%20code"
      title="Share on LinkedIn"
      aria-label="Share on LinkedIn"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://twitter.com/intent/tweet/?url=http://localhost:1313/journal/posts/iac/&amp;text=Infrastructure%20as%20code"
      title="Tweet on Twitter"
      aria-label="Tweet on Twitter"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:1313/journal/posts/iac/&amp;quote=Infrastructure%20as%20code"
      title="Share on Facebook"
      aria-label="Share on Facebook"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="mailto:?body=http://localhost:1313/journal/posts/iac/&amp;subject=Infrastructure%20as%20code"
      title="Send via email"
      aria-label="Send via email"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://api.whatsapp.com/send?text=http://localhost:1313/journal/posts/iac/&amp;resubmit=true&amp;title=Infrastructure%20as%20code"
      title="Share via WhatsApp"
      aria-label="Share via WhatsApp"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://t.me/share/url?url=http://localhost:1313/journal/posts/iac/&amp;resubmit=true&amp;title=Infrastructure%20as%20code"
      title="Share via Telegram"
      aria-label="Share via Telegram"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z"/></svg>

  </span>


    </a>
      
    
  </section>


        


<h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
<section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
  
  

  <a href="/journal/posts/kerberos/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/journal/posts/kerberos/featured_hu13608285426065543753.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/journal/posts/kerberos/">Kerberos</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  





  



  



  



  









<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-01-15T00:00:00&#43;00:00">15 January 2024</time><span class="px-2 text-primary-500">&middot;</span><span>4501 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">22 mins</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts\Kerberos\index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="likes_posts\Kerberos\index.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="likes">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

</span>
</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/categories/ad/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    AD
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/categories/tryhackme/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    TryHackMe
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/tags/thm/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    THM
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
        <div class="py-1 prose dark:prose-invert">
          Credit to TryHackMe
        </div>
        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
  

  <a href="/journal/posts/dfir/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/journal/posts/dfir/featured_hu10845501850629258998.jpg);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/journal/posts/dfir/">Digital Forensics and Incidence Response</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  





  



  



  



  









<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-01-10T00:00:00&#43;00:00">10 January 2024</time><span class="px-2 text-primary-500">&middot;</span><span>33570 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">158 mins</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="views_posts\DFIR\index.md" class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400" title="views">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg>
  </span>

</span>
</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span id="likes_posts\DFIR\index.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full mt-[-2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="likes">loading</span>
  <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
  </span>

</span>
</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/categories/blue-team/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Blue Team
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/categories/tryhackme/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    TryHackMe
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/journal/tags/dfir/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    DFIR
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
        <div class="py-1 prose dark:prose-invert">
          Credit to TryHackMe
        </div>
        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
</section>

  
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\\IAC\\index.md"
        var oid_likes = "likes_posts\\IAC\\index.md"
      </script>
      
      
      <script type="text/javascript" src="/journal/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/journal/posts/kerberos/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Kerberos</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-01-15T00:00:00&#43;00:00">15 January 2024</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/journal/posts/fawn/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Fawn</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-09-12T00:00:00&#43;00:00">12 September 2024</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      © 2025 Board and Secretarial
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/journal/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/journal/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
